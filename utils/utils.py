import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    data_1 = {"lengthDate":30,"date":["2024-10-14T00:00:00","2024-10-15T00:00:00","2024-10-16T00:00:00","2024-10-17T00:00:00","2024-10-18T00:00:00","2024-10-19T00:00:00","2024-10-20T00:00:00","2024-10-21T00:00:00","2024-10-22T00:00:00","2024-10-23T00:00:00","2024-10-24T00:00:00","2024-10-25T00:00:00","2024-10-26T00:00:00","2024-10-27T00:00:00","2024-10-28T00:00:00","2024-10-29T00:00:00","2024-10-30T00:00:00","2024-10-31T00:00:00","2024-11-01T00:00:00","2024-11-02T00:00:00","2024-11-03T00:00:00","2024-11-04T00:00:00","2024-11-05T00:00:00","2024-11-06T00:00:00","2024-11-07T00:00:00","2024-11-08T00:00:00","2024-11-09T00:00:00","2024-11-10T00:00:00","2024-11-11T00:00:00","2024-11-12T00:00:00"],"count":[20649,19444,20172,42207,50171,47405,42951,33688,33730,33720,32141,34719,37568,36408,26820,26831,26166,25718,29901,33962,30955,25004,24124,23630,23783,24889,28498,27844,21441,21793],"avggoaltot":[2.60237,2.58692,2.55885,2.70467,2.68671,2.64699,2.62459,2.61659,2.61713,2.61701,2.62378,2.62502,2.62436,2.60832,2.60994,2.60229,2.60695,2.60048,2.59714,2.60686,2.58899,2.57974,2.59384,2.57252,2.58737,2.58004,2.58013,2.572,2.58151,2.56899],"avgshoottot":[6.99305,6.94499,6.88315,7.39099,7.28191,7.22329,7.17794,7.14001,7.15706,7.10282,7.093,7.13146,7.1065,7.09769,7.07931,7.02157,7.02128,7.01516,7.05288,7.07003,7.08698,6.99893,6.97695,6.9596,6.97276,6.96623,6.9857,7.00019,6.9645,6.91842],"avgeffshoottot":[5.33185,5.28569,5.25032,5.59971,5.54154,5.48954,5.46566,5.44519,5.44687,5.41903,5.41435,5.43385,5.42168,5.40256,5.39512,5.35671,5.35998,5.34814,5.36365,5.40414,5.39057,5.33963,5.32318,5.30746,5.30657,5.30837,5.33005,5.33776,5.3054,5.27922],"avggoalpenaltykick":[0.06247,0.0606,0.06213,0.06478,0.06312,0.06241,0.06078,0.06018,0.06033,0.06094,0.06312,0.06269,0.06271,0.06255,0.0637,0.06268,0.06338,0.06029,0.06316,0.06181,0.06143,0.0593,0.06374,0.06224,0.06045,0.06216,0.06149,0.06185,0.0607,0.0615],"avggoalfreekick":[0.01846,0.01942,0.01687,0.01813,0.01775,0.01741,0.01791,0.01744,0.01731,0.01823,0.0171,0.01784,0.01704,0.01804,0.01898,0.01735,0.01856,0.01696,0.01759,0.01815,0.01809,0.01847,0.01861,0.01715,0.01731,0.01897,0.01709,0.01793,0.01785,0.01791],"avgshootinpenalty":[4.6259,4.59486,4.55248,4.93432,4.85165,4.81926,4.75182,4.73295,4.73664,4.69588,4.70439,4.71811,4.71595,4.69999,4.67282,4.6556,4.66706,4.66933,4.65306,4.67234,4.66055,4.63997,4.62077,4.61986,4.64921,4.63253,4.6401,4.64486,4.61372,4.59098],"avggoalinpenalty":[2.03699,2.02742,2.01025,2.11768,2.10845,2.07998,2.05248,2.04918,2.04949,2.04976,2.06283,2.05552,2.06214,2.04802,2.04262,2.04401,2.05318,2.04844,2.03444,2.04243,2.02421,2.03131,2.03772,2.02706,2.04357,2.03428,2.03194,2.02455,2.03155,2.01815],"avgshootoutpenalty":[2.27995,2.26504,2.24167,2.36512,2.34097,2.31618,2.33987,2.32258,2.33443,2.32141,2.2994,2.32666,2.30224,2.30945,2.31728,2.27798,2.26579,2.26147,2.31223,2.31064,2.34125,2.27462,2.26609,2.25293,2.23752,2.24664,2.25738,2.26962,2.26469,2.2407],"avggoaloutpenalty":[0.50291,0.49889,0.48647,0.52221,0.51513,0.50461,0.51133,0.50722,0.50731,0.50631,0.49784,0.50681,0.49951,0.49774,0.50362,0.49559,0.49038,0.49176,0.49955,0.50262,0.50334,0.48913,0.49238,0.48323,0.48335,0.4836,0.4867,0.4856,0.48925,0.48934],"middleshoot":[22.0579,22.0257,21.7012,22.0796,22.005,21.7862,21.8531,21.8388,21.7317,21.8102,21.6508,21.7829,21.6966,21.5525,21.7333,21.7558,21.643,21.7452,21.6047,21.7524,21.499,21.504,21.7284,21.4487,21.6021,21.5255,21.5605,21.3959,21.6034,21.8389],"outpenaltygoalratio":[19.3251,19.2852,19.0112,19.3077,19.1733,19.0634,19.4824,19.3849,19.3842,19.3467,18.974,19.3071,19.0336,19.083,19.2962,19.0445,18.8106,18.9104,19.2346,19.2806,19.4418,18.9606,18.9828,18.7841,18.6812,18.7439,18.8635,18.8804,18.9521,19.0481],"avggoalheading":[0.27259,0.27755,0.26653,0.26974,0.26804,0.26844,0.26324,0.26636,0.26903,0.26271,0.26233,0.25947,0.26521,0.26686,0.26798,0.27024,0.27251,0.27262,0.27247,0.26743,0.26809,0.27325,0.27453,0.27383,0.26798,0.27248,0.27017,0.27119,0.2687,0.26852],"goalheadingratio":[10.4748,10.7289,10.4162,9.97328,9.97649,10.1412,10.0299,10.1797,10.2795,10.0384,9.99802,9.88451,10.1059,10.2309,10.2676,10.3846,10.4532,10.4833,10.491,10.2585,10.3549,10.5923,10.5841,10.6444,10.3574,10.561,10.471,10.5441,10.4086,10.4523],"avgpasstry":[106.575,106.326,105.841,104.085,104.472,105.174,105.417,105.628,105.659,105.721,105.081,105.507,105.781,106.086,106.495,105.767,106.019,105.477,105.106,105.931,106.541,106.184,106.478,106.306,105.78,106.335,106.004,106.417,106.519,106.625],"avgpasssuccess":[96.6542,96.4842,95.9273,93.7966,94.3213,95.0129,95.3042,95.6042,95.6428,95.7046,95.0914,95.4295,95.7074,95.9769,96.43,95.7758,96.0097,95.4949,95.1048,95.8825,96.4806,96.1574,96.4601,96.3364,95.8164,96.3231,96.0204,96.3811,96.4537,96.6303],"passsuccessratio":[90.6911,90.7437,90.633,90.1151,90.2839,90.3388,90.4069,90.5098,90.5206,90.5255,90.493,90.4484,90.4766,90.4711,90.5491,90.5534,90.5589,90.5362,90.4848,90.5138,90.5576,90.5576,90.5913,90.6216,90.5806,90.5849,90.5819,90.5692,90.5503,90.6261],"avgowngoal":[0.01815,0.0173,0.01913,0.0175,0.0155,0.01749,0.01708,0.01613,0.01761,0.01693,0.01843,0.01675,0.01693,0.01785,0.01719,0.01689,0.01827,0.01653,0.01715,0.01809,0.01785,0.0181,0.01771,0.01876,0.01712,0.01719,0.01748,0.01736,0.0171,0.01867],"avgpossession":[50.5915,50.5787,50.5147,50.7866,50.8436,50.8217,50.7317,50.7525,50.7208,50.6609,50.7593,50.7059,50.7266,50.7067,50.766,50.6703,50.615,50.7179,50.6662,50.6075,50.6469,50.5779,50.5876,50.6302,50.6627,50.6381,50.5936,50.6161,50.5132,50.5006],"avgdribble":[73.3215,73.4348,73.2855,72.4168,72.4096,72.6823,72.6392,72.9379,72.8566,72.7727,72.4336,72.6483,73.0276,72.9731,73.3465,73.1336,73.0036,72.6223,72.565,73.0006,73.1532,73.1278,73.244,73.3195,72.9998,73.294,73.1928,73.3049,73.2743,73.3579],"avgtacklesuccess":[6.00812,5.94724,5.96538,6.27185,6.21807,6.1261,6.08219,6.00835,5.98959,6.03587,6.0441,6.09142,6.08499,6.03858,5.99476,6.016,6.034,6.03551,6.06281,6.083,6.02349,5.97492,5.97329,6.01973,6.05154,6.0346,6.07743,5.97064,6.01424,5.96239],"avgtackletry":[11.3416,11.2018,11.2064,11.602,11.5535,11.4064,11.3339,11.235,11.2351,11.3193,11.292,11.3936,11.3665,11.2946,11.2184,11.2864,11.2921,11.2906,11.3074,11.4117,11.2693,11.2346,11.2358,11.2413,11.3042,11.2691,11.3632,11.1908,11.3285,11.2238],"avgblocksuccess":[0.62829,0.63148,0.62816,0.63731,0.62455,0.64058,0.63432,0.64047,0.6327,0.63929,0.6216,0.63018,0.63117,0.62796,0.63662,0.62113,0.61907,0.628,0.6192,0.63776,0.64085,0.63403,0.616,0.62561,0.61835,0.62345,0.62132,0.62716,0.62158,0.62988],"avgblocktry":[8.25627,8.27927,8.29407,8.21634,8.23242,8.28624,8.31697,8.26705,8.28442,8.33349,8.21604,8.2487,8.24819,8.27824,8.30113,8.20837,8.21881,8.18425,8.22526,8.35109,8.30344,8.30838,8.25224,8.30324,8.19986,8.28441,8.25245,8.29895,8.31573,8.33996],"avgfoul":[0.69954,0.68593,0.68705,0.70159,0.70543,0.69271,0.68856,0.68149,0.68039,0.69226,0.69632,0.68816,0.69438,0.68814,0.68536,0.69276,0.69004,0.69281,0.69499,0.69735,0.69395,0.69071,0.68552,0.69617,0.69985,0.69988,0.70131,0.68142,0.69117,0.68033],"avgshootfreekick":[0.17989,0.17526,0.17424,0.17842,0.18012,0.17701,0.17035,0.17795,0.17542,0.18019,0.17962,0.17964,0.1787,0.18019,0.18217,0.18045,0.18213,0.18002,0.1826,0.18087,0.17927,0.1827,0.18054,0.18575,0.18694,0.187,0.1813,0.17928,0.18415,0.18966],"avgshootpenaltykick":[0.08024,0.07771,0.08129,0.08332,0.08195,0.08053,0.0791,0.07775,0.07867,0.07869,0.08158,0.07942,0.08024,0.08024,0.08143,0.08041,0.08077,0.07744,0.08072,0.08002,0.07825,0.07651,0.08225,0.08003,0.07915,0.08,0.08059,0.07848,0.07871,0.07944],"avgshootheading":[0.90916,0.91525,0.88832,0.94708,0.9368,0.93759,0.91677,0.92328,0.92275,0.90894,0.90439,0.90619,0.90624,0.91911,0.91826,0.92275,0.92766,0.92991,0.92735,0.90885,0.92265,0.92637,0.92173,0.9253,0.91887,0.92621,0.92182,0.92658,0.9075,0.91021],"avgshortpasstry":[78.2766,77.9898,77.4048,74.4723,74.9842,75.7828,76.0886,76.5334,76.5692,76.5958,76.2671,76.6072,76.6386,76.9088,77.4902,76.8879,76.9869,76.5075,76.2781,77.1008,77.5205,77.1827,77.4129,77.2859,76.8378,77.2864,77.1678,77.3399,77.3793,77.7829],"avgshortpasssuccess":[74.4989,74.2726,73.6638,70.7691,71.2997,72.0736,72.3836,72.8525,72.8868,72.8994,72.5498,72.8515,72.9106,73.159,73.7392,73.1801,73.2846,72.8158,72.5662,73.3386,73.7607,73.4759,73.6916,73.5669,73.115,73.5526,73.4344,73.6022,73.6369,74.016],"avglobpasstry":[4.63798,4.6992,4.66287,4.76292,4.6742,4.74605,4.72091,4.75298,4.76432,4.70813,4.63658,4.65585,4.7187,4.79267,4.79639,4.76924,4.80834,4.79556,4.7628,4.6981,4.77689,4.85328,4.82949,4.80617,4.77999,4.80795,4.72851,4.84822,4.76153,4.74705],"avglobpasssuccess":[2.61863,2.66906,2.65061,2.59973,2.58859,2.63302,2.63279,2.66187,2.68114,2.63714,2.58921,2.60298,2.65715,2.70887,2.71839,2.70035,2.72269,2.73476,2.69188,2.64662,2.71185,2.74856,2.75839,2.72717,2.72588,2.73478,2.67655,2.75955,2.71489,2.69844],"avgdrivengroundpasstry":[3.6633,3.72798,3.65484,3.34087,3.44942,3.4959,3.5376,3.55561,3.61621,3.65526,3.68625,3.61583,3.73956,3.6839,3.68331,3.67228,3.68957,3.79863,3.69471,3.64104,3.67507,3.81585,3.93416,3.82207,3.82093,3.86461,3.78553,3.79278,3.86433,3.86351],"avgdrivengroundpasssuccess":[3.15898,3.22588,3.14536,2.86351,2.95388,2.99803,3.03576,3.06333,3.11367,3.15126,3.18107,3.10252,3.21631,3.17214,3.17788,3.16382,3.18148,3.27846,3.19276,3.13579,3.16802,3.30231,3.41259,3.3056,3.30272,3.3373,3.26115,3.28236,3.33855,3.34582],"avgthroughpasstry":[18.7186,18.6341,18.8301,20.1436,20.0153,19.8152,19.7462,19.4519,19.383,19.4527,19.1904,19.3336,19.3734,19.3855,19.2118,19.1395,19.2327,19.0731,19.0681,19.1898,19.2693,19.0352,19.0015,19.1104,19.0611,19.0837,19.0216,19.1365,19.2021,18.94],"avgthroughpasssuccess":[16.0958,16.0306,16.187,17.2401,17.1654,16.9963,16.9432,16.7109,16.6457,16.7131,16.4797,16.5833,16.6269,16.6416,16.4988,16.4411,16.532,16.3655,16.3634,16.4727,16.547,16.3375,16.3068,16.4579,16.3894,16.4098,16.3598,16.4433,16.4705,16.2837],"avglobbedthroughpasstry":[0.25369,0.26438,0.25528,0.33423,0.31538,0.30923,0.30365,0.30721,0.30456,0.28756,0.27589,0.27569,0.28609,0.28218,0.28054,0.27752,0.26506,0.27579,0.27523,0.2742,0.27423,0.27331,0.27107,0.25604,0.26465,0.26861,0.274,0.27421,0.2696,0.26403],"avglobbedthroughpasssuccess":[0.16212,0.16719,0.16345,0.21298,0.20402,0.20074,0.19691,0.19808,0.1985,0.1879,0.17354,0.17493,0.18171,0.17994,0.17616,0.17531,0.16762,0.17488,0.17197,0.17474,0.17453,0.17433,0.1737,0.16342,0.16677,0.17338,0.17516,0.17568,0.17208,0.16826],"avgcornerkick":[1.74842,1.74214,1.74353,1.83905,1.80743,1.8072,1.80038,1.79387,1.80311,1.78514,1.77797,1.79265,1.77932,1.78457,1.77221,1.76529,1.76593,1.75835,1.76898,1.78318,1.77586,1.77209,1.75454,1.74737,1.75609,1.75151,1.7585,1.78036,1.75319,1.74429],"avgycards":[0.0424,0.04433,0.04416,0.05191,0.05145,0.05136,0.04685,0.04431,0.04335,0.04599,0.0468,0.04707,0.0473,0.04697,0.04418,0.04302,0.04436,0.04391,0.04665,0.04512,0.04511,0.04243,0.04104,0.04395,0.0471,0.04532,0.04693,0.04246,0.04152,0.04174],"avgrcards":[0.00692,0.00662,0.00759,0.0078,0.00847,0.00808,0.00706,0.00736,0.00715,0.00746,0.00721,0.00717,0.00773,0.00703,0.00698,0.00647,0.00685,0.00757,0.00733,0.00741,0.00726,0.00652,0.0061,0.00677,0.00806,0.00776,0.00693,0.00669,0.00756,0.00706],"avginjury":[0.11481,0.11558,0.11575,0.12091,0.11952,0.1183,0.11762,0.11488,0.11489,0.11287,0.1129,0.11504,0.1181,0.11619,0.11699,0.11265,0.11415,0.11562,0.11536,0.11519,0.11529,0.11349,0.11737,0.11602,0.11627,0.11527,0.11553,0.11017,0.11505,0.11309],"avgoffsidecnt":[0.5069,0.51166,0.51563,0.53816,0.52564,0.52222,0.5233,0.52187,0.5162,0.5246,0.52366,0.52204,0.52421,0.5168,0.52304,0.51763,0.51746,0.52272,0.51725,0.51486,0.51166,0.51897,0.51503,0.50706,0.51911,0.52508,0.52473,0.51814,0.52177,0.521],"avgavgrating":[4.1931,4.18761,4.18635,4.24361,4.23537,4.22815,4.22136,4.21449,4.21459,4.20788,4.21442,4.21293,4.21461,4.21217,4.21186,4.20665,4.20176,4.206,4.20322,4.20023,4.20468,4.19894,4.19337,4.19348,4.19304,4.19884,4.19442,4.19231,4.19489,4.19368]}
    
    data_2 = {"lengthDate":30,"date":["2024-10-14T00:00:00","2024-10-15T00:00:00","2024-10-16T00:00:00","2024-10-17T00:00:00","2024-10-18T00:00:00","2024-10-19T00:00:00","2024-10-20T00:00:00","2024-10-21T00:00:00","2024-10-22T00:00:00","2024-10-23T00:00:00","2024-10-24T00:00:00","2024-10-25T00:00:00","2024-10-26T00:00:00","2024-10-27T00:00:00","2024-10-28T00:00:00","2024-10-29T00:00:00","2024-10-30T00:00:00","2024-10-31T00:00:00","2024-11-01T00:00:00","2024-11-02T00:00:00","2024-11-03T00:00:00","2024-11-04T00:00:00","2024-11-05T00:00:00","2024-11-06T00:00:00","2024-11-07T00:00:00","2024-11-08T00:00:00","2024-11-09T00:00:00","2024-11-10T00:00:00","2024-11-11T00:00:00","2024-11-12T00:00:00"],"count":[219109,212072,212011,135994,282108,269481,258558,252637,249430,245665,183001,245707,240939,235649,239324,237179,234814,175205,232669,232764,231262,233607,231940,229800,171917,233460,229109,222615,225100,222245],"avggoaltot":[1.51668,1.50533,1.51564,1.54208,1.47323,1.46961,1.47457,1.4779,1.48315,1.48611,1.47831,1.47022,1.47544,1.48038,1.485,1.48187,1.48591,1.48458,1.49118,1.49408,1.49527,1.49813,1.50116,1.50257,1.49744,1.50215,1.50129,1.50401,1.50619,1.50461],"avgshoottot":[4.85904,4.83661,4.86249,4.62937,4.60051,4.62614,4.65141,4.67341,4.69468,4.71609,4.67869,4.69125,4.71836,4.72799,4.74717,4.75605,4.7658,4.73791,4.7773,4.79077,4.79639,4.80674,4.82222,4.83224,4.78941,4.82995,4.8424,4.83651,4.84718,4.85137],"avgeffshoottot":[3.98551,3.96626,3.988,3.82108,3.78653,3.80615,3.82907,3.84513,3.86076,3.87873,3.847,3.85596,3.87905,3.88805,3.90113,3.90874,3.91901,3.8942,3.92594,3.93591,3.9411,3.95056,3.9652,3.97268,3.93921,3.9698,3.97925,3.97647,3.98492,3.98961],"avggoalpenaltykick":[0.0266,0.02649,0.02661,0.02499,0.02521,0.02496,0.02506,0.02499,0.02508,0.02581,0.02563,0.02604,0.02616,0.02608,0.02598,0.0256,0.02648,0.02631,0.02684,0.02607,0.02615,0.02629,0.02629,0.02635,0.02601,0.02697,0.02603,0.02676,0.02629,0.02708],"avggoalfreekick":[0.00327,0.00333,0.00316,0.00318,0.0031,0.00294,0.00323,0.00307,0.00315,0.00316,0.0032,0.00304,0.00289,0.00317,0.00303,0.00309,0.00332,0.00309,0.00322,0.0032,0.00305,0.00315,0.00307,0.00309,0.00309,0.0031,0.0031,0.00316,0.00324,0.00319],"avgshootinpenalty":[3.1156,3.09657,3.11607,2.99555,2.95735,2.97047,2.98098,2.99093,3.00524,3.01816,3.00096,3.00235,3.01906,3.02678,3.03313,3.04008,3.04414,3.03337,3.05779,3.06069,3.06499,3.06935,3.08119,3.07941,3.05893,3.07748,3.08555,3.08195,3.08612,3.09236],"avggoalinpenalty":[1.15487,1.14517,1.15438,1.17465,1.12269,1.12095,1.12203,1.12476,1.1297,1.13004,1.1259,1.11999,1.12276,1.12685,1.1286,1.12676,1.12818,1.12975,1.13341,1.1345,1.13678,1.13844,1.14043,1.13998,1.13733,1.13914,1.14069,1.1404,1.14189,1.14051],"avgshootoutpenalty":[1.70708,1.70391,1.7099,1.5994,1.60896,1.62149,1.63578,1.64788,1.65462,1.6625,1.64276,1.65348,1.66334,1.66554,1.67837,1.68061,1.68549,1.66864,1.68289,1.69436,1.69549,1.70132,1.70494,1.71685,1.69483,1.71572,1.72081,1.71808,1.72513,1.7221],"avggoaloutpenalty":[0.33521,0.33367,0.33464,0.34243,0.32533,0.3237,0.32748,0.32815,0.32837,0.33026,0.32678,0.32419,0.32652,0.32744,0.33042,0.32951,0.33125,0.32852,0.33093,0.3335,0.33234,0.3334,0.33444,0.33625,0.33409,0.33603,0.33457,0.33685,0.33802,0.33702],"middleshoot":[19.6365,19.5826,19.571,21.4097,20.2196,19.9632,20.0198,19.9136,19.8454,19.8652,19.892,19.6068,19.6301,19.66,19.6868,19.6065,19.6529,19.6877,19.6645,19.6831,19.6014,19.5965,19.616,19.585,19.7126,19.5853,19.4428,19.6061,19.5936,19.5703],"outpenaltygoalratio":[22.1017,22.1658,22.0793,22.2055,22.0824,22.0263,22.2085,22.204,22.1398,22.223,22.1047,22.0507,22.1301,22.119,22.2504,22.2361,22.2925,22.1287,22.1927,22.3216,22.226,22.2543,22.2787,22.3781,22.311,22.3699,22.2857,22.3967,22.4417,22.399],"avggoalheading":[0.19326,0.19052,0.19132,0.19128,0.18543,0.18441,0.18322,0.1835,0.18436,0.18489,0.18345,0.18471,0.18363,0.18466,0.1862,0.18528,0.18538,0.18465,0.18576,0.18627,0.18689,0.18635,0.18725,0.18811,0.18768,0.18724,0.18787,0.18773,0.18713,0.18613],"goalheadingratio":[12.7422,12.6566,12.6232,12.4039,12.5869,12.5485,12.4255,12.4164,12.4301,12.4409,12.4092,12.5636,12.4456,12.4736,12.5388,12.5031,12.4758,12.438,12.4575,12.467,12.4985,12.4387,12.4735,12.5191,12.5331,12.4649,12.5137,12.4818,12.4241,12.3706],"avgpasstry":[108.411,108.063,108.395,99.6991,99.165,100.036,101.042,101.767,102.328,102.839,102.974,103.875,104.629,104.828,105.152,105.43,105.658,105.107,105.898,106.358,106.545,106.763,107.02,107.06,106.528,107.182,107.543,107.396,107.642,107.736],"avgpasssuccess":[93.777,93.4754,93.7352,86.4495,85.8708,86.5868,87.5083,88.1504,88.6379,89.0489,89.0811,89.7461,90.4115,90.6059,90.8653,91.0945,91.3057,90.8473,91.4877,91.8824,92.0469,92.2417,92.467,92.4767,92.0782,92.5937,92.9242,92.7945,93.0113,93.1035],"passsuccessratio":[86.501,86.5007,86.4754,86.7104,86.5938,86.5556,86.6056,86.6202,86.621,86.5909,86.5085,86.3982,86.4115,86.4328,86.413,86.4028,86.4159,86.433,86.3924,86.3896,86.3927,86.3988,86.4014,86.3783,86.4358,86.3893,86.4065,86.4044,86.4084,86.4185],"avgowngoal":[0.00724,0.00717,0.00744,0.00606,0.00641,0.00671,0.00651,0.00668,0.00641,0.00661,0.00662,0.00681,0.00695,0.00676,0.00701,0.00685,0.00686,0.00674,0.00688,0.0069,0.00676,0.00703,0.00698,0.00713,0.00672,0.00708,0.00709,0.00707,0.00709,0.00703],"avgpossession":[49.9211,49.9348,49.9281,49.5453,49.7213,49.7839,49.8134,49.8251,49.8311,49.845,49.838,49.855,49.8483,49.8632,49.8567,49.8799,49.8823,49.8773,49.8839,49.8875,49.8981,49.9044,49.8974,49.8996,49.894,49.907,49.9269,49.9231,49.9227,49.9367],"avgdribble":[83.7545,83.4661,83.7131,76.4233,76.545,77.3501,78.1801,78.7614,79.2523,79.6203,79.4497,80.138,80.7408,80.929,81.1839,81.4515,81.6588,81.1376,81.8376,82.2322,82.3951,82.5938,82.7919,82.8404,82.334,82.9672,83.2552,83.1726,83.3457,83.4202],"avgtacklesuccess":[5.54317,5.5223,5.52948,5.2144,5.22807,5.27068,5.30294,5.33365,5.36836,5.38092,5.34303,5.3582,5.38572,5.38974,5.39612,5.42387,5.43098,5.40347,5.43251,5.4666,5.46298,5.48035,5.47599,5.49989,5.4481,5.49494,5.50437,5.50217,5.50628,5.51185],"avgtackletry":[8.19356,8.1591,8.17526,7.72534,7.73166,7.79995,7.84757,7.88974,7.9403,7.95894,7.9025,7.92749,7.96326,7.9753,7.98369,8.02534,8.02957,7.99295,8.03554,8.0767,8.08228,8.10179,8.10444,8.13294,8.05884,8.12485,8.13732,8.13711,8.13762,8.14886],"avgblocksuccess":[0.43784,0.43905,0.44027,0.4047,0.41241,0.41329,0.41937,0.42303,0.425,0.42752,0.42405,0.42505,0.42686,0.43149,0.43078,0.43228,0.43151,0.4296,0.43135,0.43321,0.4371,0.43667,0.43894,0.43844,0.43426,0.4407,0.43939,0.4392,0.44039,0.44123],"avgblocktry":[7.16949,7.1573,7.18048,6.59693,6.68161,6.73176,6.79154,6.83172,6.87461,6.9076,6.86477,6.92153,6.95089,6.96652,6.98836,7.00953,7.01599,6.98089,7.03008,7.07209,7.07873,7.09447,7.1038,7.10326,7.04524,7.11699,7.1405,7.12278,7.1368,7.13622],"avgfoul":[0.78981,0.78763,0.79299,0.73137,0.74091,0.74749,0.75281,0.75845,0.7596,0.76486,0.76012,0.7674,0.76721,0.7678,0.77097,0.77557,0.7774,0.76991,0.77953,0.78245,0.78378,0.78334,0.78536,0.78786,0.77862,0.7872,0.78995,0.79042,0.79047,0.79124],"avgshootfreekick":[0.0866,0.08806,0.08757,0.08253,0.08128,0.08242,0.08307,0.0841,0.0856,0.08597,0.08423,0.0845,0.08399,0.08458,0.08524,0.08602,0.08606,0.08486,0.08569,0.0859,0.08547,0.08573,0.08718,0.08677,0.08536,0.08663,0.08757,0.08679,0.08798,0.0871],"avgshootpenaltykick":[0.03409,0.03395,0.03433,0.03207,0.03214,0.03201,0.03235,0.03251,0.03256,0.03312,0.03289,0.03332,0.03354,0.03348,0.03338,0.03319,0.03396,0.03379,0.03447,0.03347,0.03364,0.03381,0.03377,0.0338,0.03354,0.03451,0.03372,0.03435,0.03372,0.03473],"avgshootheading":[0.97306,0.96623,0.97327,0.90277,0.90464,0.91064,0.90931,0.91185,0.91786,0.92389,0.91959,0.93057,0.93425,0.93402,0.94085,0.94243,0.94444,0.93816,0.9485,0.94815,0.94952,0.95075,0.9563,0.95801,0.94649,0.95389,0.95673,0.95471,0.95783,0.95683],"avgshortpasstry":[63.5822,63.3739,63.5127,58.4896,57.8984,58.3549,59.0843,59.5236,59.8723,60.1135,60.2859,60.7598,61.2268,61.3727,61.5196,61.6771,61.7982,61.5182,61.8858,62.1481,62.2642,62.4079,62.5734,62.5231,62.3755,62.651,62.9113,62.8022,62.9633,63.0305],"avgshortpasssuccess":[61.7106,61.5106,61.6395,56.7883,56.2131,56.6525,57.3695,57.8016,58.1449,58.3753,58.5216,58.9616,59.4218,59.5681,59.7108,59.863,59.9806,59.7096,60.0606,60.3194,60.4305,60.5678,60.7363,60.6808,60.5488,60.8064,61.0658,60.9605,61.1186,61.185],"avglobpasstry":[7.00573,6.9779,7.02421,6.47189,6.51396,6.58845,6.64134,6.68868,6.7323,6.76092,6.68624,6.72377,6.76443,6.76552,6.80478,6.80216,6.80238,6.75686,6.83151,6.85998,6.85993,6.86759,6.89455,6.90244,6.84003,6.90702,6.92297,6.90556,6.91599,6.91872],"avglobpasssuccess":[2.30234,2.28838,2.30304,2.15742,2.14715,2.16089,2.18042,2.19497,2.21196,2.21585,2.19428,2.20757,2.22111,2.22452,2.23255,2.2266,2.22946,2.2102,2.23627,2.24003,2.23858,2.24148,2.24973,2.25167,2.23191,2.25263,2.25732,2.25137,2.25253,2.2566],"avgdrivengroundpasstry":[4.57558,4.56041,4.58283,4.12748,4.15717,4.2129,4.2599,4.29394,4.31708,4.34743,4.35361,4.42363,4.45074,4.47502,4.49216,4.51042,4.54034,4.49952,4.55188,4.57976,4.59319,4.60248,4.6166,4.62778,4.59311,4.6398,4.65815,4.65554,4.67462,4.68734],"avgdrivengroundpasssuccess":[4.42196,4.40709,4.42854,3.9892,4.02036,4.073,4.11826,4.15256,4.17346,4.20368,4.20748,4.2751,4.30164,4.32477,4.3427,4.35882,4.38795,4.34863,4.39933,4.42624,4.44032,4.44918,4.46331,4.47416,4.44074,4.48661,4.50466,4.50245,4.5195,4.53125],"avgthroughpasstry":[23.1845,23.1257,23.2041,21.6012,21.4001,21.5631,21.7714,21.9242,21.9953,22.0984,22.138,22.3073,22.4649,22.4681,22.5544,22.6286,22.673,22.586,22.7473,22.8467,22.8699,22.912,22.9146,22.9695,22.8011,22.9958,23.0467,23.0313,23.0755,23.0805],"avgthroughpasssuccess":[19.5197,19.4764,19.5405,18.232,18.0452,18.1826,18.3662,18.495,18.5591,18.6362,18.6381,18.755,18.8865,18.8955,18.9651,19.0231,19.0665,18.9962,19.1283,19.2102,19.2278,19.2735,19.2698,19.3191,19.1847,19.3432,19.3836,19.3718,19.4118,19.4192],"avglobbedthroughpasstry":[9.19128,9.15329,9.19852,8.18189,8.36741,8.48469,8.45018,8.4982,8.56779,8.67342,8.66961,8.81505,8.87189,8.89772,8.92976,8.95675,8.99023,8.89874,9.02344,9.06388,9.09681,9.11197,9.15782,9.17335,9.06238,9.12558,9.13856,9.13576,9.14688,9.14944],"avglobbedthroughpasssuccess":[5.6409,5.61371,5.6425,5.10762,5.27286,5.34542,5.30095,5.33254,5.37404,5.4435,5.3464,5.37196,5.40558,5.41838,5.4396,5.44722,5.46609,5.40695,5.48685,5.51062,5.53296,5.53293,5.5702,5.57268,5.4964,5.52806,5.53559,5.53042,5.53081,5.53292],"avgcornerkick":[1.9825,1.97106,1.9838,1.82514,1.84942,1.87056,1.87709,1.88778,1.89891,1.91142,1.8915,1.90762,1.91951,1.915,1.93216,1.93514,1.94056,1.92584,1.94595,1.95317,1.95202,1.9575,1.96293,1.96636,1.94786,1.96931,1.97489,1.96961,1.97342,1.98021],"avgycards":[0.07682,0.07594,0.07705,0.07259,0.07205,0.07207,0.07305,0.07395,0.07353,0.07334,0.07346,0.07466,0.07485,0.07429,0.07492,0.07553,0.07545,0.07451,0.0756,0.0757,0.07597,0.07621,0.07689,0.07636,0.07656,0.0764,0.07607,0.07748,0.07682,0.07702],"avgrcards":[0.00309,0.00306,0.00314,0.00272,0.00276,0.00282,0.00288,0.00293,0.00288,0.00313,0.00292,0.00295,0.00299,0.00274,0.00303,0.00298,0.00296,0.00306,0.00301,0.00306,0.00304,0.00303,0.00314,0.00314,0.00312,0.00311,0.00324,0.00302,0.00304,0.00301],"avginjury":[0.14835,0.14723,0.14764,0.13167,0.13223,0.13262,0.13397,0.13497,0.13648,0.13615,0.13863,0.14142,0.14316,0.14358,0.14398,0.14534,0.14461,0.1445,0.14444,0.14641,0.14615,0.1454,0.14593,0.14719,0.14493,0.14682,0.14656,0.1459,0.14674,0.14746],"avgoffsidecnt":[1.64977,1.64678,1.65176,1.48172,1.51885,1.54038,1.54532,1.5595,1.56672,1.57949,1.57749,1.59509,1.61074,1.61475,1.61787,1.63036,1.63884,1.62314,1.64261,1.64769,1.65299,1.66343,1.66603,1.66901,1.65464,1.67181,1.67859,1.67332,1.68,1.68052],"avgavgrating":[4.01641,4.01583,4.01589,4.04781,4.02395,4.02042,4.0201,4.01894,4.01848,4.01774,4.02134,4.01908,4.01948,4.02027,4.01902,4.01882,4.01833,4.01964,4.01798,4.01823,4.01829,4.01724,4.01708,4.01712,4.0179,4.01661,4.01654,4.01619,4.01561,4.01602]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
