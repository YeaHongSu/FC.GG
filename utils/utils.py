import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    data_1 = {"lengthDate":30,"date":["2024-09-28T00:00:00","2024-09-29T00:00:00","2024-09-30T00:00:00","2024-10-01T00:00:00","2024-10-02T00:00:00","2024-10-03T00:00:00","2024-10-04T00:00:00","2024-10-05T00:00:00","2024-10-06T00:00:00","2024-10-07T00:00:00","2024-10-08T00:00:00","2024-10-09T00:00:00","2024-10-10T00:00:00","2024-10-11T00:00:00","2024-10-12T00:00:00","2024-10-13T00:00:00","2024-10-14T00:00:00","2024-10-15T00:00:00","2024-10-16T00:00:00","2024-10-17T00:00:00","2024-10-18T00:00:00","2024-10-19T00:00:00","2024-10-20T00:00:00","2024-10-21T00:00:00","2024-10-22T00:00:00","2024-10-23T00:00:00","2024-10-24T00:00:00","2024-10-25T00:00:00","2024-10-26T00:00:00","2024-10-27T00:00:00"],"count":[36294,34910,25502,34378,24754,38371,30012,31605,30599,23762,22369,30839,23089,24683,28538,27586,20649,19444,20172,42207,50171,47405,42951,33688,33730,33720,32141,34719,37568,36408],"avggoaltot":[2.59319,2.5926,2.59949,2.62235,2.60598,2.60103,2.59631,2.61946,2.60441,2.61136,2.58101,2.59696,2.60453,2.5969,2.60111,2.56735,2.60237,2.58692,2.55885,2.70467,2.68671,2.64699,2.62459,2.61659,2.61713,2.61701,2.62378,2.62502,2.62436,2.60832],"avgshoottot":[7.00624,6.98495,6.96912,7.03555,7.013,7.04606,7.01588,7.06386,7.04166,6.98815,6.97516,6.97468,6.99777,6.98004,6.97099,6.93041,6.99305,6.94499,6.88315,7.39099,7.28191,7.22329,7.17794,7.14001,7.15706,7.10282,7.093,7.13146,7.1065,7.09769],"avgeffshoottot":[5.3292,5.31469,5.30553,5.34975,5.32877,5.35841,5.33585,5.37693,5.36129,5.32432,5.30195,5.31462,5.32753,5.31175,5.30916,5.27581,5.33185,5.28569,5.25032,5.59971,5.54154,5.48954,5.46566,5.44519,5.44687,5.41903,5.41435,5.43385,5.42168,5.40256],"avggoalpenaltykick":[0.06395,0.06358,0.06316,0.06257,0.06395,0.0612,0.06384,0.06283,0.06352,0.06343,0.06261,0.06146,0.06129,0.06156,0.06257,0.06231,0.06247,0.0606,0.06213,0.06478,0.06312,0.06241,0.06078,0.06018,0.06033,0.06094,0.06312,0.06269,0.06271,0.06255],"avggoalfreekick":[0.01779,0.01744,0.01786,0.01782,0.01907,0.01807,0.0183,0.0182,0.01811,0.01869,0.01822,0.01906,0.01871,0.0175,0.01884,0.01904,0.01846,0.01942,0.01687,0.01813,0.01775,0.01741,0.01791,0.01744,0.01731,0.01823,0.0171,0.01784,0.01704,0.01804],"avgshootinpenalty":[4.63659,4.63415,4.65773,4.66396,4.62401,4.67982,4.66454,4.66644,4.62455,4.61528,4.59855,4.6239,4.64585,4.63644,4.6306,4.58571,4.6259,4.59486,4.55248,4.93432,4.85165,4.81926,4.75182,4.73295,4.73664,4.69588,4.70439,4.71811,4.71595,4.69999],"avggoalinpenalty":[2.03289,2.03527,2.05334,2.05271,2.0358,2.04546,2.04249,2.04473,2.02863,2.04791,2.01376,2.03437,2.04636,2.04417,2.04523,2.00858,2.03699,2.02742,2.01025,2.11768,2.10845,2.07998,2.05248,2.04918,2.04949,2.04976,2.06283,2.05552,2.06214,2.04802],"avgshootoutpenalty":[2.28005,2.26055,2.22174,2.28365,2.29833,2.27921,2.26113,2.30914,2.32882,2.28414,2.28781,2.26493,2.26456,2.2572,2.25207,2.25844,2.27995,2.26504,2.24167,2.36512,2.34097,2.31618,2.33987,2.32258,2.33443,2.32141,2.2994,2.32666,2.30224,2.30945],"avggoaloutpenalty":[0.49635,0.49376,0.483,0.50708,0.50624,0.49437,0.48998,0.51191,0.51226,0.50001,0.50464,0.50113,0.49688,0.49117,0.49331,0.49646,0.50291,0.49889,0.48647,0.52221,0.51513,0.50461,0.51133,0.50722,0.50731,0.50631,0.49784,0.50681,0.49951,0.49774],"middleshoot":[21.7691,21.8425,21.7397,22.2046,22.0264,21.6904,21.6699,22.1688,21.9964,21.8907,22.0579,22.1256,21.9416,21.7601,21.9046,21.9827,22.0579,22.0257,21.7012,22.0796,22.005,21.7862,21.8531,21.8388,21.7317,21.8102,21.6508,21.7829,21.6966,21.5525],"outpenaltygoalratio":[19.1404,19.045,18.5806,19.3367,19.426,19.0067,18.8723,19.5425,19.6688,19.1477,19.5522,19.2967,19.0776,18.9136,18.9653,19.3376,19.3251,19.2852,19.0112,19.3077,19.1733,19.0634,19.4824,19.3849,19.3842,19.3467,18.974,19.3071,19.0336,19.083],"avggoalheading":[0.25149,0.25764,0.26408,0.26478,0.2596,0.26131,0.2644,0.26789,0.26633,0.25903,0.26151,0.26035,0.27352,0.26708,0.26994,0.27437,0.27259,0.27755,0.26653,0.26974,0.26804,0.26844,0.26324,0.26636,0.26903,0.26271,0.26233,0.25947,0.26521,0.26686],"goalheadingratio":[9.69793,9.93733,10.1589,10.097,9.96187,10.0464,10.1835,10.227,10.226,9.91939,10.132,10.0251,10.5018,10.2847,10.3779,10.6868,10.4748,10.7289,10.4162,9.97328,9.97649,10.1412,10.0299,10.1797,10.2795,10.0384,9.99802,9.88451,10.1059,10.2309],"avgpasstry":[105.774,105.921,106.078,106.428,105.897,105.81,106.091,106.058,106.378,106.58,106.411,106.678,105.947,106.004,106.27,106.404,106.575,106.326,105.841,104.085,104.472,105.174,105.417,105.628,105.659,105.721,105.081,105.507,105.781,106.086],"avgpasssuccess":[95.811,95.9269,96.036,96.4325,95.9282,95.8486,96.0615,96.0698,96.4205,96.6393,96.4888,96.7046,95.97,96.1021,96.2969,96.4194,96.6542,96.4842,95.9273,93.7966,94.3213,95.0129,95.3042,95.6042,95.6428,95.7046,95.0914,95.4295,95.7074,95.9769],"passsuccessratio":[90.5812,90.5644,90.5332,90.6083,90.5862,90.5859,90.5462,90.5819,90.6398,90.6731,90.6755,90.6508,90.583,90.659,90.6153,90.6164,90.6911,90.7437,90.633,90.1151,90.2839,90.3388,90.4069,90.5098,90.5206,90.5255,90.493,90.4484,90.4766,90.4711],"avgowngoal":[0.01746,0.01724,0.01775,0.01823,0.0178,0.0167,0.01795,0.02018,0.01772,0.01738,0.01737,0.01799,0.01751,0.0181,0.01803,0.01876,0.01815,0.0173,0.01913,0.0175,0.0155,0.01749,0.01708,0.01613,0.01761,0.01693,0.01843,0.01675,0.01693,0.01785],"avgpossession":[50.8147,50.7376,50.6869,50.6469,50.658,50.6454,50.6497,50.5931,50.6154,50.5955,50.6001,50.5512,50.6149,50.7036,50.5348,50.5492,50.5915,50.5787,50.5147,50.7866,50.8436,50.8217,50.7317,50.7525,50.7208,50.6609,50.7593,50.7059,50.7266,50.7067],"avgdribble":[73.2148,73.2837,73.2854,73.4424,73.158,73.1259,73.1382,73.1615,73.4761,73.5968,73.5555,73.6982,73.046,73.278,73.1941,73.344,73.3215,73.4348,73.2855,72.4168,72.4096,72.6823,72.6392,72.9379,72.8566,72.7727,72.4336,72.6483,73.0276,72.9731],"avgtacklesuccess":[6.10643,6.06374,6.12946,6.09547,6.09558,6.07587,6.04345,5.99241,6.02061,6.03888,6.03389,6.01355,6.08988,6.05171,6.06134,5.98833,6.00812,5.94724,5.96538,6.27185,6.21807,6.1261,6.08219,6.00835,5.98959,6.03587,6.0441,6.09142,6.08499,6.03858],"avgtackletry":[11.3336,11.2929,11.4254,11.3528,11.3713,11.2985,11.2963,11.1681,11.2515,11.2906,11.3011,11.2678,11.4043,11.3439,11.3214,11.2518,11.3416,11.2018,11.2064,11.602,11.5535,11.4064,11.3339,11.235,11.2351,11.3193,11.292,11.3936,11.3665,11.2946],"avgblocksuccess":[0.61831,0.62915,0.62696,0.62251,0.63328,0.62807,0.62845,0.63556,0.63564,0.63853,0.63365,0.63514,0.61598,0.61429,0.62621,0.63292,0.62829,0.63148,0.62816,0.63731,0.62455,0.64058,0.63432,0.64047,0.6327,0.63929,0.6216,0.63018,0.63117,0.62796],"avgblocktry":[8.19821,8.2436,8.18425,8.22911,8.26758,8.24082,8.24414,8.30359,8.35732,8.30083,8.29208,8.28547,8.21402,8.20301,8.31504,8.26621,8.25627,8.27927,8.29407,8.21634,8.23242,8.28624,8.31697,8.26705,8.28442,8.33349,8.21604,8.2487,8.24819,8.27824],"avgfoul":[0.69736,0.69613,0.69754,0.69124,0.69417,0.69168,0.69552,0.68428,0.69578,0.68594,0.69667,0.6918,0.69573,0.69104,0.69969,0.69532,0.69954,0.68593,0.68705,0.70159,0.70543,0.69271,0.68856,0.68149,0.68039,0.69226,0.69632,0.68816,0.69438,0.68814],"avgshootfreekick":[0.18202,0.17759,0.18336,0.17718,0.18547,0.18122,0.1791,0.18074,0.18282,0.1854,0.18109,0.17939,0.18309,0.18297,0.18285,0.18052,0.17989,0.17526,0.17424,0.17842,0.18012,0.17701,0.17035,0.17795,0.17542,0.18019,0.17962,0.17964,0.1787,0.18019],"avgshootpenaltykick":[0.08213,0.0824,0.08185,0.08017,0.08321,0.07969,0.08248,0.08135,0.08113,0.08075,0.08145,0.07893,0.08001,0.0792,0.08131,0.07956,0.08024,0.07771,0.08129,0.08332,0.08195,0.08053,0.0791,0.07775,0.07867,0.07869,0.08158,0.07942,0.08024,0.08024],"avgshootheading":[0.868,0.86824,0.88862,0.89363,0.88171,0.89152,0.89399,0.90018,0.89198,0.86844,0.88622,0.88256,0.92111,0.8985,0.89858,0.9174,0.90916,0.91525,0.88832,0.94708,0.9368,0.93759,0.91677,0.92328,0.92275,0.90894,0.90439,0.90619,0.90624,0.91911],"avgshortpasstry":[77.1799,77.2227,77.2436,77.8173,77.2107,77.1572,77.3847,77.4284,77.8719,77.9668,77.856,78.0356,77.1305,77.4754,77.6701,77.8134,78.2766,77.9898,77.4048,74.4723,74.9842,75.7828,76.0886,76.5334,76.5692,76.5958,76.2671,76.6072,76.6386,76.9088],"avgshortpasssuccess":[73.4248,73.4496,73.4635,74.0427,73.4493,73.3989,73.6169,73.6658,74.1034,74.2202,74.1189,74.2564,73.3855,73.7596,73.9115,74.0469,74.4989,74.2726,73.6638,70.7691,71.2997,72.0736,72.3836,72.8525,72.8868,72.8994,72.5498,72.8515,72.9106,73.159],"avglobpasstry":[4.57222,4.54547,4.57012,4.57986,4.58606,4.58751,4.61395,4.61329,4.59953,4.58224,4.59035,4.57426,4.6147,4.6052,4.61287,4.67758,4.63798,4.6992,4.66287,4.76292,4.6742,4.74605,4.72091,4.75298,4.76432,4.70813,4.63658,4.65585,4.7187,4.79267],"avglobpasssuccess":[2.56983,2.55901,2.57071,2.56794,2.59897,2.58926,2.59072,2.58759,2.59046,2.57977,2.58433,2.57277,2.62158,2.60179,2.61142,2.64562,2.61863,2.66906,2.65061,2.59973,2.58859,2.63302,2.63279,2.66187,2.68114,2.63714,2.58921,2.60298,2.65715,2.70887],"avgdrivengroundpasstry":[3.68973,3.76619,3.72078,3.56908,3.75028,3.65163,3.68366,3.68336,3.74065,3.76127,3.78437,3.68804,3.87516,3.69055,3.69305,3.64562,3.6633,3.72798,3.65484,3.34087,3.44942,3.4959,3.5376,3.55561,3.61621,3.65526,3.68625,3.61583,3.73956,3.6839],"avgdrivengroundpasssuccess":[3.17533,3.23814,3.20047,3.06313,3.228,3.13617,3.16094,3.16376,3.21993,3.23909,3.26742,3.17491,3.34513,3.17014,3.17411,3.14513,3.15898,3.22588,3.14536,2.86351,2.95388,2.99803,3.03576,3.06333,3.11367,3.15126,3.18107,3.10252,3.21631,3.17214],"avgthroughpasstry":[19.0342,19.0934,19.2391,19.1759,19.0512,19.1246,19.1156,19.0478,18.8803,18.9832,18.8958,19.0886,19.0245,18.9564,18.9925,18.9741,18.7186,18.6341,18.8301,20.1436,20.0153,19.8152,19.7462,19.4519,19.383,19.4527,19.1904,19.3336,19.3734,19.3855],"avgthroughpasssuccess":[16.3534,16.3899,16.5167,16.4792,16.3602,16.4425,16.4046,16.3699,16.2285,16.3168,16.2351,16.4186,16.3324,16.2932,16.3083,16.2993,16.0958,16.0306,16.187,17.2401,17.1654,16.9963,16.9432,16.7109,16.6457,16.7131,16.4797,16.5833,16.6269,16.6416],"avglobbedthroughpasstry":[0.27647,0.2765,0.27032,0.26556,0.2768,0.2676,0.27401,0.26673,0.25942,0.27071,0.2576,0.27307,0.2633,0.25414,0.272,0.26261,0.25369,0.26438,0.25528,0.33423,0.31538,0.30923,0.30365,0.30721,0.30456,0.28756,0.27589,0.27569,0.28609,0.28218],"avglobbedthroughpasssuccess":[0.17432,0.1753,0.16876,0.16901,0.1757,0.1689,0.17431,0.1681,0.16302,0.17007,0.1656,0.17441,0.16684,0.16105,0.1734,0.16733,0.16212,0.16719,0.16345,0.21298,0.20402,0.20074,0.19691,0.19808,0.1985,0.1879,0.17354,0.17493,0.18171,0.17994],"avgcornerkick":[1.76122,1.74946,1.74254,1.7458,1.74779,1.76734,1.76158,1.78079,1.76246,1.76786,1.76168,1.74669,1.74774,1.76584,1.7534,1.75346,1.74842,1.74214,1.74353,1.83905,1.80743,1.8072,1.80038,1.79387,1.80311,1.78514,1.77797,1.79265,1.77932,1.78457],"avgycards":[0.04647,0.04663,0.04438,0.04559,0.04709,0.04525,0.04657,0.04324,0.04234,0.04344,0.04303,0.0455,0.04425,0.04469,0.04526,0.04188,0.0424,0.04433,0.04416,0.05191,0.05145,0.05136,0.04685,0.04431,0.04335,0.04599,0.0468,0.04707,0.0473,0.04697],"avgrcards":[0.00739,0.00698,0.00718,0.00735,0.00731,0.00672,0.00777,0.00681,0.00739,0.00745,0.00667,0.00704,0.00794,0.00745,0.00675,0.00702,0.00692,0.00662,0.00759,0.0078,0.00847,0.00808,0.00706,0.00736,0.00715,0.00746,0.00721,0.00717,0.00773,0.00703],"avginjury":[0.11604,0.11425,0.11679,0.11714,0.11716,0.11405,0.11526,0.11637,0.11593,0.11743,0.11522,0.1146,0.11591,0.11668,0.11497,0.11729,0.11481,0.11558,0.11575,0.12091,0.11952,0.1183,0.11762,0.11488,0.11489,0.11287,0.1129,0.11504,0.1181,0.11619],"avgoffsidecnt":[0.51665,0.51575,0.52714,0.51884,0.51573,0.5163,0.51765,0.51283,0.51239,0.51217,0.51493,0.51507,0.51208,0.5153,0.51753,0.51301,0.5069,0.51166,0.51563,0.53816,0.52564,0.52222,0.5233,0.52187,0.5162,0.5246,0.52366,0.52204,0.52421,0.5168],"avgavgrating":[4.2113,4.20877,4.2084,4.20494,4.20924,4.20493,4.20502,4.2041,4.20213,4.1956,4.19158,4.19764,4.18976,4.19702,4.19189,4.19424,4.1931,4.18761,4.18635,4.24361,4.23537,4.22815,4.22136,4.21449,4.21459,4.20788,4.21442,4.21293,4.21461,4.21217]}
    
    data_2 = {"lengthDate":30,"date":["2024-09-28T00:00:00","2024-09-29T00:00:00","2024-09-30T00:00:00","2024-10-01T00:00:00","2024-10-02T00:00:00","2024-10-03T00:00:00","2024-10-04T00:00:00","2024-10-05T00:00:00","2024-10-06T00:00:00","2024-10-07T00:00:00","2024-10-08T00:00:00","2024-10-09T00:00:00","2024-10-10T00:00:00","2024-10-11T00:00:00","2024-10-12T00:00:00","2024-10-13T00:00:00","2024-10-14T00:00:00","2024-10-15T00:00:00","2024-10-16T00:00:00","2024-10-17T00:00:00","2024-10-18T00:00:00","2024-10-19T00:00:00","2024-10-20T00:00:00","2024-10-21T00:00:00","2024-10-22T00:00:00","2024-10-23T00:00:00","2024-10-24T00:00:00","2024-10-25T00:00:00","2024-10-26T00:00:00","2024-10-27T00:00:00"],"count":[239834,232897,236861,226136,173638,230125,233141,228287,233353,233199,230752,228125,170887,228152,224155,220927,219109,212072,212011,135994,282108,269481,258558,252637,249430,245665,183001,245707,240939,235649],"avggoaltot":[1.45278,1.46123,1.47563,1.47535,1.47792,1.48577,1.49162,1.49568,1.49892,1.50308,1.50413,1.50613,1.50426,1.50762,1.51013,1.50999,1.51668,1.50533,1.51564,1.54208,1.47323,1.46961,1.47457,1.4779,1.48315,1.48611,1.47831,1.47022,1.47544,1.48038],"avgshoottot":[4.66402,4.67854,4.72026,4.72275,4.71376,4.75196,4.77989,4.78759,4.79988,4.8113,4.81363,4.82867,4.79478,4.83165,4.85319,4.83973,4.85904,4.83661,4.86249,4.62937,4.60051,4.62614,4.65141,4.67341,4.69468,4.71609,4.67869,4.69125,4.71836,4.72799],"avgeffshoottot":[3.82376,3.8347,3.87212,3.87173,3.86775,3.89781,3.92007,3.92636,3.93672,3.94771,3.94773,3.96264,3.93543,3.96539,3.97893,3.96876,3.98551,3.96626,3.988,3.82108,3.78653,3.80615,3.82907,3.84513,3.86076,3.87873,3.847,3.85596,3.87905,3.88805],"avggoalpenaltykick":[0.02551,0.0251,0.02541,0.02543,0.02557,0.02591,0.02568,0.02623,0.02646,0.02651,0.0268,0.02591,0.02605,0.02633,0.0265,0.02621,0.0266,0.02649,0.02661,0.02499,0.02521,0.02496,0.02506,0.02499,0.02508,0.02581,0.02563,0.02604,0.02616,0.02608],"avggoalfreekick":[0.0031,0.00308,0.00313,0.00311,0.00323,0.00316,0.00316,0.00315,0.00324,0.00304,0.00309,0.00306,0.00321,0.00319,0.0033,0.00319,0.00327,0.00333,0.00316,0.00318,0.0031,0.00294,0.00323,0.00307,0.00315,0.00316,0.0032,0.00304,0.00289,0.00317],"avgshootinpenalty":[2.98413,2.99682,3.02946,3.03445,3.02763,3.0482,3.06185,3.06872,3.07763,3.08621,3.08573,3.09866,3.07708,3.09761,3.11037,3.10361,3.1156,3.09657,3.11607,2.99555,2.95735,2.97047,2.98098,2.99093,3.00524,3.01816,3.00096,3.00235,3.01906,3.02678],"avggoalinpenalty":[1.10763,1.11543,1.12685,1.12762,1.12738,1.13388,1.13764,1.14023,1.14174,1.14507,1.14637,1.14922,1.1453,1.14835,1.14958,1.15037,1.15487,1.14517,1.15438,1.17465,1.12269,1.12095,1.12203,1.12476,1.1297,1.13004,1.1259,1.11999,1.12276,1.12685],"avgshootoutpenalty":[1.64496,1.64731,1.6558,1.65327,1.65111,1.66801,1.68262,1.68279,1.68621,1.68901,1.69134,1.69419,1.6821,1.69759,1.70641,1.69984,1.70708,1.70391,1.7099,1.5994,1.60896,1.62149,1.63578,1.64788,1.65462,1.6625,1.64276,1.65348,1.66334,1.66554],"avggoaloutpenalty":[0.31964,0.3207,0.32336,0.3223,0.32497,0.32599,0.3283,0.32921,0.33072,0.3315,0.33096,0.331,0.33291,0.33295,0.33405,0.33341,0.33521,0.33367,0.33464,0.34243,0.32533,0.3237,0.32748,0.32815,0.32837,0.33026,0.32678,0.32419,0.32652,0.32744],"middleshoot":[19.4315,19.4678,19.5291,19.4949,19.6822,19.5434,19.5114,19.5634,19.6132,19.6269,19.5678,19.5374,19.7914,19.6129,19.5764,19.6142,19.6365,19.5826,19.571,21.4097,20.2196,19.9632,20.0198,19.9136,19.8454,19.8652,19.892,19.6068,19.6301,19.66],"outpenaltygoalratio":[22.002,21.947,21.9136,21.8458,21.9886,21.9405,22.0097,22.0108,22.0639,22.0548,22.0034,21.9769,22.1312,22.0843,22.1208,22.0803,22.1017,22.1658,22.0793,22.2055,22.0824,22.0263,22.2085,22.204,22.1398,22.223,22.1047,22.0507,22.1301,22.119],"avggoalheading":[0.18323,0.18449,0.18632,0.18772,0.18683,0.18811,0.18875,0.18977,0.18938,0.19077,0.19031,0.19026,0.19024,0.19082,0.19124,0.19042,0.19326,0.19052,0.19132,0.19128,0.18543,0.18441,0.18322,0.1835,0.18436,0.18489,0.18345,0.18471,0.18363,0.18466],"goalheadingratio":[12.6126,12.6259,12.6265,12.7234,12.6417,12.6607,12.6543,12.688,12.6344,12.6922,12.6523,12.6325,12.6469,12.6568,12.6636,12.6107,12.7422,12.6566,12.6232,12.4039,12.5869,12.5485,12.4255,12.4164,12.4301,12.4409,12.4092,12.5636,12.4456,12.4736],"avgpasstry":[105.661,105.61,106.094,106.077,105.831,106.384,107.115,106.993,107.321,107.391,107.721,107.783,107.201,107.934,108.299,108.041,108.411,108.063,108.395,99.6991,99.165,100.036,101.042,101.767,102.328,102.839,102.974,103.875,104.629,104.828],"avgpasssuccess":[91.5543,91.446,91.8365,91.84,91.6038,92.0606,92.6894,92.5451,92.8064,92.8773,93.1821,93.2384,92.737,93.3666,93.6781,93.4649,93.777,93.4754,93.7352,86.4495,85.8708,86.5868,87.5083,88.1504,88.6379,89.0489,89.0811,89.7461,90.4115,90.6059],"passsuccessratio":[86.649,86.5883,86.5617,86.5786,86.5571,86.5358,86.5324,86.4967,86.4754,86.4856,86.5032,86.506,86.5075,86.5033,86.4998,86.5084,86.501,86.5007,86.4754,86.7104,86.5938,86.5556,86.6056,86.6202,86.621,86.5909,86.5085,86.3982,86.4115,86.4328],"avgowngoal":[0.00682,0.00681,0.00685,0.00681,0.00682,0.00702,0.00717,0.00726,0.00718,0.00725,0.00713,0.00703,0.00726,0.00743,0.00719,0.00698,0.00724,0.00717,0.00744,0.00606,0.00641,0.00671,0.00651,0.00668,0.00641,0.00661,0.00662,0.00681,0.00695,0.00676],"avgpossession":[49.8637,49.8637,49.8724,49.8696,49.8669,49.8763,49.8909,49.893,49.8854,49.89,49.8982,49.9182,49.8907,49.9151,49.921,49.9109,49.9211,49.9348,49.9281,49.5453,49.7213,49.7839,49.8134,49.8251,49.8311,49.845,49.838,49.855,49.8483,49.8632],"avgdribble":[81.455,81.4131,81.7597,81.7678,81.4809,82.0504,82.6482,82.5698,82.8481,82.8847,83.1585,83.2285,82.7071,83.3604,83.6545,83.4743,83.7545,83.4661,83.7131,76.4233,76.545,77.3501,78.1801,78.7614,79.2523,79.6203,79.4497,80.138,80.7408,80.929],"avgtacklesuccess":[5.41798,5.42914,5.45071,5.44378,5.42975,5.46288,5.47604,5.49166,5.50791,5.49836,5.50613,5.51732,5.49343,5.50793,5.52851,5.51249,5.54317,5.5223,5.52948,5.2144,5.22807,5.27068,5.30294,5.33365,5.36836,5.38092,5.34303,5.3582,5.38572,5.38974],"avgtackletry":[8.01151,8.02134,8.04957,8.03785,8.0243,8.06498,8.09581,8.11529,8.14066,8.13147,8.1369,8.15035,8.116,8.14579,8.16888,8.14928,8.19356,8.1591,8.17526,7.72534,7.73166,7.79995,7.84757,7.88974,7.9403,7.95894,7.9025,7.92749,7.96326,7.9753],"avgblocksuccess":[0.42341,0.42318,0.42334,0.42448,0.42569,0.42808,0.43186,0.43319,0.43361,0.43436,0.43633,0.43377,0.43255,0.43745,0.44011,0.43925,0.43784,0.43905,0.44027,0.4047,0.41241,0.41329,0.41937,0.42303,0.425,0.42752,0.42405,0.42505,0.42686,0.43149],"avgblocktry":[6.98681,6.99835,7.02996,7.02104,7.01099,7.05275,7.09743,7.11044,7.12888,7.12578,7.13909,7.13345,7.09625,7.15633,7.18015,7.15477,7.16949,7.1573,7.18048,6.59693,6.68161,6.73176,6.79154,6.83172,6.87461,6.9076,6.86477,6.92153,6.95089,6.96652],"avgfoul":[0.7732,0.77337,0.77818,0.77568,0.77151,0.77725,0.78084,0.78473,0.78718,0.78693,0.78587,0.78752,0.78594,0.78631,0.79293,0.78701,0.78981,0.78763,0.79299,0.73137,0.74091,0.74749,0.75281,0.75845,0.7596,0.76486,0.76012,0.7674,0.76721,0.7678],"avgshootfreekick":[0.08514,0.08502,0.08501,0.08489,0.08533,0.08574,0.08528,0.08534,0.08629,0.08684,0.08601,0.08628,0.08602,0.0865,0.08809,0.08656,0.0866,0.08806,0.08757,0.08253,0.08128,0.08242,0.08307,0.0841,0.0856,0.08597,0.08423,0.0845,0.08399,0.08458],"avgshootpenaltykick":[0.03271,0.03219,0.03276,0.03277,0.03291,0.03351,0.0332,0.03383,0.03379,0.03381,0.03432,0.03346,0.03338,0.03418,0.03425,0.03392,0.03409,0.03395,0.03433,0.03207,0.03214,0.03201,0.03235,0.03251,0.03256,0.03312,0.03289,0.03332,0.03354,0.03348],"avgshootheading":[0.92738,0.93087,0.94484,0.9426,0.94029,0.95022,0.95492,0.95509,0.95874,0.96275,0.96142,0.96531,0.95768,0.96593,0.97051,0.96688,0.97306,0.96623,0.97327,0.90277,0.90464,0.91064,0.90931,0.91185,0.91786,0.92389,0.91959,0.93057,0.93425,0.93402],"avgshortpasstry":[62.4727,62.2954,62.4455,62.4567,62.2683,62.5252,62.9579,62.7918,62.9552,63.0006,63.2239,63.262,62.9145,63.3105,63.5343,63.3907,63.5822,63.3739,63.5127,58.4896,57.8984,58.3549,59.0843,59.5236,59.8723,60.1135,60.2859,60.7598,61.2268,61.3727],"avgshortpasssuccess":[60.6363,60.4557,60.5962,60.6171,60.4296,60.6792,61.1015,60.9339,61.0918,61.1386,61.3614,61.3999,61.0614,61.4496,61.6644,61.5284,61.7106,61.5106,61.6395,56.7883,56.2131,56.6525,57.3695,57.8016,58.1449,58.3753,58.5216,58.9616,59.4218,59.5681],"avglobpasstry":[6.72192,6.74756,6.81995,6.81064,6.80775,6.85012,6.8961,6.91181,6.9334,6.93935,6.94855,6.95365,6.90396,6.96735,6.99827,6.97412,7.00573,6.9779,7.02421,6.47189,6.51396,6.58845,6.64134,6.68868,6.7323,6.76092,6.68624,6.72377,6.76443,6.76552],"avglobpasssuccess":[2.21357,2.22098,2.25402,2.24615,2.24295,2.25745,2.26829,2.27133,2.27532,2.28019,2.27935,2.2823,2.26841,2.28607,2.29706,2.28639,2.30234,2.28838,2.30304,2.15742,2.14715,2.16089,2.18042,2.19497,2.21196,2.21585,2.19428,2.20757,2.22111,2.22452],"avgdrivengroundpasstry":[4.3254,4.33773,4.3697,4.37914,4.37377,4.42492,4.46821,4.46972,4.4899,4.50348,4.52328,4.52233,4.49504,4.55273,4.56943,4.55995,4.57558,4.56041,4.58283,4.12748,4.15717,4.2129,4.2599,4.29394,4.31708,4.34743,4.35361,4.42363,4.45074,4.47502],"avgdrivengroundpasssuccess":[4.17831,4.19028,4.22055,4.23034,4.22514,4.27502,4.31719,4.3187,4.33731,4.35066,4.37057,4.36924,4.34492,4.40028,4.4159,4.40712,4.42196,4.40709,4.42854,3.9892,4.02036,4.073,4.11826,4.15256,4.17346,4.20368,4.20748,4.2751,4.30164,4.32477],"avgthroughpasstry":[22.6968,22.7117,22.8286,22.7964,22.7593,22.846,22.9677,22.9789,23.0481,23.0329,23.0849,23.0972,22.9947,23.1061,23.1591,23.0932,23.1845,23.1257,23.2041,21.6012,21.4001,21.5631,21.7714,21.9242,21.9953,22.0984,22.138,22.3073,22.4649,22.4681],"avgthroughpasssuccess":[19.1197,19.1217,19.2232,19.1967,19.1655,19.2344,19.3367,19.3472,19.3956,19.3901,19.4355,19.4461,19.3546,19.4511,19.4961,19.4463,19.5197,19.4764,19.5405,18.232,18.0452,18.1826,18.3662,18.495,18.5591,18.6362,18.6381,18.755,18.8865,18.8955],"avglobbedthroughpasstry":[8.59063,8.6642,8.77243,8.77352,8.76336,8.87556,8.95741,8.97339,9.02717,9.04423,9.07206,9.07833,9.02753,9.1309,9.16489,9.15146,9.19128,9.15329,9.19852,8.18189,8.36741,8.48469,8.45018,8.4982,8.56779,8.67342,8.66961,8.81505,8.87189,8.89772],"avglobbedthroughpasssuccess":[5.23115,5.28172,5.36621,5.37145,5.3632,5.43717,5.48663,5.49404,5.52739,5.53717,5.55552,5.56038,5.5291,5.60069,5.6234,5.61577,5.6409,5.61371,5.6425,5.10762,5.27286,5.34542,5.30095,5.33254,5.37404,5.4435,5.3464,5.37196,5.40558,5.41838],"avgcornerkick":[1.89713,1.90547,1.91993,1.92131,1.91534,1.93316,1.9501,1.95207,1.95803,1.96238,1.96116,1.969,1.95135,1.9714,1.97922,1.97298,1.9825,1.97106,1.9838,1.82514,1.84942,1.87056,1.87709,1.88778,1.89891,1.91142,1.8915,1.90762,1.91951,1.915],"avgycards":[0.07653,0.07542,0.07474,0.07526,0.07457,0.07593,0.07554,0.07536,0.07707,0.07652,0.07713,0.07645,0.07647,0.0754,0.07711,0.07649,0.07682,0.07594,0.07705,0.07259,0.07205,0.07207,0.07305,0.07395,0.07353,0.07334,0.07346,0.07466,0.07485,0.07429],"avgrcards":[0.00288,0.00298,0.00303,0.00283,0.00291,0.00298,0.00298,0.00309,0.00313,0.00313,0.00297,0.00297,0.00315,0.003,0.00306,0.00308,0.00309,0.00306,0.00314,0.00272,0.00276,0.00282,0.00288,0.00293,0.00288,0.00313,0.00292,0.00295,0.00299,0.00274],"avginjury":[0.14325,0.14296,0.14412,0.1436,0.14295,0.14482,0.14526,0.14583,0.14733,0.14747,0.14727,0.14719,0.14642,0.14767,0.14735,0.14812,0.14835,0.14723,0.14764,0.13167,0.13223,0.13262,0.13397,0.13497,0.13648,0.13615,0.13863,0.14142,0.14316,0.14358],"avgoffsidecnt":[1.53551,1.54623,1.56159,1.56687,1.56149,1.58563,1.60344,1.60569,1.61272,1.61907,1.62799,1.63057,1.61881,1.63515,1.64209,1.64141,1.64977,1.64678,1.65176,1.48172,1.51885,1.54038,1.54532,1.5595,1.56672,1.57949,1.57749,1.59509,1.61074,1.61475],"avgavgrating":[4.01351,4.01475,4.01526,4.01752,4.01828,4.01747,4.01607,4.01663,4.01669,4.01712,4.01645,4.01794,4.01768,4.01552,4.01666,4.01661,4.01641,4.01583,4.01589,4.04781,4.02395,4.02042,4.0201,4.01894,4.01848,4.01774,4.02134,4.01908,4.01948,4.02027]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
