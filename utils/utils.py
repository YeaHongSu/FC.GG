import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    # match_type = "50" -> 공경
    data_1 = {"lengthDate":30,"date":["2025-12-28T00:00:00","2025-12-29T00:00:00","2025-12-30T00:00:00","2025-12-31T00:00:00","2026-01-01T00:00:00","2026-01-02T00:00:00","2026-01-03T00:00:00","2026-01-04T00:00:00","2026-01-05T00:00:00","2026-01-06T00:00:00","2026-01-07T00:00:00","2026-01-08T00:00:00","2026-01-09T00:00:00","2026-01-10T00:00:00","2026-01-11T00:00:00","2026-01-12T00:00:00","2026-01-13T00:00:00","2026-01-14T00:00:00","2026-01-15T00:00:00","2026-01-16T00:00:00","2026-01-17T00:00:00","2026-01-18T00:00:00","2026-01-19T00:00:00","2026-01-20T00:00:00","2026-01-21T00:00:00","2026-01-22T00:00:00","2026-01-23T00:00:00","2026-01-24T00:00:00","2026-01-25T00:00:00","2026-01-26T00:00:00"],"count":[20257,15020,19442,18382,23003,20566,21763,21064,16091,15948,16775,47952,44628,46349,45190,32853,32132,32111,30452,29398,37885,37297,28291,27224,27098,25432,26973,34190,32613,24458],"avggoaltot":[2.8536,2.8272,2.7655,2.7564,2.7899,2.8426,2.8533,2.8339,2.8191,2.8498,2.8285,2.7228,2.7144,2.7178,2.6975,2.6614,2.6617,2.6528,2.6237,2.636,2.6772,2.6839,2.6759,2.6914,2.6998,2.7315,2.7339,2.6727,2.6866,2.6811],"avgshoottot":[7.2313,7.1654,7.0546,6.9906,7.0804,7.1629,7.2242,7.1804,7.1725,7.1344,7.1185,7.2142,7.1334,7.1059,7.1275,6.9894,7.0402,6.991,6.92,6.9646,7.0501,7.0533,7.0659,7.0939,7.0535,7.1385,7.1412,6.9809,7.0053,6.9665],"avgeffshoottot":[5.5655,5.5318,5.4257,5.3747,5.4331,5.5213,5.5591,5.5274,5.516,5.5084,5.485,5.5552,5.5334,5.5271,5.5319,5.4383,5.4714,5.4269,5.3679,5.3973,5.4734,5.4748,5.4851,5.5096,5.477,5.5558,5.5467,5.4255,5.4505,5.4163],"avggoalpenaltykick":[0.057,0.0582,0.0571,0.0574,0.0551,0.0578,0.0561,0.0565,0.0556,0.0574,0.0571,0.054,0.0564,0.0534,0.0519,0.0539,0.0559,0.0534,0.0532,0.0526,0.0553,0.0551,0.0552,0.0559,0.0562,0.0564,0.0569,0.0559,0.0576,0.0551],"avggoalfreekick":[0.0218,0.0237,0.0234,0.0233,0.0244,0.0242,0.0224,0.0248,0.0224,0.0235,0.0239,0.0216,0.0218,0.0221,0.0214,0.0218,0.0213,0.0221,0.0206,0.0228,0.022,0.0217,0.0234,0.0203,0.0232,0.0234,0.0239,0.0222,0.023,0.0234],"avgshootinpenalty":[4.7058,4.6923,4.5583,4.5438,4.6081,4.6557,4.6739,4.6458,4.6451,4.6503,4.5982,4.704,4.6296,4.6256,4.6067,4.5443,4.5608,4.5365,4.5144,4.542,4.5815,4.5765,4.5777,4.6402,4.5983,4.6533,4.6595,4.5683,4.5908,4.5881],"avggoalinpenalty":[2.2152,2.1949,2.1286,2.1327,2.1536,2.196,2.1989,2.1804,2.1789,2.2058,2.1804,2.112,2.1076,2.1174,2.0961,2.0717,2.0689,2.0666,2.0548,2.0591,2.0851,2.0874,2.0788,2.1052,2.1046,2.1312,2.1288,2.0912,2.1008,2.1048],"avgshootoutpenalty":[2.4404,2.3874,2.4118,2.3628,2.3906,2.4215,2.466,2.4505,2.4458,2.3997,2.436,2.4303,2.4201,2.4008,2.4425,2.3643,2.3968,2.3757,2.3251,2.3436,2.3864,2.3944,2.4068,2.3705,2.3709,2.4002,2.3989,2.3294,2.3295,2.2966],"avggoaloutpenalty":[0.5813,0.5741,0.5798,0.5663,0.5812,0.5889,0.5982,0.597,0.5846,0.5866,0.591,0.5567,0.5504,0.547,0.5495,0.5359,0.537,0.5328,0.5157,0.5244,0.5368,0.5414,0.5419,0.5303,0.5391,0.5439,0.5482,0.5256,0.5282,0.5212],"middleshoot":[23.8194,24.0453,24.0406,23.968,24.3142,24.3184,24.2582,24.36,23.9042,24.4442,24.2635,22.9064,22.7434,22.7847,22.497,22.6666,22.4034,22.4277,22.1804,22.3745,22.4961,22.6115,22.5159,22.3733,22.7371,22.6606,22.8505,22.5628,22.6762,22.6934],"outpenaltygoalratio":[20.3708,20.3063,20.9655,20.5449,20.8323,20.7169,20.9652,21.0664,20.7371,20.5839,20.8945,20.4459,20.277,20.1266,20.3707,20.136,20.1751,20.0844,19.6554,19.8938,20.0508,20.1721,20.2511,19.7035,19.9681,19.9121,20.0519,19.6655,19.6605,19.4398],"avggoalheading":[0.3305,0.3329,0.3193,0.3173,0.3227,0.3288,0.3372,0.3323,0.3313,0.3357,0.3227,0.3254,0.3023,0.2985,0.2936,0.2876,0.2809,0.2798,0.2784,0.276,0.2774,0.2844,0.2794,0.2824,0.2731,0.2767,0.2788,0.2739,0.277,0.2716],"goalheadingratio":[11.5815,11.774,11.5452,11.5128,11.5667,11.5681,11.818,11.7263,11.7511,11.7813,11.4084,11.9506,11.1384,10.9824,10.8846,10.8064,10.5531,10.5491,10.6126,10.4691,10.3606,10.5959,10.4423,10.4936,10.1146,10.13,10.199,10.2494,10.309,10.1316],"avgpasstry":[111.07,111.396,108.498,107.617,108.585,109.112,110.523,110.743,110.587,110.464,110.75,103.782,103.582,104.848,105.34,104.954,105.072,104.762,104.461,103.644,104.596,105.205,105.693,106.677,106.953,107.505,107.991,105.91,106.231,107.083],"avgpasssuccess":[100.355,100.706,98.1058,97.2757,98.0848,98.4905,99.7878,100.089,99.9739,99.8827,100.173,92.486,92.4191,93.8089,94.354,94.0822,94.2964,94.0667,93.8133,92.9965,93.8674,94.4563,94.9839,95.9055,96.2532,96.683,97.0819,95.1992,95.5352,96.3067],"passsuccessratio":[90.3531,90.4043,90.422,90.391,90.3303,90.2659,90.2868,90.3798,90.4027,90.4214,90.4498,89.1154,89.2229,89.4712,89.5707,89.6414,89.7449,89.7907,89.8073,89.7267,89.7428,89.7832,89.8676,89.903,89.9958,89.9334,89.8979,89.8869,89.9317,89.9368],"avgowngoal":[0.0151,0.0143,0.0144,0.015,0.0151,0.0158,0.0161,0.0146,0.0143,0.0157,0.0145,0.0152,0.0149,0.0146,0.0138,0.0143,0.014,0.0142,0.0145,0.0153,0.0147,0.0145,0.015,0.0144,0.0153,0.0149,0.0149,0.0154,0.0157,0.0145],"avgpossession":[50.4857,50.5739,50.6581,50.6816,50.5887,50.5666,50.5513,50.6001,50.5272,50.4967,50.4836,50.6778,50.7133,50.7154,50.6609,50.7197,50.6903,50.6262,50.6946,50.6494,50.6592,50.5808,50.6112,50.6154,50.6315,50.5623,50.5995,50.6074,50.5807,50.4865],"avgdribble":[77.0863,77.3441,75.3244,74.9467,75.4807,75.5873,76.5298,76.7295,76.8736,76.6911,76.8337,72.8588,72.8197,73.649,73.7535,73.7257,73.7956,73.7942,73.5701,73.1259,73.4602,74.0716,74.4328,75.0918,75.2645,75.6347,75.8666,74.4636,74.5416,75.2455],"avgtacklesuccess":[6.5226,6.5022,6.3608,6.3456,6.408,6.4744,6.4691,6.3628,6.4615,6.4444,6.3948,6.4785,6.4593,6.4538,6.4037,6.4063,6.407,6.4464,6.4159,6.4468,6.4935,6.466,6.4732,6.5342,6.5184,6.611,6.6717,6.5588,6.5064,6.5703],"avgtackletry":[12.5122,12.4885,12.252,12.199,12.3224,12.4578,12.4675,12.2715,12.4512,12.4204,12.3875,12.3194,12.3495,12.3293,12.2836,12.2628,12.2868,12.4159,12.3354,12.3482,12.4555,12.4154,12.4612,12.5735,12.5683,12.7807,12.8941,12.6766,12.564,12.7091],"avgblocksuccess":[0.6543,0.6383,0.6235,0.6276,0.629,0.635,0.6481,0.6491,0.6566,0.6459,0.651,0.5203,0.5246,0.5292,0.5379,0.5321,0.5311,0.5292,0.5285,0.5311,0.5402,0.5519,0.5545,0.5586,0.5574,0.5704,0.5676,0.5596,0.5652,0.5708],"avgblocktry":[8.9399,8.9181,8.6917,8.6287,8.7464,8.8305,8.9409,8.9569,8.8775,8.846,8.8882,5.4144,5.1079,5.1462,5.2033,5.1248,5.1415,5.1408,5.093,5.074,5.1621,5.1887,5.2056,5.2445,5.2166,5.3122,5.2906,5.206,5.2249,5.2229],"avgfoul":[0.7108,0.6926,0.6936,0.6852,0.6951,0.6983,0.6985,0.6891,0.6929,0.6968,0.6922,0.7038,0.7065,0.6988,0.697,0.6852,0.7004,0.7014,0.7004,0.6914,0.6994,0.7003,0.7049,0.7044,0.7042,0.7187,0.7176,0.7158,0.709,0.7164],"avgshootfreekick":[0.1719,0.1754,0.1745,0.1734,0.174,0.1723,0.1731,0.1781,0.169,0.1718,0.1697,0.176,0.1786,0.1734,0.1717,0.1698,0.1754,0.1789,0.1742,0.1778,0.1728,0.1765,0.1787,0.1771,0.178,0.1849,0.1838,0.1808,0.1812,0.1872],"avgshootpenaltykick":[0.0768,0.0783,0.0773,0.0768,0.0741,0.0773,0.0763,0.0756,0.0751,0.0763,0.0773,0.0729,0.0769,0.0724,0.0708,0.0736,0.0753,0.0722,0.0732,0.0719,0.0755,0.0746,0.0748,0.0761,0.0778,0.0777,0.0761,0.0763,0.0784,0.0751],"avgshootheading":[1.0079,1.0188,1.001,0.991,1.003,1.0039,1.0294,1.0206,1.021,1.0147,0.9882,1.0495,0.9952,0.9735,0.9762,0.9671,0.946,0.9513,0.9385,0.9441,0.9519,0.9595,0.9542,0.9621,0.9295,0.9395,0.9472,0.9287,0.9226,0.9207],"avgshortpasstry":[78.884,79.5722,77.4187,76.6057,77.3375,77.5573,78.8068,79.195,79.059,78.7979,79.0575,72.3793,72.616,74.1148,74.6289,74.3687,74.7833,74.6702,74.3367,73.4539,74.5328,74.9721,75.4399,76.1966,76.8853,76.8989,77.2862,75.8211,76.0188,76.4217],"avgshortpasssuccess":[75.0442,75.7267,73.6998,72.9026,73.5622,73.7747,74.9569,75.374,75.2347,75.002,75.2303,68.4927,68.74,70.2045,70.7223,70.4692,70.8922,70.7769,70.4774,69.6027,70.6322,71.0739,71.5287,72.2592,72.9498,72.9127,73.2761,71.8757,72.1021,72.4619],"avglobpasstry":[5.5255,5.5144,5.4038,5.3601,5.4165,5.5044,5.569,5.5352,5.5176,5.4514,5.3989,5.5978,5.415,5.3106,5.3071,5.2517,5.176,5.1714,5.1483,5.1473,5.1963,5.1856,5.1954,5.2311,5.1397,5.228,5.2062,5.1185,5.1002,5.18],"avglobpasssuccess":[3.0087,2.9966,2.9243,2.9113,2.9362,2.9701,3.0201,3.0018,3.0065,2.9558,2.926,2.8785,2.8032,2.7723,2.7735,2.777,2.7187,2.7348,2.7334,2.7335,2.7433,2.7479,2.7632,2.7797,2.7265,2.7916,2.7658,2.7146,2.7039,2.7535],"avgdrivengroundpasstry":[6.2879,6.3649,6.0745,6.1764,5.9769,5.9944,6.065,6.0681,6.2394,6.3573,6.5042,5.1796,5.4619,5.4813,5.6281,5.8831,5.8265,5.8018,5.8617,5.9627,5.7762,5.9,6.0893,6.2312,6.1736,6.1989,6.1498,6.0359,6.1464,6.5622],"avgdrivengroundpasssuccess":[5.6198,5.6926,5.4306,5.5138,5.3315,5.3487,5.4058,5.4135,5.5869,5.6993,5.8324,4.5681,4.8408,4.8528,4.9908,5.2291,5.1664,5.1533,5.2042,5.2974,5.1305,5.233,5.4235,5.5414,5.4784,5.5116,5.4597,5.3553,5.4532,5.837],"avgthroughpasstry":[18.8012,18.36,18.0655,17.935,18.3262,18.4986,18.5023,18.3666,18.2219,18.283,18.2391,18.5095,17.7315,17.7107,17.6544,17.3525,17.301,17.182,17.2062,17.1837,17.1904,17.2487,17.1307,17.1663,16.9223,17.3408,17.4783,17.1049,17.1665,17.1113],"avgthroughpasssuccess":[16.2811,15.8904,15.6651,15.5595,15.8777,16.0076,16.0054,15.9036,15.7673,15.8295,15.7969,15.822,15.1738,15.1847,15.1284,14.8762,14.8632,14.7619,14.785,14.7476,14.7471,14.7961,14.6901,14.7334,14.5357,14.9009,15.0062,14.6947,14.7301,14.7],"avglobbedthroughpasstry":[0.3704,0.3818,0.3601,0.3671,0.3519,0.3701,0.3725,0.376,0.3513,0.3589,0.3598,1.0103,1.2335,1.098,0.996,0.9715,0.8401,0.7967,0.7597,0.7664,0.7605,0.7536,0.702,0.7016,0.6612,0.6661,0.6737,0.6569,0.6331,0.63],"avglobbedthroughpasssuccess":[0.2446,0.2533,0.2382,0.2445,0.2328,0.2433,0.2475,0.2489,0.2336,0.2388,0.2386,0.6044,0.7326,0.6661,0.6092,0.5995,0.5206,0.4999,0.4721,0.4786,0.4738,0.4716,0.4465,0.4467,0.4184,0.4223,0.4276,0.4168,0.4039,0.4026],"avgcornerkick":[1.8903,1.8759,1.8649,1.8225,1.85,1.8902,1.9067,1.8864,1.8901,1.8755,1.8732,1.8986,1.89,1.8852,1.8999,1.8603,1.8858,1.8646,1.8418,1.8454,1.8689,1.8644,1.8702,1.8829,1.8649,1.8861,1.8972,1.8571,1.8556,1.8338],"avgycards":[0.0476,0.0407,0.043,0.0428,0.0434,0.0439,0.0443,0.0444,0.0429,0.044,0.0411,0.0505,0.0485,0.044,0.0456,0.043,0.0435,0.0423,0.0416,0.0411,0.04,0.0384,0.0413,0.0411,0.0409,0.0416,0.0416,0.0422,0.0413,0.0398],"avgrcards":[0.0074,0.0052,0.0066,0.0061,0.0066,0.0062,0.0069,0.0059,0.006,0.0073,0.0068,0.0068,0.0063,0.0063,0.0058,0.0052,0.006,0.0053,0.0057,0.0057,0.0058,0.0051,0.0052,0.0053,0.006,0.0059,0.0053,0.0058,0.0053,0.0061],"avginjury":[0.1381,0.1363,0.1327,0.1341,0.1387,0.1362,0.1364,0.1352,0.1392,0.1391,0.1376,0.136,0.1326,0.1374,0.1335,0.1327,0.1307,0.1336,0.1322,0.1305,0.1368,0.1333,0.1336,0.1366,0.1336,0.1374,0.1365,0.1365,0.1375,0.1347],"avgoffsidecnt":[0.4464,0.4496,0.4352,0.4327,0.4375,0.4415,0.4431,0.4396,0.4381,0.4396,0.4397,0.4384,0.4341,0.4294,0.4204,0.4173,0.4177,0.4141,0.4112,0.4133,0.4222,0.4173,0.4169,0.4133,0.4129,0.4265,0.4254,0.4171,0.4128,0.4194],"avgavgrating":[4.23127,4.21973,4.21165,4.20822,4.20794,4.21702,4.21524,4.21136,4.21311,4.21528,4.21411,4.22897,4.22483,4.22686,4.22319,4.21746,4.20964,4.20892,4.20156,4.20512,4.21347,4.20803,4.20045,4.21216,4.20268,4.20971,4.20848,4.19864,4.19324,4.19534]}

    # match_type = "52" ->  감모
    data_2 = {"lengthDate":30,"date":["2025-12-28T00:00:00","2025-12-29T00:00:00","2025-12-30T00:00:00","2025-12-31T00:00:00","2026-01-01T00:00:00","2026-01-02T00:00:00","2026-01-03T00:00:00","2026-01-04T00:00:00","2026-01-05T00:00:00","2026-01-06T00:00:00","2026-01-07T00:00:00","2026-01-08T00:00:00","2026-01-09T00:00:00","2026-01-10T00:00:00","2026-01-11T00:00:00","2026-01-12T00:00:00","2026-01-13T00:00:00","2026-01-14T00:00:00","2026-01-15T00:00:00","2026-01-16T00:00:00","2026-01-17T00:00:00","2026-01-18T00:00:00","2026-01-19T00:00:00","2026-01-20T00:00:00","2026-01-21T00:00:00","2026-01-22T00:00:00","2026-01-23T00:00:00","2026-01-24T00:00:00","2026-01-25T00:00:00","2026-01-26T00:00:00"],"count":[311963,263970,317829,319831,303567,319189,322855,325087,329741,328916,324968,222890,310176,390588,374943,371071,365409,357177,240023,218140,341237,335772,343963,313480,339756,208031,332657,328708,328667,334903],"avggoaltot":[1.5035,1.4992,1.5087,1.5099,1.511,1.5103,1.5104,1.5111,1.5198,1.515,1.5162,1.6143,1.5722,1.5527,1.5591,1.5617,1.5627,1.5655,1.5624,1.5644,1.5712,1.5751,1.5774,1.5803,1.5836,1.5746,1.5817,1.5929,1.5873,1.591],"avgshoottot":[4.853,4.8236,4.8501,4.8527,4.8539,4.8564,4.8544,4.8514,4.8579,4.85,4.8601,4.6372,4.5539,4.5657,4.6058,4.6315,4.6373,4.6515,4.6512,4.6429,4.6776,4.6969,4.7145,4.7153,4.7311,4.706,4.7286,4.7606,4.7587,4.772],"avgeffshoottot":[3.8039,3.7842,3.805,3.8077,3.8083,3.8112,3.8076,3.8068,3.8092,3.8032,3.8115,3.7098,3.641,3.6452,3.6725,3.6923,3.6971,3.7089,3.7076,3.7028,3.7289,3.7442,3.7547,3.76,3.7691,3.7489,3.766,3.7916,3.7869,3.7998],"avggoalpenaltykick":[0.0283,0.0281,0.0283,0.0279,0.0277,0.0278,0.0278,0.0276,0.028,0.028,0.0282,0.0278,0.0266,0.0261,0.0265,0.0265,0.0271,0.0267,0.0265,0.0265,0.0268,0.027,0.0273,0.0268,0.0268,0.0272,0.0274,0.0272,0.0273,0.0274],"avggoalfreekick":[0.0076,0.0076,0.0076,0.0076,0.0075,0.0077,0.0075,0.0074,0.0077,0.0077,0.0077,0.0077,0.0073,0.0071,0.0072,0.0072,0.0072,0.0072,0.007,0.0073,0.0072,0.0072,0.0073,0.0074,0.0073,0.0077,0.0073,0.0076,0.0073,0.0076],"avgshootinpenalty":[2.95,2.9349,2.951,2.9562,2.9572,2.9565,2.9559,2.9544,2.9615,2.9549,2.9615,2.8909,2.8223,2.8161,2.8386,2.8497,2.8501,2.8584,2.8583,2.8571,2.8756,2.8856,2.896,2.8949,2.9047,2.8881,2.9022,2.9248,2.9239,2.9298],"avggoalinpenalty":[1.1034,1.1011,1.1087,1.1097,1.111,1.1087,1.1093,1.1106,1.1171,1.1136,1.1137,1.1963,1.1644,1.1478,1.1538,1.1522,1.1531,1.1554,1.1533,1.1557,1.1612,1.1629,1.1648,1.1678,1.1698,1.1606,1.1684,1.1763,1.1738,1.1752],"avgshootoutpenalty":[1.8613,1.8473,1.8576,1.8553,1.8555,1.8589,1.8574,1.8562,1.8551,1.8536,1.8571,1.7061,1.6929,1.7113,1.7284,1.743,1.7476,1.7539,1.7539,1.7468,1.7627,1.7716,1.7788,1.7809,1.787,1.7782,1.7862,1.7959,1.7951,1.802],"avggoaloutpenalty":[0.3718,0.37,0.3717,0.3722,0.3723,0.3738,0.3733,0.373,0.3746,0.3735,0.3744,0.3903,0.3812,0.3787,0.3788,0.383,0.3826,0.3834,0.3825,0.3822,0.3832,0.3852,0.3853,0.3857,0.387,0.3868,0.3859,0.3894,0.3863,0.3884],"middleshoot":[19.9781,20.0291,20.0103,20.0618,20.0629,20.1105,20.097,20.0924,20.1933,20.1492,20.1603,22.8751,22.5175,22.1317,21.9145,21.9752,21.8931,21.8576,21.8119,21.8786,21.7415,21.7431,21.6629,21.658,21.6562,21.7531,21.6054,21.684,21.5184,21.5541],"outpenaltygoalratio":[24.729,24.6798,24.6371,24.6506,24.6393,24.75,24.7153,24.684,24.648,24.6535,24.6933,24.1777,24.2463,24.3898,24.2961,24.5246,24.4833,24.4906,24.4816,24.4311,24.389,24.4556,24.4263,24.4068,24.438,24.565,24.3978,24.446,24.3369,24.4123],"avggoalheading":[0.1439,0.144,0.1442,0.1445,0.1449,0.1441,0.144,0.1447,0.145,0.145,0.144,0.1555,0.1501,0.1467,0.1476,0.1476,0.1473,0.1467,0.1478,0.1484,0.1484,0.1479,0.1489,0.1487,0.1492,0.1471,0.1481,0.15,0.1487,0.1496],"goalheadingratio":[9.5682,9.6048,9.5552,9.5734,9.5868,9.5408,9.532,9.5758,9.5406,9.5683,9.4963,9.6324,9.5494,9.4511,9.4697,9.4532,9.4247,9.3703,9.4613,9.4849,9.4455,9.3925,9.4384,9.4067,9.4196,9.3423,9.3607,9.4192,9.3692,9.403],"avgpasstry":[108.91,108.345,108.928,108.868,108.798,108.837,108.724,108.755,108.713,108.773,108.819,99.3505,98.5813,100.032,101.425,102.383,102.899,103.562,103.369,103.164,104.204,105.014,105.514,105.71,106.037,105.337,106.329,106.847,106.89,107.262],"avgpasssuccess":[94.9813,94.4787,94.9915,94.9277,94.9049,94.8971,94.8168,94.8373,94.7883,94.8507,94.9057,86.2083,85.5061,86.8411,88.076,88.9252,89.3927,89.9787,89.8069,89.6203,90.5586,91.2893,91.7438,91.933,92.2093,91.5802,92.4819,92.9248,92.9808,93.2855],"passsuccessratio":[87.2111,87.2017,87.206,87.195,87.2301,87.1923,87.2084,87.203,87.1914,87.2005,87.2143,86.7719,86.7366,86.8136,86.8387,86.8551,86.8739,86.8836,86.8797,86.8719,86.905,86.9305,86.9496,86.9671,86.9599,86.94,86.9768,86.9696,86.9878,86.9694],"avgowngoal":[0.0069,0.0071,0.0071,0.0071,0.0072,0.0069,0.0071,0.0072,0.0071,0.007,0.0073,0.0067,0.0068,0.0069,0.007,0.0072,0.0069,0.007,0.007,0.007,0.0072,0.0072,0.0075,0.0072,0.0073,0.0073,0.0071,0.0073,0.0074,0.0074],"avgpossession":[49.9781,49.9758,49.9797,49.9777,49.988,49.9759,49.9719,49.9632,49.9623,49.9513,49.9601,49.6784,49.7884,49.8674,49.8645,49.8885,49.8942,49.9044,49.8765,49.8855,49.8987,49.9037,49.919,49.9239,49.9273,49.9086,49.9228,49.9237,49.9369,49.9341],"avgdribble":[85.7231,85.2243,85.7028,85.6346,85.5869,85.6208,85.5134,85.5438,85.4892,85.5259,85.5558,77.842,77.5306,78.845,80.0285,80.7824,81.2526,81.7787,81.5782,81.4121,82.3553,83.0342,83.4345,83.5959,83.8794,83.2028,84.1282,84.5652,84.6041,84.8734],"avgtacklesuccess":[6.2071,6.1859,6.2193,6.2183,6.2086,6.2257,6.1992,6.212,6.2106,6.2151,6.2113,5.7876,5.7497,5.8044,5.8702,5.9012,5.9265,5.9579,5.9513,5.9561,5.9988,6.0392,6.0582,6.0718,6.0865,6.0495,6.0979,6.1266,6.1226,6.1412],"avgtackletry":[9.1027,9.0651,9.1164,9.1164,9.1005,9.1193,9.0952,9.1092,9.1096,9.1086,9.1083,8.5036,8.4473,8.5188,8.6171,8.6664,8.6989,8.744,8.7397,8.7419,8.8056,8.8621,8.8877,8.899,8.9326,8.8793,8.9503,8.992,8.9856,9.0141],"avgblocksuccess":[0.4702,0.4663,0.4696,0.4674,0.4683,0.4691,0.4695,0.4682,0.4663,0.4678,0.4688,0.3294,0.3076,0.3132,0.3186,0.3214,0.3247,0.3282,0.3299,0.3293,0.3316,0.3354,0.3411,0.3407,0.342,0.3403,0.3409,0.349,0.3526,0.353],"avgblocktry":[7.5845,7.5439,7.5883,7.5813,7.5634,7.5759,7.5733,7.5758,7.5664,7.5728,7.5837,4.5894,3.8595,3.9049,3.959,3.9886,4.0072,4.0251,4.0294,4.0228,4.0586,4.0846,4.1038,4.1129,4.1273,4.1081,4.1311,4.1542,4.1588,4.1717],"avgfoul":[0.8542,0.8479,0.8537,0.8514,0.85,0.8514,0.8491,0.8511,0.8507,0.8489,0.8515,0.7982,0.801,0.8139,0.8223,0.8296,0.8322,0.8357,0.8333,0.8344,0.8427,0.846,0.8501,0.8492,0.8538,0.8484,0.8535,0.8568,0.8593,0.8609],"avgshootfreekick":[0.0962,0.0955,0.096,0.096,0.0946,0.0949,0.0953,0.0947,0.096,0.0957,0.0955,0.0891,0.0898,0.0898,0.0914,0.092,0.0924,0.0931,0.0909,0.0925,0.0933,0.0936,0.0943,0.0943,0.095,0.095,0.0945,0.0948,0.0947,0.0956],"avgshootpenaltykick":[0.0392,0.039,0.0391,0.0389,0.0387,0.0386,0.0388,0.0383,0.0389,0.039,0.039,0.0377,0.0363,0.0359,0.0362,0.0362,0.0371,0.0367,0.0365,0.0367,0.0367,0.0372,0.0372,0.037,0.0368,0.037,0.0376,0.0374,0.0373,0.0377],"avgshootheading":[0.863,0.8563,0.8591,0.8623,0.8621,0.8632,0.861,0.861,0.8626,0.8639,0.862,0.8384,0.8283,0.8246,0.8304,0.8376,0.836,0.8382,0.8385,0.8367,0.8463,0.8471,0.8515,0.8489,0.8527,0.8471,0.8537,0.8593,0.8579,0.8608],"avgshortpasstry":[65.1505,64.7687,65.1056,65.068,65.089,65.05,64.9823,65.0113,64.9388,65.0018,65.0255,58.7024,58.4483,59.5822,60.4658,61.1158,61.4848,61.9089,61.7677,61.615,62.317,62.8754,63.2115,63.3882,63.5884,63.1028,63.8069,64.0933,64.1655,64.3548],"avgshortpasssuccess":[63.4699,63.0974,63.4264,63.3817,63.4115,63.3659,63.3023,63.3294,63.2596,63.3216,63.3471,57.1194,56.8631,57.9752,58.8424,59.478,59.8378,60.252,60.1133,59.9638,60.6552,61.2,61.5262,61.7016,61.8938,61.4232,62.1122,62.3886,62.4618,62.645],"avglobpasstry":[6.5889,6.559,6.587,6.5899,6.5789,6.5972,6.5877,6.5863,6.5853,6.5776,6.5856,6.3182,6.2813,6.3131,6.3904,6.4402,6.4544,6.4844,6.4824,6.4632,6.5163,6.5444,6.5657,6.565,6.5863,6.5621,6.5955,6.6363,6.6354,6.6641],"avglobpasssuccess":[2.1032,2.0927,2.1013,2.1082,2.1038,2.1092,2.108,2.1043,2.1053,2.1063,2.1112,2.0571,2.0339,2.0329,2.0554,2.0686,2.0676,2.0748,2.0759,2.0742,2.088,2.0962,2.1049,2.0983,2.1059,2.0963,2.1102,2.1212,2.1251,2.1262],"avgdrivengroundpasstry":[4.5527,4.5271,4.5515,4.5419,4.536,4.5465,4.541,4.5369,4.547,4.5408,4.5425,4.1387,4.0852,4.134,4.1938,4.2321,4.2592,4.2839,4.2797,4.2714,4.3114,4.3407,4.3557,4.3638,4.3709,4.3536,4.3908,4.4122,4.4087,4.4269],"avgdrivengroundpasssuccess":[4.4138,4.3888,4.4133,4.4028,4.3988,4.4085,4.4026,4.3985,4.4073,4.4017,4.4034,4.0107,3.9598,4.0075,4.0655,4.1028,4.1289,4.1523,4.1489,4.1415,4.1792,4.2078,4.2228,4.2303,4.2375,4.2212,4.2572,4.2779,4.2745,4.2926],"avgthroughpasstry":[23.7132,23.6233,23.77,23.7559,23.7013,23.7382,23.7115,23.72,23.7222,23.7436,23.7597,21.8958,21.6305,21.8271,22.1141,22.2799,22.3561,22.493,22.4509,22.4404,22.6255,22.777,22.884,22.9004,22.9714,22.8308,22.998,23.1097,23.0951,23.1863],"avgthroughpasssuccess":[20.0526,19.9856,20.1073,20.0923,20.0534,20.0756,20.0618,20.064,20.0628,20.0777,20.1025,18.3762,18.1015,18.2725,18.512,18.6509,18.72,18.8349,18.8065,18.7869,18.9473,19.0768,19.1664,19.184,19.2368,19.127,19.2596,19.3602,19.3483,19.4242],"avglobbedthroughpasstry":[7.9742,7.9389,7.9814,7.9785,7.9627,7.9729,7.9718,7.9674,7.9888,7.9793,7.972,7.4408,7.3023,7.3356,7.4144,7.4624,7.4919,7.5347,7.5317,7.517,7.5703,7.6094,7.6282,7.6243,7.6485,7.6174,7.6656,7.7184,7.7086,7.7498],"avglobbedthroughpasssuccess":[4.759,4.7334,4.761,4.7599,4.7554,4.7557,4.7601,4.7586,4.7711,4.7608,4.7575,4.4653,4.3717,4.377,4.4236,4.4471,4.4607,4.4863,4.4846,4.475,4.5096,4.5282,4.5429,4.5375,4.554,4.532,4.5615,4.5942,4.5893,4.6148],"avgcornerkick":[1.9284,1.9223,1.9267,1.9299,1.929,1.9306,1.9276,1.927,1.9249,1.9248,1.9287,1.7831,1.7631,1.7798,1.802,1.8191,1.822,1.8304,1.8319,1.8217,1.8429,1.8508,1.8554,1.8577,1.8605,1.8571,1.866,1.8751,1.8776,1.883],"avgycards":[0.0822,0.0814,0.0821,0.0822,0.0821,0.0815,0.0821,0.082,0.0819,0.0812,0.0817,0.0744,0.0732,0.0747,0.0746,0.0761,0.0764,0.0764,0.0762,0.076,0.0772,0.0784,0.0784,0.0783,0.0783,0.0786,0.0787,0.079,0.0796,0.0789],"avgrcards":[0.0024,0.0024,0.0024,0.0024,0.0024,0.0025,0.0023,0.0024,0.0025,0.0025,0.0025,0.0021,0.0021,0.0021,0.0022,0.0022,0.0022,0.0022,0.0022,0.0022,0.0022,0.0021,0.0022,0.0023,0.0022,0.0023,0.0022,0.0023,0.0023,0.0023],"avginjury":[0.1526,0.1519,0.1524,0.1524,0.1523,0.1523,0.1534,0.1528,0.1521,0.1526,0.1536,0.1396,0.1381,0.1391,0.1425,0.1427,0.1438,0.1441,0.1445,0.1433,0.1452,0.1454,0.1471,0.1461,0.1471,0.1457,0.1479,0.1473,0.1479,0.1489],"avgoffsidecnt":[1.2033,1.1981,1.2065,1.2038,1.2044,1.2052,1.2032,1.2024,1.2041,1.2066,1.2044,1.1021,1.0967,1.108,1.1201,1.1274,1.1339,1.1367,1.1372,1.1345,1.1434,1.148,1.1538,1.1549,1.1596,1.1518,1.1608,1.1673,1.1652,1.1716],"avgavgrating":[3.99277,3.99306,3.99377,3.99425,3.99552,3.99515,3.99501,3.99562,3.99583,3.99546,3.99635,4.02077,4.00488,3.99682,3.99383,3.99261,3.99041,3.98927,3.99094,3.99087,3.98919,3.98832,3.9876,3.98797,3.98705,3.98826,3.98628,3.98673,3.98634,3.98569]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
