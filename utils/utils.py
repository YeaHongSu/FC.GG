import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    data_1 = {"lengthDate":30,"date":["2024-10-23T00:00:00","2024-10-24T00:00:00","2024-10-25T00:00:00","2024-10-26T00:00:00","2024-10-27T00:00:00","2024-10-28T00:00:00","2024-10-29T00:00:00","2024-10-30T00:00:00","2024-10-31T00:00:00","2024-11-01T00:00:00","2024-11-02T00:00:00","2024-11-03T00:00:00","2024-11-04T00:00:00","2024-11-05T00:00:00","2024-11-06T00:00:00","2024-11-07T00:00:00","2024-11-08T00:00:00","2024-11-09T00:00:00","2024-11-10T00:00:00","2024-11-11T00:00:00","2024-11-12T00:00:00","2024-11-13T00:00:00","2024-11-14T00:00:00","2024-11-15T00:00:00","2024-11-16T00:00:00","2024-11-17T00:00:00","2024-11-18T00:00:00","2024-11-19T00:00:00","2024-11-20T00:00:00","2024-11-21T00:00:00"],"count":[33720,32141,34719,37568,36408,26820,26831,26166,25718,29901,33962,30955,25004,24124,23630,23783,24889,28498,27844,21441,21793,22647,47883,43229,44652,41385,30541,29277,29794,25994],"avggoaltot":[2.61701,2.62378,2.62502,2.62436,2.60832,2.60994,2.60229,2.60695,2.60048,2.59714,2.60686,2.58899,2.57974,2.59384,2.57252,2.58737,2.58004,2.58013,2.572,2.58151,2.56899,2.56761,2.67178,2.67239,2.67102,2.63739,2.63832,2.63112,2.61983,2.61578],"avgshoottot":[7.10282,7.093,7.13146,7.1065,7.09769,7.07931,7.02157,7.02128,7.01516,7.05288,7.07003,7.08698,6.99893,6.97695,6.9596,6.97276,6.96623,6.9857,7.00019,6.9645,6.91842,6.89713,7.29059,7.20716,7.19129,7.17814,7.13867,7.08322,7.0441,7.03629],"avgeffshoottot":[5.41903,5.41435,5.43385,5.42168,5.40256,5.39512,5.35671,5.35998,5.34814,5.36365,5.40414,5.39057,5.33963,5.32318,5.30746,5.30657,5.30837,5.33005,5.33776,5.3054,5.27922,5.27742,5.53189,5.49583,5.4804,5.45467,5.42892,5.39636,5.3719,5.3705],"avggoalpenaltykick":[0.06094,0.06312,0.06269,0.06271,0.06255,0.0637,0.06268,0.06338,0.06029,0.06316,0.06181,0.06143,0.0593,0.06374,0.06224,0.06045,0.06216,0.06149,0.06185,0.0607,0.0615,0.06206,0.06385,0.06443,0.06386,0.06171,0.06118,0.06156,0.06138,0.06175],"avggoalfreekick":[0.01823,0.0171,0.01784,0.01704,0.01804,0.01898,0.01735,0.01856,0.01696,0.01759,0.01815,0.01809,0.01847,0.01861,0.01715,0.01731,0.01897,0.01709,0.01793,0.01785,0.01791,0.01917,0.01895,0.0182,0.01829,0.01757,0.01868,0.01865,0.0186,0.01893],"avgshootinpenalty":[4.69588,4.70439,4.71811,4.71595,4.69999,4.67282,4.6556,4.66706,4.66933,4.65306,4.67234,4.66055,4.63997,4.62077,4.61986,4.64921,4.63253,4.6401,4.64486,4.61372,4.59098,4.58774,4.86444,4.82383,4.79982,4.75736,4.71535,4.71502,4.68142,4.69827],"avggoalinpenalty":[2.04976,2.06283,2.05552,2.06214,2.04802,2.04262,2.04401,2.05318,2.04844,2.03444,2.04243,2.02421,2.03131,2.03772,2.02706,2.04357,2.03428,2.03194,2.02455,2.03155,2.01815,2.01738,2.09595,2.10172,2.09951,2.06625,2.06444,2.06526,2.06057,2.06236],"avgshootoutpenalty":[2.32141,2.2994,2.32666,2.30224,2.30945,2.31728,2.27798,2.26579,2.26147,2.31223,2.31064,2.34125,2.27462,2.26609,2.25293,2.23752,2.24664,2.25738,2.26962,2.26469,2.2407,2.22245,2.3356,2.29284,2.30081,2.33332,2.3367,2.2806,2.27712,2.25207],"avggoaloutpenalty":[0.50631,0.49784,0.50681,0.49951,0.49774,0.50362,0.49559,0.49038,0.49176,0.49955,0.50262,0.50334,0.48913,0.49238,0.48323,0.48335,0.4836,0.4867,0.4856,0.48925,0.48934,0.48817,0.51199,0.50624,0.50764,0.50944,0.5127,0.5043,0.49788,0.49168],"middleshoot":[21.8102,21.6508,21.7829,21.6966,21.5525,21.7333,21.7558,21.643,21.7452,21.6047,21.7524,21.499,21.504,21.7284,21.4487,21.6021,21.5255,21.5605,21.3959,21.6034,21.8389,21.9656,21.921,22.0793,22.0637,21.8331,21.9412,22.1125,21.8645,21.8323],"outpenaltygoalratio":[19.3467,18.974,19.3071,19.0336,19.083,19.2962,19.0445,18.8106,18.9104,19.2346,19.2806,19.4418,18.9606,18.9828,18.7841,18.6812,18.7439,18.8635,18.8804,18.9521,19.0481,19.0127,19.1627,18.9434,19.0056,19.3159,19.4328,19.1666,19.0043,18.7966],"avggoalheading":[0.26271,0.26233,0.25947,0.26521,0.26686,0.26798,0.27024,0.27251,0.27262,0.27247,0.26743,0.26809,0.27325,0.27453,0.27383,0.26798,0.27248,0.27017,0.27119,0.2687,0.26852,0.26662,0.26403,0.26196,0.26563,0.27083,0.27201,0.27302,0.27436,0.27161],"goalheadingratio":[10.0384,9.99802,9.88451,10.1059,10.2309,10.2676,10.3846,10.4532,10.4833,10.491,10.2585,10.3549,10.5923,10.5841,10.6444,10.3574,10.561,10.471,10.5441,10.4086,10.4523,10.384,9.88219,9.80228,9.94483,10.2687,10.3099,10.3765,10.4725,10.3836],"avgpasstry":[105.721,105.081,105.507,105.781,106.086,106.495,105.767,106.019,105.477,105.106,105.931,106.541,106.184,106.478,106.306,105.78,106.335,106.004,106.417,106.519,106.625,106.053,103.284,103.934,104.637,105.272,104.932,104.783,104.955,104.071],"avgpasssuccess":[95.7046,95.0914,95.4295,95.7074,95.9769,96.43,95.7758,96.0097,95.4949,95.1048,95.8825,96.4806,96.1574,96.4601,96.3364,95.8164,96.3231,96.0204,96.3811,96.4537,96.6303,96.1404,92.9852,93.783,94.5221,95.1539,94.8535,94.8031,95.0124,94.1958],"passsuccessratio":[90.5255,90.493,90.4484,90.4766,90.4711,90.5491,90.5534,90.5589,90.5362,90.4848,90.5138,90.5576,90.5576,90.5913,90.6216,90.5806,90.5849,90.5819,90.5692,90.5503,90.6261,90.6529,90.0285,90.2336,90.333,90.3882,90.395,90.4759,90.5265,90.5107],"avgowngoal":[0.01693,0.01843,0.01675,0.01693,0.01785,0.01719,0.01689,0.01827,0.01653,0.01715,0.01809,0.01785,0.0181,0.01771,0.01876,0.01712,0.01719,0.01748,0.01736,0.0171,0.01867,0.01755,0.01816,0.0175,0.01662,0.01826,0.01645,0.01747,0.01758,0.01768],"avgpossession":[50.6609,50.7593,50.7059,50.7266,50.7067,50.766,50.6703,50.615,50.7179,50.6662,50.6075,50.6469,50.5779,50.5876,50.6302,50.6627,50.6381,50.5936,50.6161,50.5132,50.5006,50.4763,50.8564,50.86,50.8531,50.8019,50.6654,50.7314,50.7389,50.792],"avgdribble":[72.7727,72.4336,72.6483,73.0276,72.9731,73.3465,73.1336,73.0036,72.6223,72.565,73.0006,73.1532,73.1278,73.244,73.3195,72.9998,73.294,73.1928,73.3049,73.2743,73.3579,73.1507,71.3862,71.7605,72.1312,72.4366,72.1268,72.2562,72.4121,71.9047],"avgtacklesuccess":[6.03587,6.0441,6.09142,6.08499,6.03858,5.99476,6.016,6.034,6.03551,6.06281,6.083,6.02349,5.97492,5.97329,6.01973,6.05154,6.0346,6.07743,5.97064,6.01424,5.96239,6.00235,6.23427,6.20542,6.13526,6.09226,6.06849,6.03218,6.0192,6.00642],"avgtackletry":[11.3193,11.292,11.3936,11.3665,11.2946,11.2184,11.2864,11.2921,11.2906,11.3074,11.4117,11.2693,11.2346,11.2358,11.2413,11.3042,11.2691,11.3632,11.1908,11.3285,11.2238,11.2641,11.5326,11.4836,11.4056,11.3382,11.3006,11.2564,11.2232,11.192],"avgblocksuccess":[0.63929,0.6216,0.63018,0.63117,0.62796,0.63662,0.62113,0.61907,0.628,0.6192,0.63776,0.64085,0.63403,0.616,0.62561,0.61835,0.62345,0.62132,0.62716,0.62158,0.62988,0.62449,0.61927,0.61808,0.6193,0.61763,0.62394,0.62064,0.61471,0.60367],"avgblocktry":[8.33349,8.21604,8.2487,8.24819,8.27824,8.30113,8.20837,8.21881,8.18425,8.22526,8.35109,8.30344,8.30838,8.25224,8.30324,8.19986,8.28441,8.25245,8.29895,8.31573,8.33996,8.30167,8.13081,8.11556,8.14482,8.19564,8.26051,8.19898,8.15002,8.0765],"avgfoul":[0.69226,0.69632,0.68816,0.69438,0.68814,0.68536,0.69276,0.69004,0.69281,0.69499,0.69735,0.69395,0.69071,0.68552,0.69617,0.69985,0.69988,0.70131,0.68142,0.69117,0.68033,0.69198,0.70674,0.70436,0.68757,0.6941,0.69216,0.68849,0.68689,0.6881],"avgshootfreekick":[0.18019,0.17962,0.17964,0.1787,0.18019,0.18217,0.18045,0.18213,0.18002,0.1826,0.18087,0.17927,0.1827,0.18054,0.18575,0.18694,0.187,0.1813,0.17928,0.18415,0.18966,0.18766,0.1818,0.18163,0.18247,0.18627,0.19117,0.18408,0.18505,0.18545],"avgshootpenaltykick":[0.07869,0.08158,0.07942,0.08024,0.08024,0.08143,0.08041,0.08077,0.07744,0.08072,0.08002,0.07825,0.07651,0.08225,0.08003,0.07915,0.08,0.08059,0.07848,0.07871,0.07944,0.07958,0.08301,0.08263,0.08275,0.08036,0.07938,0.0799,0.07868,0.07924],"avgshootheading":[0.90894,0.90439,0.90619,0.90624,0.91911,0.91826,0.92275,0.92766,0.92991,0.92735,0.90885,0.92265,0.92637,0.92173,0.9253,0.91887,0.92621,0.92182,0.92658,0.9075,0.91021,0.89679,0.92418,0.91492,0.91704,0.94007,0.93688,0.92817,0.9244,0.93213],"avgshortpasstry":[76.5958,76.2671,76.6072,76.6386,76.9088,77.4902,76.8879,76.9869,76.5075,76.2781,77.1008,77.5205,77.1827,77.4129,77.2859,76.8378,77.2864,77.1678,77.3399,77.3793,77.7829,77.3094,73.6339,74.5614,75.4082,76.1139,75.7863,75.7784,76.0304,75.1745],"avgshortpasssuccess":[72.8994,72.5498,72.8515,72.9106,73.159,73.7392,73.1801,73.2846,72.8158,72.5662,73.3386,73.7607,73.4759,73.6916,73.5669,73.115,73.5526,73.4344,73.6022,73.6369,74.016,73.5888,69.9097,70.8699,71.6895,72.3879,72.0762,72.1129,72.3575,71.5433],"avglobpasstry":[4.70813,4.63658,4.65585,4.7187,4.79267,4.79639,4.76924,4.80834,4.79556,4.7628,4.6981,4.77689,4.85328,4.82949,4.80617,4.77999,4.80795,4.72851,4.84822,4.76153,4.74705,4.68641,4.70063,4.66827,4.65695,4.74921,4.73467,4.72512,4.70123,4.75996],"avglobpasssuccess":[2.63714,2.58921,2.60298,2.65715,2.70887,2.71839,2.70035,2.72269,2.73476,2.69188,2.64662,2.71185,2.74856,2.75839,2.72717,2.72588,2.73478,2.67655,2.75955,2.71489,2.69844,2.67605,2.56842,2.57678,2.57958,2.64671,2.64387,2.65492,2.65011,2.70613],"avgdrivengroundpasstry":[3.65526,3.68625,3.61583,3.73956,3.6839,3.68331,3.67228,3.68957,3.79863,3.69471,3.64104,3.67507,3.81585,3.93416,3.82207,3.82093,3.86461,3.78553,3.79278,3.86433,3.86351,3.88607,3.41244,3.52399,3.57543,3.61155,3.75223,3.75139,3.79265,3.7082],"avgdrivengroundpasssuccess":[3.15126,3.18107,3.10252,3.21631,3.17214,3.17788,3.16382,3.18148,3.27846,3.19276,3.13579,3.16802,3.30231,3.41259,3.3056,3.30272,3.3373,3.26115,3.28236,3.33855,3.34582,3.36123,2.9303,3.02586,3.06459,3.10262,3.2329,3.23497,3.27167,3.19767],"avgthroughpasstry":[19.4527,19.1904,19.3336,19.3734,19.3855,19.2118,19.1395,19.2327,19.0731,19.0681,19.1898,19.2693,19.0352,19.0015,19.1104,19.0611,19.0837,19.0216,19.1365,19.2021,18.94,18.8902,20.1882,19.8503,19.6822,19.4907,19.358,19.2385,19.1533,19.1642],"avgthroughpasssuccess":[16.7131,16.4797,16.5833,16.6269,16.6416,16.4988,16.4411,16.532,16.3655,16.3634,16.4727,16.547,16.3375,16.3068,16.4579,16.3894,16.4098,16.3598,16.4433,16.4705,16.2837,16.2388,17.2526,17.0063,16.8871,16.7165,16.6102,16.51,16.4461,16.4639],"avglobbedthroughpasstry":[0.28756,0.27589,0.27569,0.28609,0.28218,0.28054,0.27752,0.26506,0.27579,0.27523,0.2742,0.27423,0.27331,0.27107,0.25604,0.26465,0.26861,0.274,0.27421,0.2696,0.26403,0.24367,0.33948,0.30646,0.30226,0.28932,0.27941,0.27422,0.26563,0.26813],"avglobbedthroughpasssuccess":[0.1879,0.17354,0.17493,0.18171,0.17994,0.17616,0.17531,0.16762,0.17488,0.17197,0.17474,0.17453,0.17433,0.1737,0.16342,0.16677,0.17338,0.17516,0.17568,0.17208,0.16826,0.1565,0.2123,0.19132,0.18982,0.18482,0.17589,0.17402,0.16716,0.16865],"avgcornerkick":[1.78514,1.77797,1.79265,1.77932,1.78457,1.77221,1.76529,1.76593,1.75835,1.76898,1.78318,1.77586,1.77209,1.75454,1.74737,1.75609,1.75151,1.7585,1.78036,1.75319,1.74429,1.73503,1.80463,1.78724,1.77908,1.79588,1.78876,1.76317,1.75174,1.75507],"avgycards":[0.04599,0.0468,0.04707,0.0473,0.04697,0.04418,0.04302,0.04436,0.04391,0.04665,0.04512,0.04511,0.04243,0.04104,0.04395,0.0471,0.04532,0.04693,0.04246,0.04152,0.04174,0.04437,0.05832,0.05494,0.04907,0.04773,0.0456,0.04678,0.04598,0.04502],"avgrcards":[0.00746,0.00721,0.00717,0.00773,0.00703,0.00698,0.00647,0.00685,0.00757,0.00733,0.00741,0.00726,0.00652,0.0061,0.00677,0.00806,0.00776,0.00693,0.00669,0.00756,0.00706,0.00663,0.00797,0.0081,0.00821,0.0074,0.00706,0.00767,0.00767,0.00647],"avginjury":[0.11287,0.1129,0.11504,0.1181,0.11619,0.11699,0.11265,0.11415,0.11562,0.11536,0.11519,0.11529,0.11349,0.11737,0.11602,0.11627,0.11527,0.11553,0.11017,0.11505,0.11309,0.11608,0.12176,0.12086,0.11652,0.11931,0.11692,0.11696,0.11519,0.11521],"avgoffsidecnt":[0.5246,0.52366,0.52204,0.52421,0.5168,0.52304,0.51763,0.51746,0.52272,0.51725,0.51486,0.51166,0.51897,0.51503,0.50706,0.51911,0.52508,0.52473,0.51814,0.52177,0.521,0.52087,0.54264,0.52942,0.52412,0.52566,0.51473,0.51899,0.51324,0.51277],"avgavgrating":[4.20788,4.21442,4.21293,4.21461,4.21217,4.21186,4.20665,4.20176,4.206,4.20322,4.20023,4.20468,4.19894,4.19337,4.19348,4.19304,4.19884,4.19442,4.19231,4.19489,4.19368,4.18747,4.24046,4.22761,4.22664,4.21913,4.21058,4.20787,4.20521,4.21306]}
    
    data_2 = {"lengthDate":30,"date":["2024-10-23T00:00:00","2024-10-24T00:00:00","2024-10-25T00:00:00","2024-10-26T00:00:00","2024-10-27T00:00:00","2024-10-28T00:00:00","2024-10-29T00:00:00","2024-10-30T00:00:00","2024-10-31T00:00:00","2024-11-01T00:00:00","2024-11-02T00:00:00","2024-11-03T00:00:00","2024-11-04T00:00:00","2024-11-05T00:00:00","2024-11-06T00:00:00","2024-11-07T00:00:00","2024-11-08T00:00:00","2024-11-09T00:00:00","2024-11-10T00:00:00","2024-11-11T00:00:00","2024-11-12T00:00:00","2024-11-13T00:00:00","2024-11-14T00:00:00","2024-11-15T00:00:00","2024-11-16T00:00:00","2024-11-17T00:00:00","2024-11-18T00:00:00","2024-11-19T00:00:00","2024-11-20T00:00:00","2024-11-21T00:00:00"],"count":[245665,183001,245707,240939,235649,239324,237179,234814,175205,232669,232764,231262,233607,231940,229800,171917,233460,229109,222615,225100,222245,217492,205461,281199,263893,256493,259515,253672,250029,140058],"avggoaltot":[1.48611,1.47831,1.47022,1.47544,1.48038,1.485,1.48187,1.48591,1.48458,1.49118,1.49408,1.49527,1.49813,1.50116,1.50257,1.49744,1.50215,1.50129,1.50401,1.50619,1.50461,1.50283,1.49446,1.45404,1.45844,1.45585,1.45956,1.46051,1.46525,1.4706],"avgshoottot":[4.71609,4.67869,4.69125,4.71836,4.72799,4.74717,4.75605,4.7658,4.73791,4.7773,4.79077,4.79639,4.80674,4.82222,4.83224,4.78941,4.82995,4.8424,4.83651,4.84718,4.85137,4.84619,4.61569,4.55334,4.59442,4.6072,4.6379,4.65278,4.67793,4.63409],"avgeffshoottot":[3.87873,3.847,3.85596,3.87905,3.88805,3.90113,3.90874,3.91901,3.8942,3.92594,3.93591,3.9411,3.95056,3.9652,3.97268,3.93921,3.9698,3.97925,3.97647,3.98492,3.98961,3.98229,3.8051,3.74862,3.7812,3.79179,3.81617,3.82669,3.84822,3.81693],"avggoalpenaltykick":[0.02581,0.02563,0.02604,0.02616,0.02608,0.02598,0.0256,0.02648,0.02631,0.02684,0.02607,0.02615,0.02629,0.02629,0.02635,0.02601,0.02697,0.02603,0.02676,0.02629,0.02708,0.02662,0.02563,0.0251,0.02516,0.02513,0.02544,0.02541,0.02575,0.02558],"avggoalfreekick":[0.00316,0.0032,0.00304,0.00289,0.00317,0.00303,0.00309,0.00332,0.00309,0.00322,0.0032,0.00305,0.00315,0.00307,0.00309,0.00309,0.0031,0.0031,0.00316,0.00324,0.00319,0.00306,0.00317,0.00304,0.00299,0.00316,0.00285,0.00313,0.00312,0.00315],"avgshootinpenalty":[3.01816,3.00096,3.00235,3.01906,3.02678,3.03313,3.04008,3.04414,3.03337,3.05779,3.06069,3.06499,3.06935,3.08119,3.07941,3.05893,3.07748,3.08555,3.08195,3.08612,3.09236,3.09138,2.95676,2.90482,2.93266,2.93661,2.95373,2.96123,2.97905,2.95642],"avggoalinpenalty":[1.13004,1.1259,1.11999,1.12276,1.12685,1.1286,1.12676,1.12818,1.12975,1.13341,1.1345,1.13678,1.13844,1.14043,1.13998,1.13733,1.13914,1.14069,1.1404,1.14189,1.14051,1.14136,1.13548,1.103,1.10714,1.10496,1.10722,1.10755,1.11049,1.11608],"avgshootoutpenalty":[1.6625,1.64276,1.65348,1.66334,1.66554,1.67837,1.68061,1.68549,1.66864,1.68289,1.69436,1.69549,1.70132,1.70494,1.71685,1.69483,1.71572,1.72081,1.71808,1.72513,1.7221,1.71839,1.62398,1.61403,1.6273,1.63633,1.64949,1.65656,1.66344,1.64296],"avggoaloutpenalty":[0.33026,0.32678,0.32419,0.32652,0.32744,0.33042,0.32951,0.33125,0.32852,0.33093,0.3335,0.33234,0.3334,0.33444,0.33625,0.33409,0.33603,0.33457,0.33685,0.33802,0.33702,0.33485,0.33335,0.32594,0.32614,0.32577,0.3269,0.32754,0.32902,0.32893],"middleshoot":[19.8652,19.892,19.6068,19.6301,19.66,19.6868,19.6065,19.6529,19.6877,19.6645,19.6831,19.6014,19.5965,19.616,19.585,19.7126,19.5853,19.4428,19.6061,19.5936,19.5703,19.486,20.5266,20.1942,20.0417,19.9083,19.818,19.7722,19.7796,20.0209],"outpenaltygoalratio":[22.223,22.1047,22.0507,22.1301,22.119,22.2504,22.2361,22.2925,22.1287,22.1927,22.3216,22.226,22.2543,22.2787,22.3781,22.311,22.3699,22.2857,22.3967,22.4417,22.399,22.2811,22.3055,22.4163,22.3622,22.3763,22.3969,22.4264,22.455,22.3674],"avggoalheading":[0.18489,0.18345,0.18471,0.18363,0.18466,0.1862,0.18528,0.18538,0.18465,0.18576,0.18627,0.18689,0.18635,0.18725,0.18811,0.18768,0.18724,0.18787,0.18773,0.18713,0.18613,0.18552,0.18442,0.18057,0.18096,0.17947,0.18122,0.18073,0.18242,0.18096],"goalheadingratio":[12.4409,12.4092,12.5636,12.4456,12.4736,12.5388,12.5031,12.4758,12.438,12.4575,12.467,12.4985,12.4387,12.4735,12.5191,12.5331,12.4649,12.5137,12.4818,12.4241,12.3706,12.3449,12.3403,12.4186,12.408,12.3273,12.4162,12.3748,12.4498,12.3054],"avgpasstry":[102.839,102.974,103.875,104.629,104.828,105.152,105.43,105.658,105.107,105.898,106.358,106.545,106.763,107.02,107.06,106.528,107.182,107.543,107.396,107.642,107.736,107.767,101.027,99.2871,100.174,100.939,101.708,102.267,102.804,101.897],"avgpasssuccess":[89.0489,89.0811,89.7461,90.4115,90.6059,90.8653,91.0945,91.3057,90.8473,91.4877,91.8824,92.0469,92.2417,92.467,92.4767,92.0782,92.5937,92.9242,92.7945,93.0113,93.1035,93.1302,87.3263,85.7417,86.4995,87.1445,87.8173,88.2805,88.735,87.9682],"passsuccessratio":[86.5909,86.5085,86.3982,86.4115,86.4328,86.413,86.4028,86.4159,86.433,86.3924,86.3896,86.3927,86.3988,86.4014,86.3783,86.4358,86.3893,86.4065,86.4044,86.4084,86.4185,86.4183,86.4388,86.3574,86.3496,86.3338,86.3423,86.3234,86.3151,86.3309],"avgowngoal":[0.00661,0.00662,0.00681,0.00695,0.00676,0.00701,0.00685,0.00686,0.00674,0.00688,0.0069,0.00676,0.00703,0.00698,0.00713,0.00672,0.00708,0.00709,0.00707,0.00709,0.00703,0.00716,0.00653,0.00625,0.0066,0.00652,0.00657,0.00655,0.00665,0.00677],"avgpossession":[49.845,49.838,49.855,49.8483,49.8632,49.8567,49.8799,49.8823,49.8773,49.8839,49.8875,49.8981,49.9044,49.8974,49.8996,49.894,49.907,49.9269,49.9231,49.9227,49.9367,49.9216,49.698,49.7494,49.7891,49.817,49.8425,49.8415,49.8497,49.8207],"avgdribble":[79.6203,79.4497,80.138,80.7408,80.929,81.1839,81.4515,81.6588,81.1376,81.8376,82.2322,82.3951,82.5938,82.7919,82.8404,82.334,82.9672,83.2552,83.1726,83.3457,83.4202,83.4443,77.6667,76.5178,77.3018,77.9448,78.5716,79.0554,79.5203,78.6314],"avgtacklesuccess":[5.38092,5.34303,5.3582,5.38572,5.38974,5.39612,5.42387,5.43098,5.40347,5.43251,5.4666,5.46298,5.48035,5.47599,5.49989,5.4481,5.49494,5.50437,5.50217,5.50628,5.51185,5.51178,5.23276,5.17539,5.22027,5.24357,5.26432,5.29683,5.31899,5.28661],"avgtackletry":[7.95894,7.9025,7.92749,7.96326,7.9753,7.98369,8.02534,8.02957,7.99295,8.03554,8.0767,8.08228,8.10179,8.10444,8.13294,8.05884,8.12485,8.13732,8.13711,8.13762,8.14886,8.1508,7.74087,7.65787,7.71925,7.75563,7.79509,7.83324,7.86733,7.81775],"avgblocksuccess":[0.42752,0.42405,0.42505,0.42686,0.43149,0.43078,0.43228,0.43151,0.4296,0.43135,0.43321,0.4371,0.43667,0.43894,0.43844,0.43426,0.4407,0.43939,0.4392,0.44039,0.44123,0.44037,0.41226,0.40859,0.41295,0.41581,0.42038,0.4214,0.42431,0.4184],"avgblocktry":[6.9076,6.86477,6.92153,6.95089,6.96652,6.98836,7.00953,7.01599,6.98089,7.03008,7.07209,7.07873,7.09447,7.1038,7.10326,7.04524,7.11699,7.1405,7.12278,7.1368,7.13622,7.14517,6.67349,6.63026,6.688,6.73524,6.77865,6.82035,6.85122,6.7659],"avgfoul":[0.76486,0.76012,0.7674,0.76721,0.7678,0.77097,0.77557,0.7774,0.76991,0.77953,0.78245,0.78378,0.78334,0.78536,0.78786,0.77862,0.7872,0.78995,0.79042,0.79047,0.79124,0.79238,0.74332,0.73929,0.74516,0.74958,0.75493,0.75981,0.76379,0.75612],"avgshootfreekick":[0.08597,0.08423,0.0845,0.08399,0.08458,0.08524,0.08602,0.08606,0.08486,0.08569,0.0859,0.08547,0.08573,0.08718,0.08677,0.08536,0.08663,0.08757,0.08679,0.08798,0.0871,0.08697,0.08217,0.08089,0.08192,0.08233,0.08388,0.0831,0.08352,0.08333],"avgshootpenaltykick":[0.03312,0.03289,0.03332,0.03354,0.03348,0.03338,0.03319,0.03396,0.03379,0.03447,0.03347,0.03364,0.03381,0.03377,0.0338,0.03354,0.03451,0.03372,0.03435,0.03372,0.03473,0.0342,0.03281,0.03229,0.03238,0.03213,0.03262,0.03273,0.03331,0.03256],"avgshootheading":[0.92389,0.91959,0.93057,0.93425,0.93402,0.94085,0.94243,0.94444,0.93816,0.9485,0.94815,0.94952,0.95075,0.9563,0.95801,0.94649,0.95389,0.95673,0.95471,0.95783,0.95683,0.95714,0.90189,0.89535,0.9023,0.90399,0.91262,0.91614,0.92007,0.9078],"avgshortpasstry":[60.1135,60.2859,60.7598,61.2268,61.3727,61.5196,61.6771,61.7982,61.5182,61.8858,62.1481,62.2642,62.4079,62.5734,62.5231,62.3755,62.651,62.9113,62.8022,62.9633,63.0305,63.0608,59.1086,57.9282,58.4227,58.8609,59.3316,59.6444,59.9102,59.4497],"avgshortpasssuccess":[58.3753,58.5216,58.9616,59.4218,59.5681,59.7108,59.863,59.9806,59.7096,60.0606,60.3194,60.4305,60.5678,60.7363,60.6808,60.5488,60.8064,61.0658,60.9605,61.1186,61.185,61.2144,57.367,56.2116,56.6988,57.1225,57.587,57.8867,58.1457,57.6981],"avglobpasstry":[6.76092,6.68624,6.72377,6.76443,6.76552,6.80478,6.80216,6.80238,6.75686,6.83151,6.85998,6.85993,6.86759,6.89455,6.90244,6.84003,6.90702,6.92297,6.90556,6.91599,6.91872,6.91023,6.44447,6.36608,6.4414,6.48469,6.53834,6.5713,6.61195,6.52391],"avglobpasssuccess":[2.21585,2.19428,2.20757,2.22111,2.22452,2.23255,2.2266,2.22946,2.2102,2.23627,2.24003,2.23858,2.24148,2.24973,2.25167,2.23191,2.25263,2.25732,2.25137,2.25253,2.2566,2.24981,2.12417,2.09292,2.11262,2.11656,2.1317,2.14119,2.15136,2.12484],"avgdrivengroundpasstry":[4.34743,4.35361,4.42363,4.45074,4.47502,4.49216,4.51042,4.54034,4.49952,4.55188,4.57976,4.59319,4.60248,4.6166,4.62778,4.59311,4.6398,4.65815,4.65554,4.67462,4.68734,4.69046,4.3427,4.28835,4.34503,4.38773,4.43114,4.46642,4.50258,4.43721],"avgdrivengroundpasssuccess":[4.20368,4.20748,4.2751,4.30164,4.32477,4.3427,4.35882,4.38795,4.34863,4.39933,4.42624,4.44032,4.44918,4.46331,4.47416,4.44074,4.48661,4.50466,4.50245,4.5195,4.53125,4.53458,4.19743,4.14602,4.201,4.24195,4.28405,4.31885,4.353,4.28986],"avgthroughpasstry":[22.0984,22.138,22.3073,22.4649,22.4681,22.5544,22.6286,22.673,22.586,22.7473,22.8467,22.8699,22.912,22.9146,22.9695,22.8011,22.9958,23.0467,23.0313,23.0755,23.0805,23.08,21.837,21.4583,21.6183,21.7875,21.901,22.0219,22.1458,22.0213],"avgthroughpasssuccess":[18.6362,18.6381,18.755,18.8865,18.8955,18.9651,19.0231,19.0665,18.9962,19.1283,19.2102,19.2278,19.2735,19.2698,19.3191,19.1847,19.3432,19.3836,19.3718,19.4118,19.4192,19.4119,18.3523,18.0215,18.161,18.3036,18.4049,18.5024,18.6133,18.4956],"avglobbedthroughpasstry":[8.67342,8.66961,8.81505,8.87189,8.89772,8.92976,8.95675,8.99023,8.89874,9.02344,9.06388,9.09681,9.11197,9.15782,9.17335,9.06238,9.12558,9.13856,9.13576,9.14688,9.14944,9.16188,8.4712,8.43163,8.52771,8.59187,8.67582,8.7276,8.79458,8.63579],"avglobbedthroughpasssuccess":[5.4435,5.3464,5.37196,5.40558,5.41838,5.4396,5.44722,5.46609,5.40695,5.48685,5.51062,5.53296,5.53293,5.5702,5.57268,5.4964,5.52806,5.53559,5.53042,5.53081,5.53292,5.54057,5.1144,5.1018,5.15741,5.18992,5.23959,5.26049,5.29935,5.18797],"avgcornerkick":[1.91142,1.8915,1.90762,1.91951,1.915,1.93216,1.93514,1.94056,1.92584,1.94595,1.95317,1.95202,1.9575,1.96293,1.96636,1.94786,1.96931,1.97489,1.96961,1.97342,1.98021,1.97296,1.84464,1.82681,1.85113,1.86503,1.88227,1.88803,1.90196,1.8676],"avgycards":[0.07334,0.07346,0.07466,0.07485,0.07429,0.07492,0.07553,0.07545,0.07451,0.0756,0.0757,0.07597,0.07621,0.07689,0.07636,0.07656,0.0764,0.07607,0.07748,0.07682,0.07702,0.07719,0.07302,0.07234,0.07337,0.07355,0.07411,0.07456,0.07477,0.0741],"avgrcards":[0.00313,0.00292,0.00295,0.00299,0.00274,0.00303,0.00298,0.00296,0.00306,0.00301,0.00306,0.00304,0.00303,0.00314,0.00314,0.00312,0.00311,0.00324,0.00302,0.00304,0.00301,0.00298,0.00283,0.00277,0.00289,0.00299,0.00295,0.00312,0.00308,0.00288],"avginjury":[0.13615,0.13863,0.14142,0.14316,0.14358,0.14398,0.14534,0.14461,0.1445,0.14444,0.14641,0.14615,0.1454,0.14593,0.14719,0.14493,0.14682,0.14656,0.1459,0.14674,0.14746,0.14682,0.13812,0.13558,0.13594,0.1382,0.13994,0.14104,0.14078,0.14085],"avgoffsidecnt":[1.57949,1.57749,1.59509,1.61074,1.61475,1.61787,1.63036,1.63884,1.62314,1.64261,1.64769,1.65299,1.66343,1.66603,1.66901,1.65464,1.67181,1.67859,1.67332,1.68,1.68052,1.68825,1.55795,1.55043,1.5753,1.59104,1.60525,1.6183,1.62892,1.59728],"avgavgrating":[4.01774,4.02134,4.01908,4.01948,4.02027,4.01902,4.01882,4.01833,4.01964,4.01798,4.01823,4.01829,4.01724,4.01708,4.01712,4.0179,4.01661,4.01654,4.01619,4.01561,4.01602,4.01514,4.03403,4.02572,4.0237,4.02162,4.02004,4.01922,4.01877,4.02412]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
