import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    # match_type = "50" -> 공경
    data_1 = {"lengthDate":30,"date":["2025-05-19T00:00:00","2025-05-20T00:00:00","2025-05-21T00:00:00","2025-05-22T00:00:00","2025-05-23T00:00:00","2025-05-24T00:00:00","2025-05-25T00:00:00","2025-05-26T00:00:00","2025-05-27T00:00:00","2025-05-28T00:00:00","2025-05-29T00:00:00","2025-05-30T00:00:00","2025-05-31T00:00:00","2025-06-01T00:00:00","2025-06-02T00:00:00","2025-06-03T00:00:00","2025-06-04T00:00:00","2025-06-05T00:00:00","2025-06-06T00:00:00","2025-06-07T00:00:00","2025-06-08T00:00:00","2025-06-09T00:00:00","2025-06-10T00:00:00","2025-06-11T00:00:00","2025-06-12T00:00:00","2025-06-13T00:00:00","2025-06-14T00:00:00","2025-06-15T00:00:00","2025-06-16T00:00:00","2025-06-17T00:00:00"],"count":[0,0,0,0,0,0,0,0,0,18978,21219,26040,28713,30525,25314,32001,24833,22697,27887,26039,25709,19160,17845,18900,19555,22192,24409,24225,18475,17677],"avggoaltot":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.6226,2.7326,2.6979,2.7037,2.6931,2.6729,2.6625,2.6583,2.6577,2.6691,2.663,2.6425,2.6513,2.6527,2.6603,2.6528,2.6565,2.6869,2.6773,2.6468,2.6607],"avgshoottot":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,6.9414,7.1234,7.0821,7.0784,7.1064,7.0392,7.0304,6.9999,6.9947,7.0167,7.0143,6.9998,7.018,6.978,7.0033,6.994,7.0047,7.0429,7.0333,6.9689,6.9689],"avgeffshoottot":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.3241,5.4772,5.4419,5.4446,5.4627,5.4043,5.3949,5.3903,5.3728,5.4015,5.3869,5.3686,5.3885,5.3543,5.388,5.3836,5.3772,5.4144,5.4085,5.3541,5.3747],"avggoalpenaltykick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0618,0.0643,0.0634,0.0651,0.0638,0.0642,0.0621,0.0614,0.0636,0.0636,0.0623,0.0612,0.0629,0.0611,0.0616,0.0625,0.0614,0.0628,0.0631,0.0624,0.0636],"avggoalfreekick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0187,0.0191,0.0198,0.0188,0.0208,0.0207,0.0198,0.0196,0.0191,0.0211,0.0192,0.0196,0.0188,0.0198,0.02,0.0203,0.0202,0.0194,0.0182,0.0193,0.0209],"avgshootinpenalty":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.5995,4.7637,4.7235,4.7267,4.7224,4.6734,4.6497,4.6361,4.6503,4.6718,4.6594,4.6393,4.6553,4.6278,4.6304,4.6607,4.6479,4.6956,4.6808,4.642,4.6627],"avggoalinpenalty":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0597,2.1514,2.1265,2.1316,2.1124,2.0977,2.0798,2.0872,2.0892,2.1012,2.0916,2.08,2.0811,2.0794,2.0848,2.0903,2.0886,2.1211,2.1103,2.0884,2.1022],"avgshootoutpenalty":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.2572,2.2705,2.2707,2.2614,2.2954,2.2778,2.2951,2.2773,2.2567,2.2557,2.2674,2.2751,2.2741,2.2645,2.2873,2.2464,2.2702,2.2598,2.2631,2.2381,2.2183],"avggoaloutpenalty":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5011,0.5169,0.508,0.507,0.517,0.5111,0.5206,0.5097,0.505,0.5042,0.5091,0.5013,0.5072,0.5122,0.5139,0.5,0.5065,0.503,0.5039,0.496,0.4949],"middleshoot":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,22.2001,22.7644,22.372,22.4184,22.5221,22.4359,22.6835,22.3833,22.3754,22.3547,22.4527,22.034,22.3051,22.619,22.4678,22.2566,22.3117,22.2575,22.2663,22.1599,22.3092],"outpenaltygoalratio":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.107,18.9161,18.8295,18.7521,19.1972,19.1216,19.5531,19.1739,19.0014,18.8903,19.1175,18.9707,19.1302,19.3086,19.3174,18.848,19.0664,18.7205,18.8212,18.7396,18.6004],"avggoalheading":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.3047,0.3227,0.3062,0.3176,0.3179,0.3093,0.3042,0.3135,0.3087,0.312,0.3073,0.3152,0.3193,0.3104,0.31,0.309,0.314,0.3155,0.3208,0.3076,0.3141],"goalheadingratio":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,11.6195,11.8105,11.3508,11.7471,11.8036,11.5736,11.4254,11.793,11.6147,11.6908,11.5407,11.9287,12.0438,11.701,11.6512,11.6473,11.8205,11.7413,11.9837,11.6223,11.806],"avgpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,105.192,104.712,104.397,104.898,105.014,105.21,105.568,105.281,104.41,105.151,105.526,105.312,105.677,105.29,105.82,104.502,104.954,105.319,105.832,105.938,105.509],"avgpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,95.4216,95.0009,94.7061,95.1517,95.1733,95.3906,95.7814,95.5715,94.6944,95.3281,95.6555,95.4842,95.8644,95.5123,96.0411,94.7262,95.0914,95.4489,95.9464,96.11,95.6868],"passsuccessratio":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,90.7116,90.7257,90.7172,90.7084,90.6288,90.6669,90.7292,90.7779,90.6945,90.6584,90.6467,90.668,90.7147,90.7135,90.7594,90.645,90.6025,90.6283,90.6594,90.7225,90.6907],"avgowngoal":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0167,0.0166,0.0166,0.0178,0.0174,0.0176,0.0168,0.0175,0.0187,0.0167,0.018,0.0168,0.0181,0.018,0.0158,0.0194,0.019,0.0174,0.0183,0.0167,0.0183],"avgpossession":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,50.4613,50.8315,50.7699,50.6964,50.645,50.6142,50.6095,50.5672,50.6287,50.5343,50.5522,50.475,50.5166,50.4466,50.409,50.5497,50.5645,50.5484,50.5114,50.4753,50.4403],"avgdribble":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,72.8222,72.6145,72.3123,72.6418,72.5713,72.6457,72.8248,72.7618,72.1883,72.6088,72.7204,72.6433,72.8379,72.6835,73.1331,72.1356,72.2628,72.6331,72.8969,73.0098,72.8007],"avgtacklesuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,6.0863,6.1774,6.165,6.135,6.1187,6.0945,6.0724,6.0745,6.1397,6.1551,6.1264,6.0505,6.1262,6.0997,6.1989,6.1748,6.2011,6.1646,6.0971,6.1242,6.117],"avgtackletry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,11.4597,11.5622,11.5285,11.4939,11.5102,11.4811,11.4301,11.4572,11.562,11.6178,11.5715,11.4184,11.5441,11.4753,11.6727,11.6096,11.625,11.5859,11.5021,11.5258,11.5743],"avgblocksuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.6262,0.6131,0.6046,0.6103,0.6195,0.615,0.6164,0.624,0.6207,0.614,0.6289,0.6312,0.6231,0.6266,0.6287,0.6172,0.6253,0.6135,0.6255,0.6227,0.6178],"avgblocktry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,8.3237,8.2009,8.1674,8.2337,8.3255,8.2746,8.2986,8.2395,8.2681,8.2783,8.3102,8.3501,8.3016,8.3011,8.3415,8.2966,8.2744,8.337,8.3626,8.3294,8.2747],"avgfoul":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.7006,0.7154,0.7017,0.7072,0.7162,0.711,0.7075,0.7104,0.7152,0.7085,0.7091,0.7013,0.7137,0.7022,0.7159,0.7266,0.717,0.7144,0.7173,0.712,0.716],"avgshootfreekick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.2015,0.2015,0.2036,0.1958,0.1959,0.2056,0.2014,0.1992,0.2042,0.2004,0.2011,0.2027,0.2035,0.2025,0.2033,0.2076,0.2085,0.2076,0.2017,0.2018,0.2058],"avgshootpenaltykick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0783,0.0814,0.0812,0.0827,0.0815,0.0817,0.0793,0.08,0.081,0.0819,0.0804,0.0782,0.0819,0.0782,0.0784,0.0798,0.0797,0.0803,0.0824,0.0812,0.0813],"avgshootheading":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.9757,1.0174,0.9839,1.0089,1.0184,0.9936,0.9852,0.9997,0.9786,0.9968,0.9819,1.0137,1.0143,0.9992,0.9869,0.9903,0.9835,1.0012,1.0134,0.9899,0.997],"avgshortpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,75.9432,75.2304,75.1945,75.6699,75.7022,75.9351,76.3988,76.1873,75.2587,75.8793,76.1088,75.8894,76.3951,76.0558,76.5201,75.1574,75.4017,75.8058,76.2443,76.3913,76.0099],"avgshortpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,72.3469,71.6738,71.6302,72.0698,72.0776,72.3386,72.7863,72.5968,71.6975,72.2548,72.4902,72.3083,72.8107,72.4592,72.898,71.5744,71.7714,72.1615,72.615,72.7829,72.4049],"avglobpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.8776,4.9365,4.8394,4.8776,4.8845,4.8973,4.8936,4.8965,4.8463,4.8546,4.8484,4.9719,4.9288,4.9098,4.8707,4.8848,4.8681,4.8687,4.9108,4.8428,4.8928],"avglobpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.8036,2.8635,2.781,2.8055,2.7888,2.7978,2.8098,2.8072,2.7852,2.7787,2.768,2.8406,2.813,2.8098,2.8128,2.816,2.8005,2.7891,2.8071,2.7848,2.8149],"avgdrivengroundpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.2414,4.3523,4.1831,4.118,4.0496,4.2097,4.1447,4.1473,4.293,4.1405,4.1572,4.2335,4.2647,4.2856,4.2791,4.3452,4.2216,4.2637,4.3,4.3362,4.3362],"avgdrivengroundpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.7077,3.8093,3.643,3.5835,3.5201,3.673,3.6092,3.6241,3.7505,3.605,3.6224,3.6969,3.7215,3.732,3.7395,3.7969,3.6723,3.7182,3.7505,3.7836,3.779],"avgthroughpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,18.8656,18.9412,18.9449,18.9929,19.1318,18.9128,18.8887,18.8165,18.7602,19.0099,19.1554,18.952,18.8228,18.799,18.8983,18.8648,19.1999,19.1096,19.1097,19.0864,18.9979],"avgthroughpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,16.2828,16.3779,16.3801,16.4232,16.5165,16.3073,16.3121,16.2788,16.1968,16.4157,16.5111,16.3587,16.2427,16.2485,16.3264,16.2747,16.5783,16.5051,16.4954,16.4754,16.4104],"avglobbedthroughpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.2377,0.2298,0.2274,0.2308,0.2301,0.2327,0.2252,0.2198,0.2245,0.2359,0.2329,0.2423,0.2391,0.2243,0.2207,0.2276,0.2346,0.2368,0.237,0.2423,0.2368],"avglobbedthroughpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.1549,0.1471,0.1471,0.1495,0.15,0.1515,0.1451,0.1431,0.1429,0.1526,0.1509,0.158,0.1559,0.1452,0.1433,0.1452,0.1513,0.1519,0.1552,0.1578,0.1538],"avgcornerkick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.7581,1.7816,1.7778,1.7749,1.7884,1.7795,1.7826,1.7722,1.7637,1.7782,1.7672,1.7844,1.7888,1.7829,1.7746,1.7746,1.7751,1.7852,1.7935,1.7629,1.779],"avgycards":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0419,0.0427,0.0458,0.0454,0.0456,0.0439,0.0432,0.0429,0.0423,0.0414,0.046,0.0425,0.0417,0.0426,0.0411,0.0465,0.0429,0.0437,0.0464,0.0454,0.0433],"avgrcards":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0066,0.0068,0.0068,0.0072,0.0073,0.0068,0.0071,0.0074,0.0074,0.0076,0.0074,0.0081,0.0068,0.006,0.0072,0.0069,0.0079,0.0066,0.0076,0.0071,0.0071],"avginjury":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.1168,0.1186,0.1156,0.1142,0.1157,0.1189,0.1165,0.1149,0.1137,0.1159,0.1207,0.1152,0.1202,0.1151,0.1163,0.1151,0.1207,0.117,0.1158,0.1138,0.1177],"avgoffsidecnt":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.4995,0.5033,0.4992,0.5021,0.4974,0.4963,0.4976,0.4991,0.487,0.497,0.5027,0.495,0.4932,0.4983,0.4923,0.5,0.5035,0.5088,0.5021,0.5026,0.5006],"avgavgrating":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.17646,4.20665,4.196,4.19614,4.19346,4.18933,4.19064,4.18443,4.18278,4.1872,4.18614,4.1839,4.18156,4.18165,4.18179,4.17658,4.1835,4.18914,4.1883,4.18592,4.18051]}

    # match_type = "52" ->  감모
    data_2 = {"lengthDate":30,"date":["2025-05-19T00:00:00","2025-05-20T00:00:00","2025-05-21T00:00:00","2025-05-22T00:00:00","2025-05-23T00:00:00","2025-05-24T00:00:00","2025-05-25T00:00:00","2025-05-26T00:00:00","2025-05-27T00:00:00","2025-05-28T00:00:00","2025-05-29T00:00:00","2025-05-30T00:00:00","2025-05-31T00:00:00","2025-06-01T00:00:00","2025-06-02T00:00:00","2025-06-03T00:00:00","2025-06-04T00:00:00","2025-06-05T00:00:00","2025-06-06T00:00:00","2025-06-07T00:00:00","2025-06-08T00:00:00","2025-06-09T00:00:00","2025-06-10T00:00:00","2025-06-11T00:00:00","2025-06-12T00:00:00","2025-06-13T00:00:00","2025-06-14T00:00:00","2025-06-15T00:00:00","2025-06-16T00:00:00","2025-06-17T00:00:00"],"count":[0,0,0,0,0,0,0,0,0,268977,155415,268402,266669,251074,264341,265647,269258,168417,264762,263315,259520,268354,263779,265668,175973,267945,265632,258418,267235,266944],"avggoaltot":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.429,1.4178,1.4318,1.4298,1.4317,1.4312,1.4269,1.4291,1.4155,1.4259,1.4305,1.426,1.428,1.4245,1.4298,1.4146,1.4257,1.4276,1.4267,1.4291,1.4236],"avgshoottot":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.7486,4.6859,4.7488,4.7532,4.7447,4.7559,4.749,4.7522,4.6983,4.7438,4.7521,4.7459,4.7533,4.7429,4.758,4.6954,4.7482,4.751,4.7475,4.7517,4.7444],"avgeffshoottot":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.7054,3.6626,3.708,3.7102,3.7068,3.7123,3.7055,3.7087,3.6686,3.7031,3.7121,3.705,3.7083,3.7024,3.7144,3.6685,3.7054,3.7091,3.706,3.7085,3.7026],"avggoalpenaltykick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0268,0.026,0.0264,0.0264,0.0266,0.0264,0.0258,0.0265,0.0261,0.0265,0.0268,0.0266,0.0265,0.0267,0.0268,0.0263,0.0269,0.0265,0.0266,0.0266,0.0265],"avggoalfreekick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0035,0.0032,0.0034,0.0034,0.0033,0.0033,0.0035,0.0034,0.0035,0.0033,0.0035,0.0034,0.0035,0.0034,0.0033,0.0034,0.0035,0.0034,0.0034,0.0034,0.0035],"avgshootinpenalty":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.9456,2.9136,2.9456,2.9486,2.9432,2.9452,2.9441,2.9472,2.9144,2.9379,2.9479,2.9443,2.945,2.939,2.9489,2.9138,2.9422,2.9428,2.9387,2.9423,2.9389],"avggoalinpenalty":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0775,1.0705,1.0802,1.0774,1.0795,1.0784,1.0754,1.0777,1.0672,1.0734,1.079,1.0749,1.0762,1.0738,1.0776,1.0672,1.0736,1.0763,1.074,1.0759,1.0722],"avgshootoutpenalty":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.7663,1.7371,1.7666,1.7686,1.7653,1.7746,1.7694,1.7686,1.7483,1.7698,1.7675,1.7652,1.7719,1.7672,1.7726,1.7458,1.7692,1.7718,1.7726,1.7731,1.7694],"avggoaloutpenalty":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.3247,0.3213,0.3252,0.326,0.3256,0.3265,0.3257,0.325,0.3221,0.326,0.3247,0.3245,0.3254,0.324,0.3254,0.3211,0.3253,0.3248,0.326,0.3266,0.325],"middleshoot":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,18.3836,18.4957,18.4069,18.4323,18.4441,18.3973,18.4052,18.3738,18.4257,18.4184,18.3695,18.3843,18.362,18.3345,18.3589,18.3901,18.3873,18.3302,18.3927,18.421,18.3669],"outpenaltygoalratio":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,22.7222,22.6619,22.7127,22.8004,22.7422,22.813,22.8257,22.7416,22.7552,22.8628,22.6984,22.756,22.7871,22.7448,22.7584,22.699,22.8169,22.7515,22.8499,22.8535,22.8294],"avggoalheading":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.1738,0.1729,0.1742,0.1735,0.1741,0.1745,0.1738,0.1737,0.172,0.1737,0.1745,0.1736,0.1736,0.1739,0.1748,0.1725,0.1748,0.1738,0.1744,0.1749,0.1734],"goalheadingratio":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,12.162,12.192,12.1667,12.1346,12.1596,12.1954,12.1831,12.1577,12.1524,12.1834,12.2004,12.1733,12.159,12.2064,12.2244,12.196,12.2569,12.1759,12.2265,12.2384,12.1813],"avgpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,109.659,107.975,109.47,109.76,109.326,109.613,109.666,109.719,108.534,109.467,109.705,109.361,109.73,109.479,109.621,108.329,109.581,109.709,109.499,109.53,109.603],"avgpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,95.1188,93.6214,94.9401,95.2341,94.8448,95.073,95.1448,95.1816,94.1766,94.9674,95.1764,94.8431,95.1763,94.9556,95.0657,93.9339,95.0401,95.1665,94.9754,94.994,95.0932],"passsuccessratio":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,86.7405,86.7068,86.7273,86.7656,86.754,86.7352,86.7587,86.7502,86.7712,86.7546,86.7563,86.7246,86.7367,86.734,86.7223,86.7113,86.7306,86.7446,86.7366,86.7284,86.7619],"avgowngoal":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0072,0.0072,0.0073,0.0072,0.0071,0.0073,0.0074,0.0073,0.007,0.0074,0.0073,0.0071,0.0073,0.0074,0.0071,0.0073,0.0071,0.0073,0.0072,0.0073,0.0073],"avgpossession":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,49.9684,49.9471,49.9579,49.9628,49.9642,49.9696,49.9714,49.9735,49.9675,49.9722,49.9703,49.979,49.9809,49.9769,49.98,49.9802,49.9837,49.9859,49.9838,49.9816,49.9926],"avgdribble":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,85.4672,83.9707,85.3559,85.5825,85.2433,85.4752,85.5441,85.5439,84.497,85.383,85.5861,85.3041,85.5853,85.4076,85.5075,84.4056,85.4982,85.6181,85.443,85.4643,85.5338],"avgtacklesuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.6853,5.615,5.6786,5.6794,5.6707,5.6839,5.6851,5.6816,5.6136,5.674,5.6875,5.6799,5.6942,5.6832,5.6945,5.646,5.6958,5.692,5.6846,5.6876,5.6804],"avgtackletry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,8.3938,8.2852,8.3772,8.3828,8.3669,8.3831,8.3857,8.3881,8.2874,8.3704,8.3964,8.3851,8.4065,8.3889,8.4001,8.3253,8.3995,8.3981,8.3909,8.3918,8.3808],"avgblocksuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.4401,0.434,0.4402,0.4404,0.4382,0.4391,0.4403,0.4397,0.435,0.4401,0.4408,0.4395,0.4413,0.4399,0.4416,0.4352,0.4397,0.4419,0.4421,0.4418,0.4409],"avgblocktry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,7.184,7.079,7.1849,7.1804,7.1625,7.1888,7.1807,7.1816,7.0999,7.1725,7.1879,7.1715,7.202,7.1825,7.187,7.1045,7.1948,7.1895,7.187,7.195,7.1787],"avgfoul":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.8239,0.811,0.8238,0.8219,0.8212,0.8206,0.8225,0.8226,0.8146,0.8196,0.8221,0.8221,0.8226,0.8219,0.8246,0.8161,0.8243,0.8237,0.8248,0.8245,0.8205],"avgshootfreekick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0894,0.0884,0.0897,0.0897,0.0901,0.0895,0.0902,0.0906,0.089,0.0901,0.0899,0.09,0.0901,0.0896,0.0902,0.089,0.0903,0.0902,0.0903,0.0897,0.0894],"avgshootpenaltykick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0344,0.0333,0.0343,0.0339,0.0341,0.0338,0.0333,0.0343,0.0336,0.0339,0.0344,0.0342,0.0343,0.0345,0.0344,0.0337,0.0346,0.0343,0.0343,0.0342,0.034],"avgshootheading":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.8943,0.8827,0.895,0.8961,0.893,0.8962,0.897,0.8949,0.884,0.8963,0.8963,0.8967,0.8971,0.895,0.8976,0.8862,0.8977,0.896,0.8947,0.8972,0.8938],"avgshortpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,64.8868,63.8288,64.7529,65.0097,64.6948,64.8428,64.917,64.9656,64.2998,64.8001,64.9511,64.6671,64.9072,64.7707,64.8171,64.0559,64.816,64.9237,64.7859,64.7849,64.8891],"avgshortpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,63.016,61.9864,62.8859,63.1444,62.8334,62.9765,63.0539,63.0953,62.4586,62.9401,63.0895,62.8061,63.0399,62.9058,62.953,62.2129,62.9479,63.0585,62.924,62.9216,63.0267],"avglobpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,6.6843,6.5833,6.6749,6.6854,6.6508,6.6851,6.6803,6.6755,6.5929,6.6674,6.6798,6.68,6.6838,6.6737,6.6883,6.5955,6.6772,6.6777,6.666,6.6753,6.6587],"avglobpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.1429,2.1065,2.1359,2.1437,2.1306,2.1415,2.142,2.137,2.1103,2.1343,2.1393,2.1348,2.1385,2.1375,2.14,2.1071,2.1381,2.1391,2.1332,2.1344,2.1317],"avgdrivengroundpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.76,4.6883,4.7506,4.7682,4.7535,4.7654,4.7683,4.7646,4.7205,4.7654,4.775,4.7574,4.7688,4.7709,4.774,4.7155,4.7688,4.7785,4.7602,4.7714,4.7731],"avgdrivengroundpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.604,4.5336,4.5943,4.6133,4.5991,4.6101,4.6131,4.6098,4.5683,4.6099,4.6192,4.6022,4.6138,4.6161,4.6183,4.5619,4.6134,4.6239,4.6054,4.6165,4.6185],"avgthroughpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,23.6866,23.37,23.6603,23.6618,23.6134,23.6762,23.6694,23.6673,23.3801,23.6018,23.6532,23.6217,23.6997,23.6155,23.6676,23.414,23.6597,23.6685,23.6385,23.6447,23.6373],"avgthroughpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.9642,19.686,19.9401,19.9462,19.9048,19.9535,19.9505,19.9413,19.7045,19.8941,19.9326,19.9068,19.9752,19.8999,19.9412,19.7173,19.9381,19.9429,19.9168,19.9243,19.9207],"avglobbedthroughpasstry":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,8.7746,8.6492,8.7691,8.7718,8.7527,8.7805,8.7697,8.7836,8.686,8.7704,8.7835,8.7723,8.8054,8.7857,8.8077,8.6934,8.7948,8.7987,8.7847,8.7894,8.782],"avglobbedthroughpasssuccess":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.2203,5.1397,5.2136,5.2163,5.2053,5.2212,5.216,5.2273,5.1653,5.2187,5.224,5.2223,5.2377,5.2257,5.2431,5.167,5.2326,5.2326,5.2252,5.2274,5.2253],"avgcornerkick":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.8508,1.8283,1.8508,1.8569,1.8482,1.8567,1.8524,1.8561,1.8291,1.852,1.8556,1.8564,1.8558,1.8541,1.8615,1.8312,1.8564,1.8568,1.8529,1.8583,1.8535],"avgycards":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0853,0.0846,0.085,0.0856,0.0849,0.0848,0.0858,0.0855,0.0845,0.0852,0.0849,0.085,0.0854,0.085,0.0853,0.0844,0.0852,0.0859,0.0852,0.0856,0.0848],"avgrcards":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0035,0.0031,0.0033,0.0032,0.0034,0.0033,0.0033,0.0034,0.0033,0.0034,0.0034,0.0034,0.0033,0.0034,0.0034,0.0034,0.0034,0.0034,0.0034,0.0034,0.0034],"avginjury":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.149,0.1466,0.1486,0.1498,0.1486,0.1497,0.1492,0.1482,0.1466,0.1478,0.1488,0.1493,0.1492,0.1489,0.1492,0.1476,0.1488,0.1484,0.1483,0.1494,0.1487],"avgoffsidecnt":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.6574,1.6298,1.6563,1.6561,1.6536,1.6585,1.6575,1.6603,1.6376,1.6544,1.6629,1.6571,1.6629,1.6583,1.6665,1.6431,1.6597,1.6606,1.6605,1.658,1.6591],"avgavgrating":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.00047,4.0013,4.0,4.0003,4.00071,4.00051,4.00007,3.99987,4.00009,3.99964,3.99938,3.99968,3.99884,3.99861,3.99904,3.99796,3.99812,3.99838,3.99835,3.9973,3.99738]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
