import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    data_1 = {"lengthDate":30,"date":["2024-11-10T00:00:00","2024-11-11T00:00:00","2024-11-12T00:00:00","2024-11-13T00:00:00","2024-11-14T00:00:00","2024-11-15T00:00:00","2024-11-16T00:00:00","2024-11-17T00:00:00","2024-11-18T00:00:00","2024-11-19T00:00:00","2024-11-20T00:00:00","2024-11-21T00:00:00","2024-11-22T00:00:00","2024-11-23T00:00:00","2024-11-24T00:00:00","2024-11-25T00:00:00","2024-11-26T00:00:00","2024-11-27T00:00:00","2024-11-28T00:00:00","2024-11-29T00:00:00","2024-11-30T00:00:00","2024-12-01T00:00:00","2024-12-02T00:00:00","2024-12-03T00:00:00","2024-12-04T00:00:00","2024-12-05T00:00:00","2024-12-06T00:00:00","2024-12-07T00:00:00","2024-12-08T00:00:00","2024-12-09T00:00:00"],"count":[27844,21441,21793,22647,47883,43229,44652,41385,30541,29277,29794,25994,31180,33933,32670,24875,24162,24272,24568,25513,27660,28280,22553,21474,20880,18096,25209,27305,25654,20359],"avggoaltot":[2.572,2.58151,2.56899,2.56761,2.67178,2.67239,2.67102,2.63739,2.63832,2.63112,2.61983,2.61578,2.63304,2.62044,2.6125,2.61571,2.61465,2.60057,2.6006,2.61388,2.60176,2.59185,2.58945,2.56606,2.59334,2.59367,2.59762,2.58179,2.57567,2.59296],"avgshoottot":[7.00019,6.9645,6.91842,6.89713,7.29059,7.20716,7.19129,7.17814,7.13867,7.08322,7.0441,7.03629,7.04652,7.04415,7.05735,7.01828,6.98127,6.96877,6.97646,7.01278,6.95774,6.97793,6.96688,6.92488,6.96339,6.96829,6.95468,6.96494,6.92901,6.90403],"avgeffshoottot":[5.33776,5.3054,5.27922,5.27742,5.53189,5.49583,5.4804,5.45467,5.42892,5.39636,5.3719,5.3705,5.38744,5.38419,5.38819,5.3605,5.33694,5.32392,5.33238,5.36087,5.31647,5.32711,5.31677,5.27298,5.32193,5.28961,5.2822,5.29049,5.27497,5.25785],"avggoalpenaltykick":[0.06185,0.0607,0.0615,0.06206,0.06385,0.06443,0.06386,0.06171,0.06118,0.06156,0.06138,0.06175,0.06218,0.06294,0.06334,0.06294,0.06033,0.06326,0.06187,0.06289,0.06337,0.06327,0.06122,0.06035,0.06313,0.06328,0.06235,0.06287,0.06331,0.06384],"avggoalfreekick":[0.01793,0.01785,0.01791,0.01917,0.01895,0.0182,0.01829,0.01757,0.01868,0.01865,0.0186,0.01893,0.01779,0.01828,0.01762,0.01953,0.01919,0.01878,0.01741,0.01745,0.01869,0.01747,0.01827,0.01755,0.01805,0.01775,0.01928,0.01797,0.01754,0.01847],"avgshootinpenalty":[4.64486,4.61372,4.59098,4.58774,4.86444,4.82383,4.79982,4.75736,4.71535,4.71502,4.68142,4.69827,4.70633,4.6843,4.67981,4.6757,4.64674,4.61661,4.67553,4.68252,4.64275,4.63226,4.62838,4.6064,4.63891,4.65956,4.65811,4.64751,4.63882,4.63728],"avggoalinpenalty":[2.02455,2.03155,2.01815,2.01738,2.09595,2.10172,2.09951,2.06625,2.06444,2.06526,2.06057,2.06236,2.0742,2.06157,2.05305,2.0553,2.05892,2.04114,2.05891,2.06325,2.05586,2.03807,2.03654,2.02528,2.04448,2.04777,2.0544,2.03781,2.03811,2.0543],"avgshootoutpenalty":[2.26962,2.26469,2.2407,2.22245,2.3356,2.29284,2.30081,2.33332,2.3367,2.2806,2.27712,2.25207,2.25221,2.27109,2.28779,2.25564,2.24999,2.26287,2.21278,2.24079,2.22705,2.25682,2.25334,2.23416,2.23717,2.21954,2.20959,2.22886,2.20006,2.17767],"avggoaloutpenalty":[0.4856,0.48925,0.48934,0.48817,0.51199,0.50624,0.50764,0.50944,0.5127,0.5043,0.49788,0.49168,0.49666,0.49592,0.49612,0.49747,0.49541,0.49617,0.47982,0.48774,0.48253,0.49051,0.49169,0.48043,0.48574,0.48262,0.48088,0.48111,0.47425,0.47482],"middleshoot":[21.3959,21.6034,21.8389,21.9656,21.921,22.0793,22.0637,21.8331,21.9412,22.1125,21.8645,21.8323,22.0523,21.8364,21.6854,22.0546,22.0181,21.9267,21.6842,21.7666,21.6666,21.7344,21.8203,21.5037,21.7121,21.7441,21.7632,21.5853,21.5564,21.8041],"outpenaltygoalratio":[18.8804,18.9521,19.0481,19.0127,19.1627,18.9434,19.0056,19.3159,19.4328,19.1666,19.0043,18.7966,18.8628,18.9252,18.99,19.0186,18.9473,19.0793,18.4505,18.6597,18.5461,18.9249,18.9881,18.7223,18.7302,18.6075,18.5123,18.6346,18.4128,18.312],"avggoalheading":[0.27119,0.2687,0.26852,0.26662,0.26403,0.26196,0.26563,0.27083,0.27201,0.27302,0.27436,0.27161,0.2696,0.26565,0.26761,0.26402,0.26774,0.27138,0.26775,0.2669,0.26931,0.26607,0.27051,0.27544,0.26536,0.26937,0.27808,0.26833,0.26361,0.27838],"goalheadingratio":[10.5441,10.4086,10.4523,10.384,9.88219,9.80228,9.94483,10.2687,10.3099,10.3765,10.4725,10.3836,10.2392,10.1377,10.2435,10.0938,10.2401,10.4355,10.2958,10.211,10.3512,10.2657,10.4468,10.7338,10.2325,10.3855,10.7051,10.393,10.2347,10.736],"avgpasstry":[106.417,106.519,106.625,106.053,103.284,103.934,104.637,105.272,104.932,104.783,104.955,104.071,104.212,104.957,105.52,105.131,105.567,105.778,105.152,105.122,105.66,105.935,105.346,105.54,105.816,105.309,105.223,105.362,105.488,105.636],"avgpasssuccess":[96.3811,96.4537,96.6303,96.1404,92.9852,93.783,94.5221,95.1539,94.8535,94.8031,95.0124,94.1958,94.2868,94.9413,95.4884,95.1352,95.6026,95.8178,95.187,95.1728,95.6939,95.9294,95.3642,95.5643,95.7817,95.2277,95.1828,95.2551,95.3241,95.5105],"passsuccessratio":[90.5692,90.5503,90.6261,90.6529,90.0285,90.2336,90.333,90.3882,90.395,90.4759,90.5265,90.5107,90.4763,90.4576,90.4931,90.4917,90.5613,90.5839,90.5232,90.5357,90.568,90.5551,90.5248,90.5482,90.5171,90.4267,90.4578,90.4077,90.365,90.4149],"avgowngoal":[0.01736,0.0171,0.01867,0.01755,0.01816,0.0175,0.01662,0.01826,0.01645,0.01747,0.01758,0.01768,0.01827,0.01668,0.01797,0.01666,0.01549,0.01865,0.0176,0.01822,0.01722,0.01864,0.0187,0.01668,0.01935,0.0176,0.01744,0.01793,0.01749,0.01767],"avgpossession":[50.6161,50.5132,50.5006,50.4763,50.8564,50.86,50.8531,50.8019,50.6654,50.7314,50.7389,50.792,50.7133,50.6838,50.7059,50.6271,50.606,50.6281,50.7331,50.6924,50.6539,50.6215,50.5956,50.5872,50.525,50.6595,50.6566,50.6388,50.5155,50.4501],"avgdribble":[73.3049,73.2743,73.3579,73.1507,71.3862,71.7605,72.1312,72.4366,72.1268,72.2562,72.4121,71.9047,72.1581,72.4703,72.7713,72.6321,72.9572,72.8755,72.6065,72.554,72.9387,73.0932,72.7371,72.9177,72.9816,72.7129,72.8556,72.9801,73.0965,73.1725],"avgtacklesuccess":[5.97064,6.01424,5.96239,6.00235,6.23427,6.20542,6.13526,6.09226,6.06849,6.03218,6.0192,6.00642,6.13138,6.09314,6.0664,6.06706,6.02106,6.04638,6.07427,6.10612,6.09232,6.11064,6.07064,6.0,6.03734,6.09397,6.07074,6.1256,6.12276,6.08594],"avgtackletry":[11.1908,11.3285,11.2238,11.2641,11.5326,11.4836,11.4056,11.3382,11.3006,11.2564,11.2232,11.192,11.409,11.3616,11.3336,11.3282,11.2654,11.2764,11.2914,11.4283,11.4143,11.4288,11.408,11.2638,11.3309,11.4081,11.3556,11.4266,11.4667,11.4165],"avgblocksuccess":[0.62716,0.62158,0.62988,0.62449,0.61927,0.61808,0.6193,0.61763,0.62394,0.62064,0.61471,0.60367,0.61789,0.61906,0.6169,0.62284,0.62238,0.62677,0.61155,0.61609,0.62131,0.62023,0.61492,0.61797,0.61819,0.61061,0.61606,0.61783,0.60955,0.61983],"avgblocktry":[8.29895,8.31573,8.33996,8.30167,8.13081,8.11556,8.14482,8.19564,8.26051,8.19898,8.15002,8.0765,8.12435,8.19671,8.1998,8.22693,8.25301,8.21318,8.15259,8.2058,8.20443,8.25394,8.20725,8.21997,8.26713,8.18881,8.24595,8.24585,8.25696,8.26357],"avgfoul":[0.68142,0.69117,0.68033,0.69198,0.70674,0.70436,0.68757,0.6941,0.69216,0.68849,0.68689,0.6881,0.69497,0.69179,0.6996,0.69068,0.69596,0.69312,0.68735,0.70672,0.70447,0.70576,0.69029,0.69446,0.70058,0.70487,0.69611,0.70104,0.70601,0.71303],"avgshootfreekick":[0.17928,0.18415,0.18966,0.18766,0.1818,0.18163,0.18247,0.18627,0.19117,0.18408,0.18505,0.18545,0.18162,0.18154,0.17991,0.18477,0.18471,0.18373,0.17889,0.18638,0.18462,0.18455,0.18076,0.18004,0.18765,0.19146,0.18355,0.18279,0.18704,0.18813],"avgshootpenaltykick":[0.07848,0.07871,0.07944,0.07958,0.08301,0.08263,0.08275,0.08036,0.07938,0.0799,0.07868,0.07924,0.08098,0.08082,0.08255,0.08013,0.07779,0.0818,0.08089,0.08257,0.08129,0.08095,0.07891,0.07707,0.07956,0.08232,0.08002,0.08053,0.08217,0.08185],"avgshootheading":[0.92658,0.9075,0.91021,0.89679,0.92418,0.91492,0.91704,0.94007,0.93688,0.92817,0.9244,0.93213,0.91193,0.90901,0.91902,0.8989,0.90437,0.91025,0.91152,0.91294,0.90547,0.90897,0.91757,0.93674,0.90734,0.91721,0.93542,0.91856,0.89543,0.92637],"avgshortpasstry":[77.3399,77.3793,77.7829,77.3094,73.6339,74.5614,75.4082,76.1139,75.7863,75.7784,76.0304,75.1745,75.2808,75.9329,76.3312,76.0066,76.4387,76.7437,76.0748,76.0181,76.7478,76.6991,76.129,76.3739,76.7201,76.1319,76.2458,76.34,76.2765,76.4316],"avgshortpasssuccess":[73.6022,73.6369,74.016,73.5888,69.9097,70.8699,71.6895,72.3879,72.0762,72.1129,72.3575,71.5433,71.6155,72.2159,72.623,72.3154,72.7557,73.0421,72.3863,72.3311,73.0343,72.9702,72.4542,72.6838,72.9661,72.3857,72.4798,72.54,72.4677,72.6471],"avglobpasstry":[4.84822,4.76153,4.74705,4.68641,4.70063,4.66827,4.65695,4.74921,4.73467,4.72512,4.70123,4.75996,4.67701,4.75548,4.76115,4.75224,4.75042,4.72974,4.7677,4.72336,4.69679,4.7482,4.74344,4.8282,4.76468,4.88281,4.8217,4.81357,4.76654,4.82643],"avglobpasssuccess":[2.75955,2.71489,2.69844,2.67605,2.56842,2.57678,2.57958,2.64671,2.64387,2.65492,2.65011,2.70613,2.6461,2.69435,2.69937,2.69244,2.70023,2.69137,2.71684,2.69357,2.68281,2.70972,2.68715,2.76021,2.73035,2.78425,2.74844,2.73395,2.72017,2.75123],"avgdrivengroundpasstry":[3.79278,3.86433,3.86351,3.88607,3.41244,3.52399,3.57543,3.61155,3.75223,3.75139,3.79265,3.7082,3.72027,3.72376,3.82203,3.8635,3.81845,3.77838,3.79006,3.92388,3.84479,3.89997,3.91443,3.95232,3.89641,3.85198,3.77892,3.71049,3.74522,3.84308],"avgdrivengroundpasssuccess":[3.28236,3.33855,3.34582,3.36123,2.9303,3.02586,3.06459,3.10262,3.2329,3.23497,3.27167,3.19767,3.20853,3.20619,3.29842,3.33631,3.29572,3.25228,3.26756,3.38139,3.31813,3.36486,3.37603,3.41897,3.35994,3.32537,3.26121,3.1944,3.2226,3.32366],"avgthroughpasstry":[19.1365,19.2021,18.94,18.8902,20.1882,19.8503,19.6822,19.4907,19.358,19.2385,19.1533,19.1642,19.2541,19.2555,19.2935,19.214,19.2826,19.2454,19.2176,19.1628,19.0611,19.2961,19.2744,19.1093,19.1479,19.1432,19.1018,19.1999,19.397,19.2388],"avgthroughpasssuccess":[16.4433,16.4705,16.2837,16.2388,17.2526,17.0063,16.8871,16.7165,16.6102,16.51,16.4461,16.4639,16.5353,16.5392,16.5694,16.5047,16.5626,16.5479,16.5293,16.4834,16.3655,16.6065,16.5639,16.4216,16.4421,16.4428,16.4154,16.4999,16.6293,16.5095],"avglobbedthroughpasstry":[0.27421,0.2696,0.26403,0.24367,0.33948,0.30646,0.30226,0.28932,0.27941,0.27422,0.26563,0.26813,0.25921,0.27584,0.28084,0.26613,0.2688,0.26816,0.27495,0.2584,0.26999,0.2617,0.26607,0.26118,0.25941,0.26749,0.25442,0.26993,0.26541,0.25191],"avglobbedthroughpasssuccess":[0.17568,0.17208,0.16826,0.1565,0.2123,0.19132,0.18982,0.18482,0.17589,0.17402,0.16716,0.16865,0.16284,0.17454,0.17721,0.16822,0.17182,0.16908,0.17279,0.16598,0.17282,0.16705,0.16912,0.16566,0.16554,0.17312,0.16236,0.17243,0.16955,0.16095],"avgcornerkick":[1.78036,1.75319,1.74429,1.73503,1.80463,1.78724,1.77908,1.79588,1.78876,1.76317,1.75174,1.75507,1.76195,1.76002,1.7801,1.76009,1.7352,1.75033,1.76526,1.7548,1.74484,1.76353,1.74937,1.76078,1.74396,1.74713,1.73876,1.7609,1.7502,1.73433],"avgycards":[0.04246,0.04152,0.04174,0.04437,0.05832,0.05494,0.04907,0.04773,0.0456,0.04678,0.04598,0.04502,0.04553,0.04806,0.04884,0.04697,0.04371,0.047,0.04361,0.04882,0.05023,0.04847,0.04332,0.04634,0.04448,0.0484,0.04393,0.04564,0.04914,0.04691],"avgrcards":[0.00669,0.00756,0.00706,0.00663,0.00797,0.0081,0.00821,0.0074,0.00706,0.00767,0.00767,0.00647,0.00755,0.00688,0.00664,0.00729,0.00665,0.00715,0.00684,0.00714,0.00729,0.0081,0.00686,0.00791,0.00738,0.00816,0.0074,0.00759,0.00746,0.00806],"avginjury":[0.11017,0.11505,0.11309,0.11608,0.12176,0.12086,0.11652,0.11931,0.11692,0.11696,0.11519,0.11521,0.11665,0.1124,0.11733,0.11364,0.11476,0.11665,0.1156,0.11953,0.11645,0.1158,0.1135,0.11448,0.11307,0.11631,0.1169,0.11466,0.11503,0.11635],"avgoffsidecnt":[0.51814,0.52177,0.521,0.52087,0.54264,0.52942,0.52412,0.52566,0.51473,0.51899,0.51324,0.51277,0.51432,0.52038,0.51844,0.51826,0.51014,0.50356,0.51391,0.51373,0.50994,0.51131,0.5112,0.50945,0.52076,0.51878,0.51765,0.51593,0.51759,0.51422],"avgavgrating":[4.19231,4.19489,4.19368,4.18747,4.24046,4.22761,4.22664,4.21913,4.21058,4.20787,4.20521,4.21306,4.21347,4.20667,4.20824,4.20957,4.20228,4.20267,4.20282,4.20258,4.19748,4.20007,4.20069,4.19702,4.20236,4.19985,4.19552,4.20137,4.19915,4.19181]}
    
    data_2 = {"lengthDate":30,"date":["2024-11-10T00:00:00","2024-11-11T00:00:00","2024-11-12T00:00:00","2024-11-13T00:00:00","2024-11-14T00:00:00","2024-11-15T00:00:00","2024-11-16T00:00:00","2024-11-17T00:00:00","2024-11-18T00:00:00","2024-11-19T00:00:00","2024-11-20T00:00:00","2024-11-21T00:00:00","2024-11-22T00:00:00","2024-11-23T00:00:00","2024-11-24T00:00:00","2024-11-25T00:00:00","2024-11-26T00:00:00","2024-11-27T00:00:00","2024-11-28T00:00:00","2024-11-29T00:00:00","2024-11-30T00:00:00","2024-12-01T00:00:00","2024-12-02T00:00:00","2024-12-03T00:00:00","2024-12-04T00:00:00","2024-12-05T00:00:00","2024-12-06T00:00:00","2024-12-07T00:00:00","2024-12-08T00:00:00","2024-12-09T00:00:00"],"count":[222615,225100,222245,217492,205461,281199,263893,256493,259515,253672,250029,140058,251051,247037,238495,241450,241677,239638,154651,239316,235515,227361,237025,236454,231354,114725,227583,228135,220680,224446],"avggoaltot":[1.50401,1.50619,1.50461,1.50283,1.49446,1.45404,1.45844,1.45585,1.45956,1.46051,1.46525,1.4706,1.46372,1.46913,1.46865,1.47876,1.47012,1.47469,1.46734,1.47484,1.47983,1.47977,1.48403,1.47868,1.48263,1.45212,1.44821,1.44747,1.44615,1.45146],"avgshoottot":[4.83651,4.84718,4.85137,4.84619,4.61569,4.55334,4.59442,4.6072,4.6379,4.65278,4.67793,4.63409,4.67972,4.70586,4.69818,4.72393,4.71476,4.73082,4.6635,4.72518,4.74081,4.74027,4.75745,4.75601,4.76323,4.66425,4.72045,4.73512,4.71616,4.73197],"avgeffshoottot":[3.97647,3.98492,3.98961,3.98229,3.8051,3.74862,3.7812,3.79179,3.81617,3.82669,3.84822,3.81693,3.84926,3.86803,3.86293,3.88614,3.87609,3.89018,3.83835,3.88625,3.89956,3.89998,3.91461,3.91198,3.92,3.70207,3.68829,3.69516,3.68293,3.69542],"avggoalpenaltykick":[0.02676,0.02629,0.02708,0.02662,0.02563,0.0251,0.02516,0.02513,0.02544,0.02541,0.02575,0.02558,0.02569,0.02626,0.02566,0.02604,0.0263,0.02583,0.0261,0.02607,0.02582,0.02619,0.02602,0.02643,0.02629,0.02545,0.02588,0.02636,0.02619,0.0262],"avggoalfreekick":[0.00316,0.00324,0.00319,0.00306,0.00317,0.00304,0.00299,0.00316,0.00285,0.00313,0.00312,0.00315,0.00322,0.00304,0.00317,0.00312,0.00298,0.00313,0.00325,0.00309,0.00314,0.00307,0.00316,0.00326,0.00321,0.00349,0.00327,0.00325,0.00315,0.00324],"avgshootinpenalty":[3.08195,3.08612,3.09236,3.09138,2.95676,2.90482,2.93266,2.93661,2.95373,2.96123,2.97905,2.95642,2.97723,2.98976,2.98246,3.00057,2.9934,3.00257,2.967,2.99433,3.00473,3.00648,3.01803,3.0121,3.01959,2.95996,2.98176,2.9883,2.97522,2.98847],"avggoalinpenalty":[1.1404,1.14189,1.14051,1.14136,1.13548,1.103,1.10714,1.10496,1.10722,1.10755,1.11049,1.11608,1.10771,1.11255,1.11174,1.12005,1.11123,1.11409,1.10918,1.11412,1.11841,1.11804,1.12112,1.11543,1.11982,1.10652,1.10382,1.103,1.1011,1.10591],"avgshootoutpenalty":[1.71808,1.72513,1.7221,1.71839,1.62398,1.61403,1.6273,1.63633,1.64949,1.65656,1.66344,1.64296,1.66717,1.68028,1.68049,1.68759,1.68546,1.69249,1.66077,1.695,1.70088,1.69778,1.70362,1.70801,1.7076,1.66943,1.70333,1.7107,1.7052,1.70737],"avggoaloutpenalty":[0.33685,0.33802,0.33702,0.33485,0.33335,0.32594,0.32614,0.32577,0.3269,0.32754,0.32902,0.32893,0.33032,0.33032,0.33125,0.33267,0.3326,0.33477,0.33205,0.33464,0.33559,0.33554,0.33689,0.33681,0.33652,0.32015,0.3185,0.31811,0.31887,0.31935],"middleshoot":[19.6061,19.5936,19.5703,19.486,20.5266,20.1942,20.0417,19.9083,19.818,19.7722,19.7796,20.0209,19.8131,19.6585,19.7117,19.7125,19.7332,19.7799,19.994,19.7429,19.7306,19.7637,19.7752,19.7195,19.707,19.1772,18.6986,18.5951,18.6996,18.7041],"outpenaltygoalratio":[22.3967,22.4417,22.399,22.2811,22.3055,22.4163,22.3622,22.3763,22.3969,22.4264,22.455,22.3674,22.567,22.484,22.5549,22.4962,22.6237,22.7012,22.6297,22.6902,22.6779,22.6753,22.7012,22.7779,22.6973,22.0471,21.9927,21.9767,22.0493,22.0019],"avggoalheading":[0.18773,0.18713,0.18613,0.18552,0.18442,0.18057,0.18096,0.17947,0.18122,0.18073,0.18242,0.18096,0.18138,0.18093,0.18259,0.18301,0.18157,0.18199,0.18006,0.18098,0.18194,0.17984,0.18106,0.18073,0.1818,0.17758,0.17691,0.17698,0.17623,0.1771],"goalheadingratio":[12.4818,12.4241,12.3706,12.3449,12.3403,12.4186,12.408,12.3273,12.4162,12.3748,12.4498,12.3054,12.3919,12.3154,12.4321,12.3757,12.3508,12.3411,12.2711,12.2714,12.2949,12.1534,12.2008,12.2222,12.2621,12.2287,12.216,12.2269,12.1864,12.2017],"avgpasstry":[107.396,107.642,107.736,107.767,101.027,99.2871,100.174,100.939,101.708,102.267,102.804,101.897,103.188,103.939,104.092,104.716,104.877,105.301,104.274,105.656,106.208,106.184,106.68,106.75,107.168,105.235,107.111,107.768,107.291,107.846],"avgpasssuccess":[92.7945,93.0113,93.1035,93.1302,87.3263,85.7417,86.4995,87.1445,87.8173,88.2805,88.735,87.9682,89.0755,89.7684,89.9405,90.4685,90.6102,90.979,90.114,91.3065,91.8266,91.8186,92.2665,92.3147,92.6827,91.0487,92.6627,93.2485,92.829,93.3194],"passsuccessratio":[86.4044,86.4084,86.4185,86.4183,86.4388,86.3574,86.3496,86.3338,86.3423,86.3234,86.3151,86.3309,86.3232,86.3661,86.4051,86.3938,86.3965,86.3993,86.4203,86.4184,86.4595,86.4709,86.4894,86.4771,86.4836,86.5192,86.5107,86.5272,86.5208,86.5303],"avgowngoal":[0.00707,0.00709,0.00703,0.00716,0.00653,0.00625,0.0066,0.00652,0.00657,0.00655,0.00665,0.00677,0.00675,0.00677,0.00676,0.00682,0.00677,0.00674,0.00663,0.00687,0.00672,0.00676,0.00681,0.007,0.00679,0.00705,0.00707,0.00707,0.00711,0.00706],"avgpossession":[49.9231,49.9227,49.9367,49.9216,49.698,49.7494,49.7891,49.817,49.8425,49.8415,49.8497,49.8207,49.8765,49.8762,49.8804,49.8863,49.8797,49.8839,49.8698,49.9013,49.8989,49.9024,49.9068,49.9176,49.9231,49.8858,49.9131,49.9136,49.9235,49.9198],"avgdribble":[83.1726,83.3457,83.4202,83.4443,77.6667,76.5178,77.3018,77.9448,78.5716,79.0554,79.5203,78.6314,79.8607,80.5102,80.6587,81.1646,81.3057,81.652,80.7025,81.9603,82.3861,82.4218,82.7966,82.8445,83.1519,81.356,83.1479,83.6742,83.3109,83.7468],"avgtacklesuccess":[5.50217,5.50628,5.51185,5.51178,5.23276,5.17539,5.22027,5.24357,5.26432,5.29683,5.31899,5.28661,5.34857,5.36575,5.38005,5.40275,5.4058,5.43339,5.36067,5.44057,5.44079,5.44663,5.46358,5.45514,5.48131,5.38479,5.48101,5.50626,5.49213,5.5055],"avgtackletry":[8.13711,8.13762,8.14886,8.1508,7.74087,7.65787,7.71925,7.75563,7.79509,7.83324,7.86733,7.81775,7.90417,7.93096,7.95281,7.98457,7.98931,8.02984,7.9301,8.03535,8.04499,8.04894,8.06796,8.06445,8.10537,7.95663,8.09115,8.13001,8.11323,8.13544],"avgblocksuccess":[0.4392,0.44039,0.44123,0.44037,0.41226,0.40859,0.41295,0.41581,0.42038,0.4214,0.42431,0.4184,0.42503,0.42704,0.42745,0.42924,0.43007,0.42864,0.42228,0.42729,0.43077,0.43047,0.43217,0.43323,0.43223,0.42199,0.4294,0.42785,0.42877,0.42905],"avgblocktry":[7.12278,7.1368,7.13622,7.14517,6.67349,6.63026,6.688,6.73524,6.77865,6.82035,6.85122,6.7659,6.88998,6.91747,6.91764,6.9567,6.95847,6.98048,6.88197,6.98916,7.01003,7.0002,7.02099,7.03549,7.05288,6.90465,7.04626,7.07099,7.0345,7.05604],"avgfoul":[0.79042,0.79047,0.79124,0.79238,0.74332,0.73929,0.74516,0.74958,0.75493,0.75981,0.76379,0.75612,0.76691,0.77095,0.77487,0.77911,0.77824,0.78297,0.7705,0.7843,0.784,0.78302,0.78582,0.78755,0.78868,0.77512,0.79134,0.79588,0.7951,0.79742],"avgshootfreekick":[0.08679,0.08798,0.0871,0.08697,0.08217,0.08089,0.08192,0.08233,0.08388,0.0831,0.08352,0.08333,0.08443,0.08406,0.08507,0.08567,0.08487,0.08548,0.08512,0.08517,0.086,0.08495,0.08529,0.08655,0.08654,0.08425,0.08621,0.08665,0.08566,0.08692],"avgshootpenaltykick":[0.03435,0.03372,0.03473,0.0342,0.03281,0.03229,0.03238,0.03213,0.03262,0.03273,0.03331,0.03256,0.0331,0.03356,0.03302,0.03357,0.0336,0.03349,0.03346,0.03361,0.03297,0.03386,0.03365,0.03375,0.03384,0.03264,0.03313,0.03385,0.03349,0.0339],"avgshootheading":[0.95471,0.95783,0.95683,0.95714,0.90189,0.89535,0.9023,0.90399,0.91262,0.91614,0.92007,0.9078,0.92116,0.92402,0.9228,0.92622,0.92686,0.92826,0.91239,0.92377,0.92651,0.92468,0.92983,0.92825,0.929,0.89865,0.90443,0.90617,0.90152,0.90624],"avgshortpasstry":[62.8022,62.9633,63.0305,63.0608,59.1086,57.9282,58.4227,58.8609,59.3316,59.6444,59.9102,59.4497,60.1864,60.7228,60.8768,61.2357,61.3689,61.6346,61.1029,61.9086,62.3199,62.352,62.6821,62.7123,63.0119,61.8909,62.9715,63.4189,63.1295,63.4958],"avgshortpasssuccess":[60.9605,61.1186,61.185,61.2144,57.367,56.2116,56.6988,57.1225,57.587,57.8867,58.1457,57.6981,58.4146,58.9437,59.0991,59.4441,59.576,59.8345,59.3181,60.1032,60.5118,60.5452,60.8634,60.8975,61.1903,60.1,61.153,61.5931,61.3055,61.6617],"avglobpasstry":[6.90556,6.91599,6.91872,6.91023,6.44447,6.36608,6.4414,6.48469,6.53834,6.5713,6.61195,6.52391,6.61138,6.62656,6.61035,6.64635,6.64716,6.66834,6.56187,6.65444,6.66059,6.64867,6.66788,6.68741,6.71619,6.54333,6.63725,6.67387,6.64584,6.67108],"avglobpasssuccess":[2.25137,2.25253,2.2566,2.24981,2.12417,2.09292,2.11262,2.11656,2.1317,2.14119,2.15136,2.12484,2.14765,2.15242,2.15063,2.15811,2.15661,2.16278,2.12306,2.14953,2.15366,2.14598,2.15581,2.16204,2.16874,2.12414,2.14898,2.15828,2.1493,2.1564],"avgdrivengroundpasstry":[4.65554,4.67462,4.68734,4.69046,4.3427,4.28835,4.34503,4.38773,4.43114,4.46642,4.50258,4.43721,4.5086,4.54451,4.55069,4.58445,4.59097,4.60695,4.55181,4.61576,4.6411,4.64923,4.67138,4.67328,4.68262,4.59031,4.69651,4.72559,4.70005,4.72835],"avgdrivengroundpasssuccess":[4.50245,4.5195,4.53125,4.53458,4.19743,4.14602,4.201,4.24195,4.28405,4.31885,4.353,4.28986,4.35956,4.39457,4.40078,4.43409,4.44054,4.45519,4.40187,4.46277,4.48825,4.49752,4.51753,4.51953,4.52822,4.43951,4.54135,4.57028,4.54526,4.57275],"avgthroughpasstry":[23.0313,23.0755,23.0805,23.08,21.837,21.4583,21.6183,21.7875,21.901,22.0219,22.1458,22.0213,22.255,22.3724,22.4018,22.5415,22.5566,22.6541,22.446,22.7572,22.8176,22.7927,22.8766,22.8934,22.9762,22.5877,22.9817,23.0814,22.9967,23.0851],"avgthroughpasssuccess":[19.3718,19.4118,19.4192,19.4119,18.3523,18.0215,18.161,18.3036,18.4049,18.5024,18.6133,18.4956,18.6995,18.8043,18.8339,18.9518,18.9622,19.0451,18.8711,19.1339,19.1889,19.1722,19.2475,19.259,19.3249,18.9938,19.3304,19.4126,19.3414,19.4178],"avglobbedthroughpasstry":[9.13576,9.14688,9.14944,9.16188,8.4712,8.43163,8.52771,8.59187,8.67582,8.7276,8.79458,8.63579,8.7873,8.83357,8.81306,8.86431,8.86893,8.88846,8.77204,8.87366,8.92208,8.89515,8.93392,8.93213,8.92832,8.78569,8.97402,9.02062,8.97157,9.01604],"avglobbedthroughpasssuccess":[5.53042,5.53081,5.53292,5.54057,5.1144,5.1018,5.15741,5.18992,5.23959,5.26049,5.29935,5.18797,5.28388,5.30197,5.28517,5.30857,5.3031,5.30948,5.22816,5.28418,5.3104,5.28635,5.31007,5.30337,5.29716,5.22197,5.31762,5.34446,5.31662,5.33957],"avgcornerkick":[1.96961,1.97342,1.98021,1.97296,1.84464,1.82681,1.85113,1.86503,1.88227,1.88803,1.90196,1.8676,1.90241,1.91061,1.90457,1.91714,1.91622,1.92351,1.88798,1.92118,1.92653,1.92857,1.93019,1.93624,1.94223,1.82064,1.82669,1.83422,1.82745,1.83233],"avgycards":[0.07748,0.07682,0.07702,0.07719,0.07302,0.07234,0.07337,0.07355,0.07411,0.07456,0.07477,0.0741,0.07443,0.07587,0.07634,0.07596,0.07604,0.07667,0.07561,0.0772,0.07772,0.07653,0.07698,0.07828,0.07761,0.07856,0.08092,0.08157,0.08049,0.08171],"avgrcards":[0.00302,0.00304,0.00301,0.00298,0.00283,0.00277,0.00289,0.00299,0.00295,0.00312,0.00308,0.00288,0.00297,0.00307,0.00313,0.00295,0.00313,0.00313,0.00304,0.0031,0.00303,0.00317,0.00314,0.00308,0.00304,0.0032,0.00314,0.00327,0.00317,0.00337],"avginjury":[0.1459,0.14674,0.14746,0.14682,0.13812,0.13558,0.13594,0.1382,0.13994,0.14104,0.14078,0.14085,0.14213,0.14185,0.14205,0.14365,0.14273,0.14364,0.14217,0.14502,0.14446,0.14348,0.14392,0.14463,0.14554,0.14083,0.14314,0.1437,0.14441,0.14357],"avgoffsidecnt":[1.67332,1.68,1.68052,1.68825,1.55795,1.55043,1.5753,1.59104,1.60525,1.6183,1.62892,1.59728,1.63096,1.64207,1.63976,1.65142,1.65355,1.65857,1.63303,1.65732,1.67053,1.66393,1.67119,1.67287,1.67111,1.63377,1.6766,1.68256,1.67401,1.67923],"avgavgrating":[4.01619,4.01561,4.01602,4.01514,4.03403,4.02572,4.0237,4.02162,4.02004,4.01922,4.01877,4.02412,4.01749,4.017,4.0167,4.01536,4.01512,4.01529,4.01702,4.01396,4.01446,4.01421,4.01409,4.01382,4.01405,4.01361,4.00749,4.00706,4.00688,4.00632]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
