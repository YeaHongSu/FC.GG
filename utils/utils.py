import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    # match_type = "50" -> 공경
    data_1 = {"lengthDate":30,"date":["2025-03-10T00:00:00","2025-03-11T00:00:00","2025-03-12T00:00:00","2025-03-13T00:00:00","2025-03-14T00:00:00","2025-03-15T00:00:00","2025-03-16T00:00:00","2025-03-17T00:00:00","2025-03-18T00:00:00","2025-03-19T00:00:00","2025-03-20T00:00:00","2025-03-21T00:00:00","2025-03-22T00:00:00","2025-03-23T00:00:00","2025-03-24T00:00:00","2025-03-25T00:00:00","2025-03-26T00:00:00","2025-03-27T00:00:00","2025-03-28T00:00:00","2025-03-29T00:00:00","2025-03-30T00:00:00","2025-03-31T00:00:00","2025-04-01T00:00:00","2025-04-02T00:00:00","2025-04-03T00:00:00","2025-04-04T00:00:00","2025-04-05T00:00:00","2025-04-06T00:00:00","2025-04-07T00:00:00","2025-04-08T00:00:00"],"count":[22711,22102,21555,21208,24666,28734,27391,20443,20271,20155,20722,26869,30163,30721,23269,21979,23554,22074,21978,24974,24720,15385,20399,20742,18832,20143,22280,20487,15597,15075],"avggoaltot":[2.6123,2.5857,2.5932,2.5914,2.6002,2.591,2.5942,2.5891,2.5997,2.5984,2.6706,2.6655,2.6571,2.6319,2.6262,2.6299,2.621,2.6388,2.6256,2.6184,2.6023,2.6325,2.6134,2.6207,2.611,2.6165,2.6292,2.6149,2.6243,2.5981],"avgshoottot":[7.0165,6.9759,6.985,6.9418,7.0084,6.9814,6.9523,6.9177,6.944,6.9071,7.0713,7.0604,7.0595,7.0066,6.9424,6.9771,6.9145,6.952,6.9866,6.9718,6.9251,6.9271,6.9039,6.9176,6.9709,6.9583,6.9617,6.9527,6.9502,6.9231],"avgeffshoottot":[5.3367,5.2982,5.3308,5.2839,5.3367,5.3246,5.3107,5.2817,5.2942,5.274,5.4018,5.4023,5.3929,5.3595,5.3222,5.3399,5.2946,5.3298,5.3232,5.3234,5.3056,5.2956,5.2719,5.289,5.3265,5.3238,5.3314,5.3227,5.3203,5.2805],"avggoalpenaltykick":[0.0604,0.0613,0.0595,0.0603,0.0603,0.0613,0.0613,0.0592,0.0645,0.0595,0.0656,0.0628,0.0631,0.0613,0.0637,0.066,0.0636,0.0659,0.0648,0.0654,0.0631,0.0637,0.0616,0.0646,0.063,0.0642,0.061,0.0631,0.0626,0.0624],"avggoalfreekick":[0.0176,0.0184,0.0176,0.0177,0.0185,0.0177,0.0183,0.0198,0.0186,0.0183,0.0202,0.0195,0.0191,0.0181,0.0185,0.0189,0.0195,0.0193,0.0186,0.0178,0.0177,0.0185,0.0205,0.0189,0.0187,0.0196,0.0184,0.0196,0.0191,0.0177],"avgshootinpenalty":[4.6589,4.6324,4.6298,4.6088,4.6533,4.6534,4.6228,4.6168,4.6211,4.6242,4.7301,4.7334,4.7249,4.7089,4.6626,4.6821,4.6442,4.6568,4.6794,4.6774,4.6498,4.6452,4.6185,4.6257,4.664,4.6646,4.6621,4.6402,4.6433,4.6348],"avggoalinpenalty":[2.0525,2.0287,2.032,2.0392,2.0436,2.0473,2.0338,2.0439,2.0478,2.0497,2.107,2.11,2.0937,2.083,2.0738,2.081,2.0696,2.0806,2.0649,2.0627,2.0616,2.0793,2.0605,2.0662,2.058,2.0674,2.075,2.0595,2.0625,2.0487],"avgshootoutpenalty":[2.2727,2.257,2.2685,2.2471,2.2683,2.2424,2.2425,2.2169,2.2326,2.1992,2.2493,2.238,2.2448,2.2099,2.1891,2.203,2.1813,2.2039,2.2168,2.2039,2.1872,2.195,2.1977,2.2019,2.2189,2.2034,2.213,2.2246,2.2199,2.2016],"avggoaloutpenalty":[0.4994,0.4957,0.5018,0.4918,0.4962,0.4825,0.4991,0.486,0.4873,0.4891,0.4981,0.4928,0.5002,0.4876,0.4887,0.4829,0.4878,0.4923,0.4958,0.4903,0.4776,0.4895,0.4912,0.4898,0.49,0.4849,0.4932,0.4923,0.4993,0.4869],"middleshoot":[21.9728,21.9635,22.1191,21.8859,21.8764,21.5148,22.2539,21.9233,21.8266,22.2398,22.143,22.0185,22.2845,22.0639,22.3242,21.9182,22.3634,22.3365,22.3673,22.2462,21.8342,22.2988,22.3516,22.2439,22.0853,22.0077,22.2872,22.1284,22.4911,22.1175],"outpenaltygoalratio":[19.1173,19.1708,19.3506,18.9782,19.0831,18.6222,19.2391,18.771,18.7445,18.8231,18.6512,18.4881,18.825,18.5265,18.6086,18.3619,18.6112,18.6562,18.8833,18.7252,18.353,18.5945,18.7954,18.6897,18.7668,18.5324,18.7586,18.8267,19.026,18.7406],"avggoalheading":[0.2893,0.2883,0.2838,0.2838,0.2821,0.2833,0.285,0.2887,0.297,0.2966,0.2958,0.2938,0.2898,0.2948,0.2871,0.2963,0.2958,0.2917,0.2915,0.296,0.2944,0.2935,0.3025,0.3039,0.3056,0.3023,0.3022,0.3077,0.309,0.3136],"goalheadingratio":[11.0745,11.1488,10.943,10.9524,10.85,10.9349,10.987,11.1509,11.4263,11.4167,11.0765,11.0238,10.908,11.2009,10.9312,11.2668,11.2861,11.0538,11.1031,11.3046,11.3138,11.1509,11.5766,11.5953,11.7058,11.5549,11.494,11.7673,11.7755,12.071],"avgpasstry":[104.9,104.866,104.958,104.35,104.846,105.32,105.509,105.874,105.482,105.193,105.038,104.819,105.329,105.586,105.936,105.286,105.518,104.857,105.179,105.64,105.663,105.662,105.383,105.155,106.067,105.715,104.93,105.074,105.169,105.71],"avgpasssuccess":[95.0181,94.9889,95.1402,94.536,94.9347,95.3915,95.6035,96.0186,95.5863,95.35,95.1942,94.9976,95.49,95.6287,96.0378,95.4437,95.6661,95.0423,95.315,95.6827,95.7526,95.7721,95.485,95.2901,96.1216,95.8241,95.0622,95.2376,95.3406,95.8405],"passsuccessratio":[90.5799,90.5813,90.6461,90.5949,90.5464,90.5731,90.6113,90.6916,90.6185,90.6427,90.628,90.6299,90.6589,90.5699,90.6562,90.6516,90.6632,90.6402,90.6216,90.5746,90.6205,90.6404,90.6077,90.619,90.6231,90.6436,90.5958,90.6387,90.6546,90.6635],"avgowngoal":[0.0182,0.0174,0.0186,0.0177,0.0185,0.0172,0.0178,0.0172,0.0196,0.0176,0.0184,0.0175,0.0181,0.0171,0.0178,0.0179,0.0173,0.0174,0.0202,0.0173,0.017,0.0172,0.0168,0.0175,0.0174,0.0169,0.019,0.0158,0.0182,0.0183],"avgpossession":[50.5463,50.5193,50.5294,50.6338,50.5959,50.569,50.5849,50.5223,50.4911,50.4339,50.7836,50.7157,50.7031,50.6437,50.5878,50.5941,50.587,50.593,50.5735,50.5849,50.5059,50.5141,50.4876,50.4958,50.4598,50.4775,50.5531,50.5388,50.5693,50.4899],"avgdribble":[72.5656,72.7672,72.8178,72.5609,72.6553,72.9464,73.2145,73.3687,73.3096,73.0577,73.0573,72.9877,73.1524,73.2302,73.4264,73.1697,72.9319,72.7897,72.9243,73.2492,73.3055,73.0702,73.2932,73.1546,73.6789,73.6862,73.156,73.0371,73.0226,73.5291],"avgtacklesuccess":[6.0725,6.0174,6.0361,6.0865,6.0933,6.0872,6.0671,6.0673,6.0722,6.1285,6.149,6.1406,6.1686,6.1339,6.1212,6.1605,6.0858,6.1462,6.1965,6.1428,6.0752,6.1225,6.1243,6.1598,6.1281,6.145,6.1884,6.1462,6.1444,6.1329],"avgtackletry":[11.3904,11.2951,11.3878,11.3777,11.4306,11.4343,11.3887,11.4082,11.4093,11.5046,11.474,11.5158,11.5333,11.5037,11.5103,11.6326,11.4224,11.5278,11.5838,11.5427,11.4185,11.4957,11.467,11.5913,11.5048,11.5656,11.6029,11.5679,11.5812,11.5836],"avgblocksuccess":[0.6299,0.6293,0.6364,0.6227,0.6244,0.6264,0.631,0.6193,0.6269,0.6332,0.6074,0.6173,0.6138,0.6243,0.6112,0.6119,0.6077,0.6074,0.6149,0.6135,0.6228,0.6109,0.6188,0.614,0.6147,0.623,0.6105,0.612,0.6118,0.6131],"avgblocktry":[8.2956,8.2726,8.3004,8.219,8.2745,8.2666,8.3334,8.2716,8.2922,8.3161,8.2055,8.2227,8.2363,8.2996,8.2761,8.2614,8.2165,8.2362,8.2321,8.2809,8.3112,8.2584,8.2955,8.2783,8.3559,8.3524,8.2451,8.2253,8.245,8.2553],"avgfoul":[0.6996,0.6933,0.6901,0.6961,0.7086,0.7075,0.698,0.6936,0.7055,0.7037,0.7051,0.7101,0.701,0.7008,0.6895,0.7084,0.6933,0.7107,0.7134,0.7037,0.6967,0.7037,0.7045,0.7023,0.7097,0.7171,0.7176,0.7054,0.7088,0.7094],"avgshootfreekick":[0.1856,0.1901,0.1796,0.1834,0.1916,0.1855,0.1826,0.1871,0.1902,0.1849,0.1947,0.1898,0.1874,0.1854,0.188,0.1965,0.1871,0.1931,0.1911,0.1867,0.1854,0.1922,0.19,0.189,0.1915,0.1923,0.1865,0.1904,0.1914,0.1926],"avgshootpenaltykick":[0.0776,0.08,0.0785,0.0791,0.0796,0.0782,0.0798,0.0766,0.0829,0.0765,0.0842,0.0815,0.0824,0.0801,0.0832,0.0845,0.0818,0.084,0.0833,0.0828,0.0811,0.0802,0.0807,0.083,0.0811,0.0827,0.0795,0.0806,0.0804,0.0804],"avgshootheading":[0.9679,0.9672,0.9376,0.9422,0.9535,0.9522,0.9375,0.9502,0.9612,0.9645,0.9814,0.9635,0.9693,0.9792,0.9565,0.9732,0.9649,0.9632,0.9721,0.9835,0.9671,0.9574,0.9709,1.0001,0.9878,0.9899,0.9872,0.9924,0.996,1.0125],"avgshortpasstry":[75.7959,75.7231,76.0856,75.3608,75.6763,76.1145,76.3336,76.7276,76.1678,76.2943,75.7366,75.6988,76.1648,76.2541,76.8397,76.107,76.3982,75.8079,75.9859,76.5124,76.3984,76.5067,76.1543,75.9408,76.522,76.2323,75.6339,75.9857,75.9435,76.4466],"avgshortpasssuccess":[72.1533,72.1093,72.45,71.746,72.0221,72.4563,72.6671,73.0903,72.5322,72.6415,72.1318,72.0885,72.5082,72.5888,73.1555,72.4932,72.7528,72.1855,72.35,72.8225,72.7335,72.8395,72.5157,72.3201,72.8902,72.6035,72.0003,72.3479,72.3132,72.849],"avglobpasstry":[4.8085,4.8841,4.8261,4.7295,4.811,4.8229,4.7588,4.8678,4.9361,4.8001,4.8714,4.8276,4.7551,4.8604,4.8031,4.8772,4.8364,4.8254,4.8596,4.8908,4.8404,4.8583,4.9155,4.9177,4.9728,4.9365,4.8826,4.8736,4.9488,5.0934],"avglobpasssuccess":[2.733,2.7717,2.7389,2.6862,2.7309,2.7324,2.7029,2.7803,2.8226,2.7318,2.7743,2.7547,2.7128,2.7739,2.7419,2.8011,2.7679,2.7454,2.7695,2.7839,2.755,2.7807,2.7996,2.8109,2.8257,2.8244,2.7856,2.7851,2.8214,2.9103],"avgdrivengroundpasstry":[3.881,3.9035,3.8598,3.9441,3.9089,3.8163,3.8873,3.9123,3.9666,3.8039,4.0096,3.9478,3.8682,3.8576,3.9093,4.0267,3.8995,4.0004,3.9084,3.861,3.8993,3.9093,3.957,4.0041,3.9715,4.0196,3.8843,3.9361,4.0424,4.0358],"avgdrivengroundpasssuccess":[3.3671,3.3918,3.3371,3.4204,3.3741,3.3005,3.3657,3.3921,3.4398,3.2926,3.4829,3.4171,3.3553,3.3373,3.3912,3.4967,3.3823,3.4737,3.3865,3.3428,3.3755,3.3856,3.4398,3.4786,3.4553,3.4948,3.3745,3.4225,3.5234,3.5198],"avgthroughpasstry":[19.171,19.1181,18.9577,19.0681,19.1958,19.3005,19.2586,19.1264,19.1496,19.0382,19.1513,19.1039,19.28,19.3339,19.1284,19.0097,19.1249,18.9753,19.1588,19.1094,19.25,19.1111,19.1016,19.0401,19.3207,19.2573,19.2571,19.0212,18.9792,18.8644],"avgthroughpasssuccess":[16.5016,16.453,16.3506,16.415,16.5373,16.6284,16.5931,16.4965,16.516,16.4134,16.5254,16.4694,16.6432,16.6549,16.4782,16.3774,16.4913,16.3706,16.5327,16.4533,16.6054,16.4826,16.465,16.4138,16.6733,16.6308,16.6255,16.4095,16.4081,16.2839],"avglobbedthroughpasstry":[0.2325,0.238,0.2381,0.2377,0.2395,0.2478,0.2492,0.2295,0.2504,0.2406,0.2381,0.2344,0.243,0.2434,0.2368,0.2358,0.2349,0.2334,0.2545,0.2588,0.2571,0.2466,0.2369,0.242,0.2543,0.2439,0.2412,0.2472,0.2453,0.2494],"avglobbedthroughpasssuccess":[0.1506,0.1521,0.1548,0.1546,0.1547,0.1601,0.1611,0.1465,0.1611,0.1548,0.1562,0.1518,0.1571,0.1561,0.1527,0.1517,0.1526,0.1492,0.1622,0.167,0.1648,0.1597,0.1525,0.1557,0.1634,0.1585,0.1569,0.1587,0.1588,0.16],"avgcornerkick":[1.7358,1.7634,1.7589,1.7397,1.7732,1.7646,1.7446,1.7316,1.744,1.7367,1.7734,1.7566,1.7481,1.7605,1.7465,1.7469,1.7376,1.7503,1.7487,1.7503,1.7392,1.7263,1.7307,1.727,1.7633,1.7426,1.7397,1.752,1.7574,1.7491],"avgycards":[0.0449,0.0442,0.0441,0.0439,0.0453,0.0453,0.0479,0.0397,0.0448,0.0437,0.0423,0.046,0.0422,0.043,0.0415,0.0461,0.0442,0.0428,0.0455,0.0434,0.0437,0.0429,0.0437,0.0426,0.0441,0.0425,0.0451,0.0423,0.0435,0.0442],"avgrcards":[0.0073,0.0058,0.0071,0.0075,0.007,0.0077,0.0066,0.0076,0.006,0.0074,0.0064,0.0075,0.0069,0.0062,0.0058,0.0065,0.0058,0.0061,0.0071,0.0071,0.0068,0.0082,0.0066,0.0069,0.0069,0.007,0.0078,0.0063,0.0061,0.0064],"avginjury":[0.1154,0.1163,0.1165,0.1146,0.1146,0.1165,0.1143,0.1146,0.1152,0.1172,0.1166,0.1204,0.1176,0.1155,0.1158,0.1222,0.1129,0.1141,0.118,0.1149,0.1159,0.1158,0.1116,0.1203,0.1184,0.1156,0.1189,0.1153,0.1198,0.115],"avgoffsidecnt":[0.503,0.5059,0.5026,0.5022,0.5106,0.5056,0.5079,0.4996,0.507,0.502,0.512,0.5076,0.5159,0.5114,0.5087,0.5073,0.5077,0.5045,0.4992,0.5009,0.5067,0.5135,0.4987,0.5,0.5057,0.4994,0.5025,0.4998,0.4957,0.503],"avgavgrating":[4.18665,4.1833,4.18595,4.18377,4.1847,4.18537,4.18328,4.18418,4.18145,4.18286,4.20334,4.19769,4.20391,4.20025,4.19665,4.19381,4.19102,4.19121,4.18893,4.19301,4.19159,4.19374,4.18877,4.18201,4.18321,4.18762,4.18683,4.1871,4.19082,4.18012]}

    # match_type = "52" ->  감모
    data_2 = {"lengthDate":30,"date":["2025-03-10T00:00:00","2025-03-11T00:00:00","2025-03-12T00:00:00","2025-03-13T00:00:00","2025-03-14T00:00:00","2025-03-15T00:00:00","2025-03-16T00:00:00","2025-03-17T00:00:00","2025-03-18T00:00:00","2025-03-19T00:00:00","2025-03-20T00:00:00","2025-03-21T00:00:00","2025-03-22T00:00:00","2025-03-23T00:00:00","2025-03-24T00:00:00","2025-03-25T00:00:00","2025-03-26T00:00:00","2025-03-27T00:00:00","2025-03-28T00:00:00","2025-03-29T00:00:00","2025-03-30T00:00:00","2025-03-31T00:00:00","2025-04-01T00:00:00","2025-04-02T00:00:00","2025-04-03T00:00:00","2025-04-04T00:00:00","2025-04-05T00:00:00","2025-04-06T00:00:00","2025-04-07T00:00:00","2025-04-08T00:00:00"],"count":[249340,249310,247494,172123,249720,247180,243297,247694,246535,245323,149251,247037,246680,241250,247442,247494,246920,175977,248941,247951,243118,217830,238940,247960,179249,249306,211189,208374,213623,216496],"avggoaltot":[1.4079,1.4053,1.4091,1.407,1.4102,1.4129,1.4147,1.4154,1.412,1.4151,1.4023,1.4079,1.4099,1.4091,1.417,1.4115,1.4102,1.4035,1.4122,1.4136,1.4139,1.4129,1.4112,1.4113,1.4057,1.4086,1.4154,1.4127,1.4116,1.4147],"avgshoottot":[4.6429,4.6458,4.6563,4.6232,4.6594,4.6819,4.674,4.6878,4.6878,4.6926,4.631,4.6772,4.6848,4.6802,4.6971,4.6909,4.6926,4.6565,4.6969,4.7069,4.7013,4.6952,4.6948,4.7005,4.6611,4.6959,4.7071,4.7014,4.7017,4.7128],"avgeffshoottot":[3.6212,3.6222,3.6321,3.6105,3.635,3.6518,3.6459,3.6552,3.6524,3.66,3.6101,3.6432,3.6531,3.6488,3.6617,3.6578,3.6567,3.6316,3.6596,3.6666,3.6652,3.6604,3.6592,3.6654,3.6365,3.6566,3.6714,3.6646,3.6637,3.6745],"avggoalpenaltykick":[0.0252,0.0251,0.0252,0.0252,0.0251,0.0254,0.0252,0.0256,0.0255,0.0259,0.0254,0.0256,0.0257,0.0252,0.0257,0.0255,0.0255,0.0254,0.0258,0.0254,0.0258,0.0262,0.0254,0.0258,0.025,0.0257,0.0255,0.0256,0.0263,0.026],"avggoalfreekick":[0.0035,0.0037,0.0035,0.0034,0.0033,0.0034,0.0034,0.0034,0.0034,0.0035,0.0034,0.0034,0.0034,0.0033,0.0034,0.0034,0.0033,0.0033,0.0034,0.0033,0.0034,0.0035,0.0033,0.0034,0.0034,0.0033,0.0034,0.0035,0.0035,0.0035],"avgshootinpenalty":[2.8788,2.8808,2.8882,2.8726,2.8895,2.9026,2.9045,2.9105,2.9078,2.91,2.886,2.9004,2.9062,2.9025,2.913,2.9104,2.911,2.8971,2.9145,2.9203,2.9189,2.9149,2.913,2.9166,2.8975,2.9112,2.9211,2.916,2.9122,2.927],"avggoalinpenalty":[1.063,1.0607,1.0643,1.0639,1.0653,1.0666,1.0697,1.0713,1.0673,1.0692,1.0612,1.0636,1.0649,1.064,1.0695,1.0659,1.0644,1.0625,1.0665,1.0688,1.0686,1.0687,1.0656,1.0653,1.0616,1.0639,1.0709,1.0683,1.0648,1.0679],"avgshootoutpenalty":[1.7294,1.7305,1.7337,1.7163,1.7353,1.7447,1.7347,1.7423,1.745,1.7473,1.7099,1.7418,1.7436,1.7429,1.7488,1.7455,1.7463,1.7247,1.7472,1.7519,1.7471,1.7444,1.7468,1.7489,1.7293,1.7495,1.7514,1.7502,1.7535,1.7499],"avggoaloutpenalty":[0.3197,0.3195,0.3195,0.3179,0.3198,0.321,0.3198,0.3186,0.3192,0.3201,0.3156,0.3187,0.3192,0.3199,0.3218,0.3201,0.3204,0.3157,0.3199,0.3195,0.3194,0.318,0.3202,0.3202,0.3191,0.3189,0.3191,0.3188,0.3205,0.3209],"middleshoot":[18.4873,18.464,18.429,18.5248,18.4278,18.3978,18.4372,18.2859,18.2908,18.3188,18.4592,18.2982,18.3086,18.3543,18.4033,18.3383,18.3447,18.3021,18.3079,18.2354,18.2808,18.2272,18.3285,18.3089,18.451,18.23,18.2185,18.2162,18.2747,18.3359],"outpenaltygoalratio":[22.7076,22.7354,22.674,22.5942,22.6776,22.7192,22.6055,22.5095,22.6062,22.6203,22.5059,22.6366,22.6399,22.7024,22.71,22.678,22.7202,22.4938,22.6526,22.6019,22.59,22.5069,22.6899,22.6883,22.7004,22.6395,22.5449,22.5667,22.7047,22.6833],"avggoalheading":[0.1683,0.1674,0.1687,0.1682,0.1674,0.1676,0.1689,0.1696,0.1693,0.169,0.1677,0.168,0.1681,0.1694,0.1707,0.1684,0.169,0.1695,0.1704,0.1704,0.1705,0.1692,0.1702,0.1709,0.1683,0.1703,0.171,0.1706,0.17,0.1702],"goalheadingratio":[11.9545,11.9127,11.97,11.9556,11.8722,11.8636,11.9406,11.9822,11.9931,11.9426,11.9625,11.9326,11.9257,12.0206,12.0489,11.9291,11.9827,12.0736,12.0633,12.0543,12.0566,11.9721,12.0579,12.1113,11.9698,12.0879,12.0787,12.0766,12.0438,12.0279],"avgpasstry":[108.704,108.849,109.105,108.188,109.234,109.622,109.478,109.695,109.741,109.994,108.392,109.697,110.143,109.716,110.077,109.934,109.947,108.958,109.934,110.025,109.997,109.802,109.635,110.027,108.935,109.781,109.831,109.786,110.002,109.891],"avgpasssuccess":[94.5882,94.6963,94.9382,94.1268,95.0427,95.3654,95.2421,95.4264,95.4607,95.7015,94.2541,95.4062,95.8351,95.4446,95.7387,95.6206,95.6251,94.7203,95.582,95.6612,95.6543,95.4662,95.3202,95.6562,94.6818,95.4231,95.4628,95.4298,95.6195,95.5302],"passsuccessratio":[87.0145,86.9979,87.0157,87.0033,87.008,86.9944,86.9964,86.9921,86.9871,87.0064,86.9564,86.9725,87.0098,86.9925,86.974,86.9798,86.9741,86.9332,86.9449,86.9453,86.9606,86.9437,86.9428,86.9389,86.9156,86.9216,86.918,86.9233,86.925,86.9316],"avgowngoal":[0.0071,0.0071,0.0071,0.0071,0.0069,0.007,0.0068,0.007,0.0072,0.0071,0.0072,0.0073,0.0071,0.0071,0.0071,0.0069,0.0072,0.0071,0.0069,0.0071,0.0073,0.0071,0.0071,0.007,0.0072,0.0071,0.0072,0.0072,0.0075,0.0071],"avgpossession":[49.922,49.921,49.9176,49.9141,49.9284,49.9383,49.9377,49.9422,49.947,49.9534,49.9415,49.9482,49.9605,49.9479,49.9486,49.9509,49.9558,49.9504,49.9617,49.9616,49.9666,49.9633,49.9715,49.9633,49.9559,49.9644,49.9621,49.9705,49.972,49.9709],"avgdribble":[84.5034,84.5773,84.7956,83.9571,84.9031,85.2222,85.1194,85.2761,85.3172,85.5109,84.0772,85.3318,85.6873,85.3595,85.6102,85.5031,85.5234,84.6217,85.523,85.6011,85.593,85.3938,85.3036,85.6025,84.698,85.4686,85.519,85.4864,85.6761,85.5837],"avgtacklesuccess":[5.555,5.5572,5.5651,5.5178,5.5703,5.5883,5.5976,5.5986,5.6011,5.6025,5.5439,5.612,5.6078,5.6052,5.6264,5.6178,5.6209,5.5783,5.636,5.6372,5.6299,5.6266,5.6208,5.6288,5.5843,5.6277,5.6259,5.6276,5.635,5.6242],"avgtackletry":[8.1957,8.1965,8.2107,8.139,8.2096,8.2425,8.2496,8.2552,8.2617,8.2629,8.18,8.2741,8.2705,8.2668,8.2925,8.2847,8.2888,8.2262,8.311,8.3111,8.3013,8.3008,8.297,8.3046,8.2372,8.2958,8.2978,8.3012,8.309,8.3013],"avgblocksuccess":[0.4286,0.4297,0.4302,0.428,0.4311,0.4319,0.4307,0.4331,0.4343,0.4343,0.4269,0.4334,0.4324,0.4313,0.4333,0.4343,0.4356,0.4315,0.4354,0.436,0.4351,0.4353,0.4355,0.4369,0.4326,0.4358,0.4361,0.4349,0.4378,0.437],"avgblocktry":[7.0444,7.052,7.0749,7.0004,7.0794,7.1014,7.0959,7.112,7.1199,7.1224,7.0135,7.1199,7.1224,7.1137,7.1306,7.1248,7.1404,7.0726,7.1492,7.1474,7.1412,7.1277,7.1304,7.1527,7.0722,7.1389,7.1451,7.1329,7.1429,7.1321],"avgfoul":[0.8008,0.8034,0.8019,0.7966,0.8001,0.8065,0.8048,0.8061,0.8058,0.8096,0.8008,0.8073,0.809,0.8074,0.8147,0.8116,0.8115,0.8056,0.8139,0.8135,0.8109,0.8099,0.8147,0.8141,0.8043,0.8116,0.8125,0.813,0.8153,0.815],"avgshootfreekick":[0.0886,0.089,0.0888,0.0878,0.0881,0.0891,0.0876,0.0889,0.0888,0.089,0.0876,0.0885,0.0886,0.0885,0.0891,0.0896,0.0887,0.0876,0.0892,0.0897,0.0892,0.0887,0.0885,0.0896,0.0885,0.0887,0.0901,0.0891,0.0896,0.0888],"avgshootpenaltykick":[0.0325,0.0324,0.0322,0.0323,0.0325,0.0326,0.0325,0.0329,0.0328,0.0331,0.033,0.0329,0.0328,0.0326,0.0332,0.0328,0.033,0.0326,0.0332,0.0326,0.0331,0.0337,0.0331,0.0329,0.0323,0.0331,0.0327,0.0332,0.0339,0.0338],"avgshootheading":[0.8584,0.8594,0.8619,0.8574,0.8626,0.8667,0.8677,0.8706,0.8713,0.8712,0.8618,0.8695,0.87,0.8713,0.8747,0.8719,0.8743,0.8701,0.8764,0.8803,0.876,0.8765,0.8795,0.8775,0.8677,0.8775,0.8782,0.8772,0.878,0.8803],"avgshortpasstry":[65.0872,65.152,65.3434,64.7681,65.4012,65.5907,65.5018,65.592,65.6233,65.8199,64.7603,65.5712,65.9389,65.6259,65.7955,65.7007,65.698,65.0393,65.6185,65.6657,65.6844,65.5402,65.439,65.6757,64.9468,65.4616,65.4584,65.4433,65.5838,65.5113],"avgshortpasssuccess":[63.2332,63.299,63.4892,62.9267,63.5438,63.7235,63.6405,63.7239,63.7543,63.9495,62.9138,63.7004,64.0705,63.7607,63.9193,63.8327,63.8245,63.1805,63.7436,63.7882,63.8124,63.6688,63.5715,63.8036,63.0958,63.5911,63.5892,63.5817,63.7152,63.6451],"avglobpasstry":[6.434,6.4603,6.4893,6.4408,6.4996,6.5416,6.5287,6.5495,6.5536,6.5659,6.4881,6.5519,6.5671,6.544,6.5882,6.5714,6.5825,6.5431,6.594,6.6035,6.5899,6.5954,6.5865,6.6077,6.5455,6.5945,6.6125,6.592,6.6064,6.5996],"avglobpasssuccess":[2.0808,2.0879,2.0997,2.0833,2.1009,2.1156,2.1099,2.1208,2.1211,2.1243,2.0979,2.1136,2.1174,2.1165,2.1292,2.1207,2.1277,2.1137,2.1282,2.1347,2.1317,2.1306,2.1273,2.1303,2.1072,2.1273,2.1315,2.1244,2.1276,2.1288],"avgdrivengroundpasstry":[4.6097,4.6158,4.6226,4.5826,4.6221,4.6519,4.6387,4.6583,4.655,4.6635,4.5965,4.6606,4.6754,4.6611,4.6703,4.6744,4.6701,4.6253,4.6758,4.6828,4.6782,4.6677,4.6673,4.6924,4.6586,4.7008,4.7016,4.7071,4.7173,4.7182],"avgdrivengroundpasssuccess":[4.4573,4.4627,4.47,4.4307,4.4683,4.4974,4.4844,4.5037,4.5022,4.5093,4.4434,4.5072,4.5206,4.5072,4.5151,4.5202,4.5167,4.4724,4.5224,4.5274,4.5236,4.5142,4.5139,4.5376,4.505,4.5455,4.5474,4.5523,4.5628,4.5642],"avgthroughpasstry":[23.4927,23.5167,23.53,23.3376,23.5599,23.6496,23.6266,23.6711,23.6755,23.708,23.4108,23.6645,23.701,23.6382,23.7354,23.701,23.6956,23.505,23.721,23.7277,23.7093,23.6551,23.6097,23.6811,23.4719,23.6517,23.6718,23.6516,23.6914,23.6489],"avgthroughpasssuccess":[19.826,19.848,19.8613,19.6996,19.8862,19.9658,19.9412,19.9821,19.9808,20.0097,19.7532,19.9719,20.0036,19.9509,20.0328,20.0007,19.999,19.8304,20.0144,20.0226,20.0055,19.9602,19.92,19.9747,19.7982,19.949,19.9675,19.9509,19.9858,19.956],"avglobbedthroughpasstry":[8.2432,8.2617,8.2787,8.2206,8.3044,8.3395,8.3348,8.3752,8.3846,8.3863,8.2933,8.3983,8.4123,8.3933,8.435,8.4376,8.4502,8.3981,8.4714,8.4897,8.4779,8.4872,8.4787,8.5146,8.4615,8.5181,8.532,8.5355,8.5514,8.5572],"avglobbedthroughpasssuccess":[4.8256,4.8319,4.8522,4.8211,4.8753,4.8952,4.8976,4.9271,4.9336,4.9406,4.8777,4.9452,4.9548,4.9406,4.9737,4.9774,4.9886,4.9553,5.0043,5.0177,5.0108,5.0231,5.019,5.041,5.0072,5.0415,5.0576,5.0515,5.06,5.0675],"avgcornerkick":[1.7936,1.7987,1.8023,1.7861,1.8063,1.815,1.8093,1.817,1.8179,1.8188,1.7937,1.8135,1.8232,1.8142,1.8242,1.8228,1.8253,1.8093,1.8269,1.8272,1.8267,1.8266,1.8275,1.8339,1.8153,1.828,1.8305,1.8261,1.8281,1.833],"avgycards":[0.0849,0.0847,0.0842,0.0831,0.083,0.0842,0.0851,0.0838,0.0844,0.0853,0.0833,0.0837,0.084,0.0846,0.0847,0.0849,0.0853,0.084,0.085,0.0845,0.0842,0.0843,0.0845,0.0857,0.0834,0.0843,0.0857,0.0852,0.0848,0.0846],"avgrcards":[0.0033,0.0031,0.0031,0.0033,0.0033,0.0032,0.0031,0.0033,0.0034,0.0033,0.0031,0.0033,0.0032,0.0033,0.0033,0.0032,0.0032,0.0033,0.0032,0.0033,0.0034,0.0033,0.0032,0.0032,0.0033,0.0032,0.0031,0.0035,0.0031,0.0034],"avginjury":[0.1447,0.1438,0.1444,0.1436,0.1443,0.1441,0.1448,0.1451,0.1459,0.1457,0.1432,0.1463,0.1467,0.1464,0.1462,0.1453,0.1466,0.1453,0.1463,0.1464,0.1465,0.1475,0.1463,0.1465,0.1455,0.1468,0.1464,0.1474,0.1472,0.1464],"avgoffsidecnt":[1.5641,1.565,1.571,1.5539,1.5712,1.5797,1.5754,1.5837,1.5867,1.589,1.5631,1.5852,1.5919,1.588,1.5901,1.5924,1.5957,1.5823,1.5964,1.5999,1.5977,1.601,1.5982,1.6059,1.5973,1.6066,1.6121,1.6099,1.6139,1.6162],"avgavgrating":[4.00066,4.00079,4.0008,4.00203,4.00035,4.00127,4.00115,4.00055,3.99983,4.00018,4.00113,3.99896,3.99926,3.99902,3.99908,3.99883,3.99876,3.99953,3.99801,3.99859,3.99878,3.99838,3.99797,3.9982,3.99856,3.99748,3.99861,3.99823,3.99703,3.99752]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
