import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    # match_type = "50" -> 공경
    data_1 = {"lengthDate":30,"date":["2025-06-01T00:00:00","2025-06-02T00:00:00","2025-06-03T00:00:00","2025-06-04T00:00:00","2025-06-05T00:00:00","2025-06-06T00:00:00","2025-06-07T00:00:00","2025-06-08T00:00:00","2025-06-09T00:00:00","2025-06-10T00:00:00","2025-06-11T00:00:00","2025-06-12T00:00:00","2025-06-13T00:00:00","2025-06-14T00:00:00","2025-06-15T00:00:00","2025-06-16T00:00:00","2025-06-17T00:00:00","2025-06-18T00:00:00","2025-06-19T00:00:00","2025-06-20T00:00:00","2025-06-21T00:00:00","2025-06-22T00:00:00","2025-06-23T00:00:00","2025-06-24T00:00:00","2025-06-25T00:00:00","2025-06-26T00:00:00","2025-06-27T00:00:00","2025-06-28T00:00:00","2025-06-29T00:00:00","2025-06-30T00:00:00"],"count":[30525,25314,32001,24833,22697,27887,26039,25709,19160,17845,18900,19555,22192,24409,24225,18475,17677,17945,15849,20020,21689,20428,17169,17532,17860,45008,50888,52594,49049,36902],"avggoaltot":[2.6931,2.6729,2.6625,2.6583,2.6577,2.6691,2.663,2.6425,2.6513,2.6527,2.6603,2.6528,2.6565,2.6869,2.6773,2.6468,2.6607,2.6635,2.6807,2.6555,2.6866,2.6643,2.6802,2.669,2.6633,2.5355,2.5448,2.5434,2.5214,2.5381],"avgshoottot":[7.1064,7.0392,7.0304,6.9999,6.9947,7.0167,7.0143,6.9998,7.018,6.978,7.0033,6.994,7.0047,7.0429,7.0333,6.9689,6.9689,6.9977,7.0117,6.955,6.9696,7.0097,6.9461,6.9042,6.9398,6.8097,6.8775,6.8722,6.869,6.8488],"avgeffshoottot":[5.4627,5.4043,5.3949,5.3903,5.3728,5.4015,5.3869,5.3686,5.3885,5.3543,5.388,5.3836,5.3772,5.4144,5.4085,5.3541,5.3747,5.3866,5.4125,5.3347,5.3834,5.4021,5.3608,5.3348,5.3477,5.1829,5.2431,5.2513,5.246,5.25],"avggoalpenaltykick":[0.0638,0.0642,0.0621,0.0614,0.0636,0.0636,0.0623,0.0612,0.0629,0.0611,0.0616,0.0625,0.0614,0.0628,0.0631,0.0624,0.0636,0.0623,0.0603,0.063,0.0639,0.0627,0.062,0.0654,0.0617,0.0578,0.059,0.0595,0.0587,0.0565],"avggoalfreekick":[0.0208,0.0207,0.0198,0.0196,0.0191,0.0211,0.0192,0.0196,0.0188,0.0198,0.02,0.0203,0.0202,0.0194,0.0182,0.0193,0.0209,0.0196,0.0177,0.0201,0.02,0.0198,0.0193,0.0193,0.0193,0.0103,0.0134,0.0152,0.0148,0.016],"avgshootinpenalty":[4.7224,4.6734,4.6497,4.6361,4.6503,4.6718,4.6594,4.6393,4.6553,4.6278,4.6304,4.6607,4.6479,4.6956,4.6808,4.642,4.6627,4.6342,4.6627,4.6363,4.659,4.6495,4.6286,4.6175,4.6198,4.2699,4.213,4.2047,4.2034,4.2157],"avggoalinpenalty":[2.1124,2.0977,2.0798,2.0872,2.0892,2.1012,2.0916,2.08,2.0811,2.0794,2.0848,2.0903,2.0886,2.1211,2.1103,2.0884,2.1022,2.0957,2.117,2.0944,2.1186,2.094,2.1111,2.0963,2.0932,1.9204,1.9031,1.8979,1.8798,1.8959],"avgshootoutpenalty":[2.2954,2.2778,2.2951,2.2773,2.2567,2.2557,2.2674,2.2751,2.2741,2.2645,2.2873,2.2464,2.2702,2.2598,2.2631,2.2381,2.2183,2.2773,2.2648,2.2292,2.2222,2.2727,2.2314,2.1965,2.2344,2.4585,2.5819,2.5832,2.582,2.5512],"avggoaloutpenalty":[0.517,0.5111,0.5206,0.5097,0.505,0.5042,0.5091,0.5013,0.5072,0.5122,0.5139,0.5,0.5065,0.503,0.5039,0.496,0.4949,0.5055,0.5034,0.4981,0.5042,0.5076,0.507,0.5073,0.5085,0.5573,0.5828,0.586,0.5829,0.5857],"middleshoot":[22.5221,22.4359,22.6835,22.3833,22.3754,22.3547,22.4527,22.034,22.3051,22.619,22.4678,22.2566,22.3117,22.2575,22.2663,22.1599,22.3092,22.1975,22.2269,22.3459,22.6901,22.3346,22.7229,23.0949,22.7568,22.6688,22.5736,22.6849,22.5752,22.957],"outpenaltygoalratio":[19.1972,19.1216,19.5531,19.1739,19.0014,18.8903,19.1175,18.9707,19.1302,19.3086,19.3174,18.848,19.0664,18.7205,18.8212,18.7396,18.6004,18.9788,18.7787,18.7573,18.7672,19.0519,18.9165,19.0071,19.0929,21.9799,22.9016,23.04,23.1181,23.0763],"avggoalheading":[0.3179,0.3093,0.3042,0.3135,0.3087,0.312,0.3073,0.3152,0.3193,0.3104,0.31,0.309,0.314,0.3155,0.3208,0.3076,0.3141,0.3156,0.3199,0.3086,0.3139,0.3057,0.3176,0.3113,0.3132,0.2252,0.2072,0.2,0.1949,0.1872],"goalheadingratio":[11.8036,11.5736,11.4254,11.793,11.6147,11.6908,11.5407,11.9287,12.0438,11.701,11.6512,11.6473,11.8205,11.7413,11.9837,11.6223,11.806,11.8477,11.9334,11.6204,11.6828,11.4727,11.8516,11.6636,11.7589,8.8803,8.1433,7.8648,7.7287,7.3751],"avgpasstry":[105.014,105.21,105.568,105.281,104.41,105.151,105.526,105.312,105.677,105.29,105.82,104.502,104.954,105.319,105.832,105.938,105.509,105.86,104.266,104.733,105.02,106.047,105.478,105.362,105.626,105.408,105.96,106.297,107.155,107.107],"avgpasssuccess":[95.1733,95.3906,95.7814,95.5715,94.6944,95.3281,95.6555,95.4842,95.8644,95.5123,96.0411,94.7262,95.0914,95.4489,95.9464,96.11,95.6868,96.0097,94.5974,94.9453,95.1806,96.1925,95.7558,95.6729,95.8913,94.9095,95.6689,96.0928,97.0134,97.0271],"passsuccessratio":[90.6288,90.6669,90.7292,90.7779,90.6945,90.6584,90.6467,90.668,90.7147,90.7135,90.7594,90.645,90.6025,90.6283,90.6594,90.7225,90.6907,90.6947,90.7267,90.6546,90.6308,90.7075,90.7827,90.8044,90.7842,90.0404,90.2874,90.4005,90.5352,90.5888],"avgowngoal":[0.0174,0.0176,0.0168,0.0175,0.0187,0.0167,0.018,0.0168,0.0181,0.018,0.0158,0.0194,0.019,0.0174,0.0183,0.0167,0.0183,0.017,0.0192,0.0172,0.0187,0.0183,0.019,0.0181,0.0169,0.0135,0.0127,0.0127,0.0135,0.0129],"avgpossession":[50.645,50.6142,50.6095,50.5672,50.6287,50.5343,50.5522,50.475,50.5166,50.4466,50.409,50.5497,50.5645,50.5484,50.5114,50.4753,50.4403,50.4733,50.5748,50.5064,50.4692,50.4341,50.4983,50.5218,50.4274,50.6974,50.6707,50.6919,50.7268,50.7132],"avgdribble":[72.5713,72.6457,72.8248,72.7618,72.1883,72.6088,72.7204,72.6433,72.8379,72.6835,73.1331,72.1356,72.2628,72.6331,72.8969,73.0098,72.8007,72.9317,72.4278,72.4279,72.7422,73.2039,72.8333,72.8681,73.1503,73.1475,74.1601,74.6129,75.2178,75.2086],"avgtacklesuccess":[6.1187,6.0945,6.0724,6.0745,6.1397,6.1551,6.1264,6.0505,6.1262,6.0997,6.1989,6.1748,6.2011,6.1646,6.0971,6.1242,6.117,6.1512,6.1494,6.1744,6.1907,6.1562,6.0967,6.1018,6.0773,6.4369,6.5024,6.4121,6.3908,6.4333],"avgtackletry":[11.5102,11.4811,11.4301,11.4572,11.562,11.6178,11.5715,11.4184,11.5441,11.4753,11.6727,11.6096,11.625,11.5859,11.5021,11.5258,11.5743,11.5617,11.5827,11.5828,11.5929,11.5766,11.4795,11.5342,11.4769,12.0273,12.2412,12.1038,12.1056,12.2151],"avgblocksuccess":[0.6195,0.615,0.6164,0.624,0.6207,0.614,0.6289,0.6312,0.6231,0.6266,0.6287,0.6172,0.6253,0.6135,0.6255,0.6227,0.6178,0.6295,0.6177,0.626,0.6174,0.628,0.6174,0.6146,0.6239,0.6558,0.6754,0.6801,0.6856,0.6756],"avgblocktry":[8.3255,8.2746,8.2986,8.2395,8.2681,8.2783,8.3102,8.3501,8.3016,8.3011,8.3415,8.2966,8.2744,8.337,8.3626,8.3294,8.2747,8.3978,8.2922,8.3227,8.3315,8.3973,8.3106,8.2856,8.3341,8.676,8.8252,8.8496,8.8854,8.8599],"avgfoul":[0.7162,0.711,0.7075,0.7104,0.7152,0.7085,0.7091,0.7013,0.7137,0.7022,0.7159,0.7266,0.717,0.7144,0.7173,0.712,0.716,0.7164,0.7093,0.7256,0.7128,0.7181,0.7109,0.7041,0.7117,0.6849,0.6862,0.6783,0.6768,0.6702],"avgshootfreekick":[0.1959,0.2056,0.2014,0.1992,0.2042,0.2004,0.2011,0.2027,0.2035,0.2025,0.2033,0.2076,0.2085,0.2076,0.2017,0.2018,0.2058,0.2052,0.2027,0.2049,0.1967,0.2027,0.2018,0.1936,0.2004,0.1777,0.1737,0.1777,0.1752,0.1712],"avgshootpenaltykick":[0.0815,0.0817,0.0793,0.08,0.081,0.0819,0.0804,0.0782,0.0819,0.0782,0.0784,0.0798,0.0797,0.0803,0.0824,0.0812,0.0813,0.0792,0.078,0.0815,0.0816,0.0802,0.0793,0.0828,0.0786,0.0749,0.0762,0.0777,0.0772,0.0747],"avgshootheading":[1.0184,0.9936,0.9852,0.9997,0.9786,0.9968,0.9819,1.0137,1.0143,0.9992,0.9869,0.9903,0.9835,1.0012,1.0134,0.9899,0.997,0.9914,0.9947,0.9772,0.9859,0.9784,0.9985,0.9811,0.9761,0.7054,0.6647,0.6419,0.6189,0.6033],"avgshortpasstry":[75.7022,75.9351,76.3988,76.1873,75.2587,75.8793,76.1088,75.8894,76.3951,76.0558,76.5201,75.1574,75.4017,75.8058,76.2443,76.3913,76.0099,76.4369,75.0831,75.3064,75.4987,76.6002,76.3343,76.2194,76.4326,75.0796,75.7855,76.2626,77.2188,77.1492],"avgshortpasssuccess":[72.0776,72.3386,72.7863,72.5968,71.6975,72.2548,72.4902,72.3083,72.8107,72.4592,72.898,71.5744,71.7714,72.1615,72.615,72.7829,72.4049,72.8006,71.5223,71.6859,71.8499,72.9504,72.7454,72.616,72.8175,71.2901,72.0004,72.4973,73.4283,73.3627],"avglobpasstry":[4.8845,4.8973,4.8936,4.8965,4.8463,4.8546,4.8484,4.9719,4.9288,4.9098,4.8707,4.8848,4.8681,4.8687,4.9108,4.8428,4.8928,4.8649,4.779,4.7441,4.7222,4.7997,4.8268,4.7705,4.8001,4.3742,4.0278,3.9157,3.7837,3.7279],"avglobpasssuccess":[2.7888,2.7978,2.8098,2.8072,2.7852,2.7787,2.768,2.8406,2.813,2.8098,2.8128,2.816,2.8005,2.7891,2.8071,2.7848,2.8149,2.7755,2.754,2.726,2.7146,2.7444,2.7859,2.7517,2.769,2.1334,2.0417,2.0075,1.9649,1.9507],"avgdrivengroundpasstry":[4.0496,4.2097,4.1447,4.1473,4.293,4.1405,4.1572,4.2335,4.2647,4.2856,4.2791,4.3452,4.2216,4.2637,4.3,4.3362,4.3362,4.3044,4.3178,4.3327,4.2322,4.2321,4.1164,4.1572,4.1795,3.8165,4.144,4.1934,4.4185,4.554],"avgdrivengroundpasssuccess":[3.5201,3.673,3.6092,3.6241,3.7505,3.605,3.6224,3.6969,3.7215,3.732,3.7395,3.7969,3.6723,3.7182,3.7505,3.7836,3.779,3.7603,3.7752,3.7794,3.6804,3.6889,3.5829,3.6243,3.6424,3.3076,3.5974,3.638,3.8324,3.9497],"avgthroughpasstry":[19.1318,18.9128,18.8887,18.8165,18.7602,19.0099,19.1554,18.952,18.8228,18.799,18.8983,18.8648,19.1999,19.1096,19.1097,19.0864,18.9979,18.9868,18.8322,19.0816,19.3064,19.1489,18.9524,18.9611,18.9765,20.4679,20.2079,20.1262,19.9874,19.942],"avgthroughpasssuccess":[16.5165,16.3073,16.3121,16.2788,16.1968,16.4157,16.5111,16.3587,16.2427,16.2485,16.3264,16.2747,16.5783,16.5051,16.4954,16.4754,16.4104,16.4049,16.2752,16.4781,16.6641,16.5422,16.3689,16.4114,16.3993,17.718,17.5096,17.4285,17.2966,17.2776],"avglobbedthroughpasstry":[0.2301,0.2327,0.2252,0.2198,0.2245,0.2359,0.2329,0.2423,0.2391,0.2243,0.2207,0.2276,0.2346,0.2368,0.237,0.2423,0.2368,0.2304,0.2247,0.2317,0.2274,0.2311,0.2302,0.2188,0.2185,0.6119,0.7003,0.6943,0.6351,0.6083],"avglobbedthroughpasssuccess":[0.15,0.1515,0.1451,0.1431,0.1429,0.1526,0.1509,0.158,0.1559,0.1452,0.1433,0.1452,0.1513,0.1519,0.1552,0.1578,0.1538,0.1494,0.1461,0.1521,0.1473,0.1484,0.15,0.1425,0.1419,0.3606,0.4147,0.4109,0.3792,0.3674],"avgcornerkick":[1.7884,1.7795,1.7826,1.7722,1.7637,1.7782,1.7672,1.7844,1.7888,1.7829,1.7746,1.7746,1.7751,1.7852,1.7935,1.7629,1.779,1.7781,1.7838,1.7487,1.7589,1.7876,1.7628,1.7475,1.761,1.7727,1.8135,1.823,1.8259,1.8223],"avgycards":[0.0456,0.0439,0.0432,0.0429,0.0423,0.0414,0.046,0.0425,0.0417,0.0426,0.0411,0.0465,0.0429,0.0437,0.0464,0.0454,0.0433,0.0416,0.0437,0.0466,0.0442,0.042,0.0459,0.042,0.0428,0.0479,0.0455,0.0448,0.0459,0.0443],"avgrcards":[0.0073,0.0068,0.0071,0.0074,0.0074,0.0076,0.0074,0.0081,0.0068,0.006,0.0072,0.0069,0.0079,0.0066,0.0076,0.0071,0.0071,0.0066,0.0068,0.0071,0.0067,0.0065,0.0069,0.0068,0.0083,0.0068,0.0074,0.0073,0.0071,0.0075],"avginjury":[0.1157,0.1189,0.1165,0.1149,0.1137,0.1159,0.1207,0.1152,0.1202,0.1151,0.1163,0.1151,0.1207,0.117,0.1158,0.1138,0.1177,0.1184,0.1209,0.1173,0.1169,0.1148,0.1133,0.1159,0.1135,0.1271,0.1246,0.1243,0.1241,0.1196],"avgoffsidecnt":[0.4974,0.4963,0.4976,0.4991,0.487,0.497,0.5027,0.495,0.4932,0.4983,0.4923,0.5,0.5035,0.5088,0.5021,0.5026,0.5006,0.4983,0.5008,0.5055,0.4979,0.497,0.4996,0.4951,0.5041,0.43,0.4235,0.4152,0.4204,0.4186],"avgavgrating":[4.19346,4.18933,4.19064,4.18443,4.18278,4.1872,4.18614,4.1839,4.18156,4.18165,4.18179,4.17658,4.1835,4.18914,4.1883,4.18592,4.18051,4.18168,4.17817,4.17888,4.18251,4.17818,4.17959,4.1809,4.17575,4.20975,4.19945,4.19662,4.18829,4.18807]}

    # match_type = "52" ->  감모
    data_2 = {"lengthDate":30,"date":["2025-06-01T00:00:00","2025-06-02T00:00:00","2025-06-03T00:00:00","2025-06-04T00:00:00","2025-06-05T00:00:00","2025-06-06T00:00:00","2025-06-07T00:00:00","2025-06-08T00:00:00","2025-06-09T00:00:00","2025-06-10T00:00:00","2025-06-11T00:00:00","2025-06-12T00:00:00","2025-06-13T00:00:00","2025-06-14T00:00:00","2025-06-15T00:00:00","2025-06-16T00:00:00","2025-06-17T00:00:00","2025-06-18T00:00:00","2025-06-19T00:00:00","2025-06-20T00:00:00","2025-06-21T00:00:00","2025-06-22T00:00:00","2025-06-23T00:00:00","2025-06-24T00:00:00","2025-06-25T00:00:00","2025-06-26T00:00:00","2025-06-27T00:00:00","2025-06-28T00:00:00","2025-06-29T00:00:00","2025-06-30T00:00:00"],"count":[251074,264341,265647,269258,168417,264762,263315,259520,268354,263779,265668,175973,267945,265632,258418,267235,266944,261487,128047,252554,247939,242874,258744,256670,252125,163732,329881,316840,303048,299751],"avggoaltot":[1.4317,1.4312,1.4269,1.4291,1.4155,1.4259,1.4305,1.426,1.428,1.4245,1.4298,1.4146,1.4257,1.4276,1.4267,1.4291,1.4236,1.4222,1.4039,1.4177,1.4213,1.4216,1.4248,1.423,1.4286,1.5823,1.51,1.5101,1.5182,1.5246],"avgshoottot":[4.7447,4.7559,4.749,4.7522,4.6983,4.7438,4.7521,4.7459,4.7533,4.7429,4.758,4.6954,4.7482,4.751,4.7475,4.7517,4.7444,4.7413,4.6567,4.7374,4.7483,4.7309,4.7502,4.7375,4.751,4.7494,4.7511,4.7917,4.8381,4.8779],"avgeffshoottot":[3.7068,3.7123,3.7055,3.7087,3.6686,3.7031,3.7121,3.705,3.7083,3.7024,3.7144,3.6685,3.7054,3.7091,3.706,3.7085,3.7026,3.7009,3.6407,3.696,3.7051,3.693,3.7071,3.6964,3.708,3.7597,3.7387,3.7697,3.8024,3.8348],"avggoalpenaltykick":[0.0266,0.0264,0.0258,0.0265,0.0261,0.0265,0.0268,0.0266,0.0265,0.0267,0.0268,0.0263,0.0269,0.0265,0.0266,0.0266,0.0265,0.0265,0.026,0.0267,0.0264,0.0265,0.0261,0.0266,0.0263,0.0274,0.0266,0.0271,0.0273,0.0276],"avggoalfreekick":[0.0033,0.0033,0.0035,0.0034,0.0035,0.0033,0.0035,0.0034,0.0035,0.0034,0.0033,0.0034,0.0035,0.0034,0.0034,0.0034,0.0035,0.0034,0.0031,0.0037,0.0035,0.0034,0.0035,0.0035,0.0034,0.0065,0.0065,0.0064,0.0064,0.0065],"avgshootinpenalty":[2.9432,2.9452,2.9441,2.9472,2.9144,2.9379,2.9479,2.9443,2.945,2.939,2.9489,2.9138,2.9422,2.9428,2.9387,2.9423,2.9389,2.9372,2.8906,2.9312,2.9411,2.9297,2.9376,2.9307,2.9413,2.9874,2.9464,2.9611,2.9924,3.0176],"avggoalinpenalty":[1.0795,1.0784,1.0754,1.0777,1.0672,1.0734,1.079,1.0749,1.0762,1.0738,1.0776,1.0672,1.0736,1.0763,1.074,1.0759,1.0722,1.0719,1.0593,1.0667,1.0698,1.0703,1.0732,1.0708,1.075,1.1743,1.113,1.1115,1.1178,1.1229],"avgshootoutpenalty":[1.7653,1.7746,1.7694,1.7686,1.7483,1.7698,1.7675,1.7652,1.7719,1.7672,1.7726,1.7458,1.7692,1.7718,1.7726,1.7731,1.7694,1.7678,1.7305,1.77,1.7707,1.7653,1.7769,1.7706,1.7735,1.7239,1.7668,1.792,1.8067,1.8212],"avggoaloutpenalty":[0.3256,0.3265,0.3257,0.325,0.3221,0.326,0.3247,0.3245,0.3254,0.324,0.3254,0.3211,0.3253,0.3248,0.326,0.3266,0.325,0.3238,0.3186,0.3243,0.3251,0.3248,0.3255,0.3256,0.3273,0.3806,0.3704,0.3715,0.373,0.3741],"middleshoot":[18.4441,18.3973,18.4052,18.3738,18.4257,18.4184,18.3695,18.3843,18.362,18.3345,18.3589,18.3901,18.3873,18.3302,18.3927,18.421,18.3669,18.3148,18.4089,18.3244,18.3585,18.401,18.3203,18.3906,18.4534,22.0795,20.9662,20.7328,20.6462,20.5413],"outpenaltygoalratio":[22.7422,22.813,22.8257,22.7416,22.7552,22.8628,22.6984,22.756,22.7871,22.7448,22.7584,22.699,22.8169,22.7515,22.8499,22.8535,22.8294,22.7675,22.6939,22.8751,22.8734,22.8475,22.8453,22.8812,22.9105,24.0536,24.5298,24.601,24.5686,24.5376],"avggoalheading":[0.1741,0.1745,0.1738,0.1737,0.172,0.1737,0.1745,0.1736,0.1736,0.1739,0.1748,0.1725,0.1748,0.1738,0.1744,0.1749,0.1734,0.1739,0.1718,0.1738,0.1735,0.1734,0.1746,0.1741,0.1745,0.172,0.1594,0.1595,0.1603,0.1607],"goalheadingratio":[12.1596,12.1954,12.1831,12.1577,12.1524,12.1834,12.2004,12.1733,12.159,12.2064,12.2244,12.196,12.2569,12.1759,12.2265,12.2384,12.1813,12.2293,12.2408,12.2562,12.2064,12.1995,12.2559,12.2355,12.2172,10.8684,10.5559,10.5606,10.5557,10.5425],"avgpasstry":[109.326,109.613,109.666,109.719,108.534,109.467,109.705,109.361,109.73,109.479,109.621,108.329,109.581,109.709,109.499,109.53,109.603,109.633,107.617,109.423,109.88,109.411,109.986,109.544,109.697,99.1817,99.1331,100.414,101.467,102.232],"avgpasssuccess":[94.8448,95.073,95.1448,95.1816,94.1766,94.9674,95.1764,94.8431,95.1763,94.9556,95.0657,93.9339,95.0401,95.1665,94.9754,94.994,95.0932,95.1125,93.3348,94.9312,95.3343,94.9325,95.4553,95.0415,95.1653,85.8307,85.7377,86.8624,87.7439,88.3621],"passsuccessratio":[86.754,86.7352,86.7587,86.7502,86.7712,86.7546,86.7563,86.7246,86.7367,86.734,86.7223,86.7113,86.7306,86.7446,86.7366,86.7284,86.7619,86.7549,86.7288,86.7558,86.762,86.7665,86.7883,86.7613,86.7532,86.5389,86.4875,86.5043,86.4753,86.4329],"avgowngoal":[0.0071,0.0073,0.0074,0.0073,0.007,0.0074,0.0073,0.0071,0.0073,0.0074,0.0071,0.0073,0.0071,0.0073,0.0072,0.0073,0.0073,0.0071,0.0071,0.0072,0.0072,0.0075,0.0073,0.0072,0.0074,0.0061,0.0062,0.0065,0.0066,0.0065],"avgpossession":[49.9642,49.9696,49.9714,49.9735,49.9675,49.9722,49.9703,49.979,49.9809,49.9769,49.98,49.9802,49.9837,49.9859,49.9838,49.9816,49.9926,49.9871,49.9946,49.9906,49.989,49.9828,49.9979,49.9911,49.9934,49.5652,49.7629,49.8128,49.8375,49.8434],"avgdribble":[85.2433,85.4752,85.5441,85.5439,84.497,85.383,85.5861,85.3041,85.5853,85.4076,85.5075,84.4056,85.4982,85.6181,85.443,85.4643,85.5338,85.5435,83.7652,85.4025,85.7473,85.36,85.8212,85.4631,85.5699,76.4254,76.7171,77.8612,78.7588,79.3971],"avgtacklesuccess":[5.6707,5.6839,5.6851,5.6816,5.6136,5.674,5.6875,5.6799,5.6942,5.6832,5.6945,5.646,5.6958,5.692,5.6846,5.6876,5.6804,5.6764,5.5935,5.6638,5.6776,5.6578,5.6844,5.6685,5.6798,5.2807,5.2916,5.339,5.3835,5.4377],"avgtackletry":[8.3669,8.3831,8.3857,8.3881,8.2874,8.3704,8.3964,8.3851,8.4065,8.3889,8.4001,8.3253,8.3995,8.3981,8.3909,8.3918,8.3808,8.3801,8.2518,8.3614,8.3822,8.3536,8.3858,8.3664,8.3819,7.8272,7.8556,7.9174,7.9873,8.0637],"avgblocksuccess":[0.4382,0.4391,0.4403,0.4397,0.435,0.4401,0.4408,0.4395,0.4413,0.4399,0.4416,0.4352,0.4397,0.4419,0.4421,0.4418,0.4409,0.4396,0.4307,0.4411,0.442,0.4411,0.4417,0.4401,0.4424,0.4456,0.4512,0.4564,0.4632,0.4687],"avgblocktry":[7.1625,7.1888,7.1807,7.1816,7.0999,7.1725,7.1879,7.1715,7.202,7.1825,7.187,7.1045,7.1948,7.1895,7.187,7.195,7.1787,7.1769,7.0481,7.1784,7.1898,7.1696,7.1905,7.1708,7.1826,6.838,6.9103,6.9887,7.0722,7.1361],"avgfoul":[0.8212,0.8206,0.8225,0.8226,0.8146,0.8196,0.8221,0.8221,0.8226,0.8219,0.8246,0.8161,0.8243,0.8237,0.8248,0.8245,0.8205,0.8208,0.81,0.8204,0.8217,0.821,0.8207,0.8191,0.8212,0.7311,0.7448,0.7536,0.7586,0.7671],"avgshootfreekick":[0.0901,0.0895,0.0902,0.0906,0.089,0.0901,0.0899,0.09,0.0901,0.0896,0.0902,0.089,0.0903,0.0902,0.0903,0.0897,0.0894,0.0901,0.0878,0.0903,0.0899,0.0894,0.0903,0.09,0.0901,0.0825,0.0827,0.0837,0.0839,0.0853],"avgshootpenaltykick":[0.0341,0.0338,0.0333,0.0343,0.0336,0.0339,0.0344,0.0342,0.0343,0.0345,0.0344,0.0337,0.0346,0.0343,0.0343,0.0342,0.034,0.0341,0.0335,0.0342,0.0342,0.0338,0.0336,0.0341,0.0341,0.0357,0.0355,0.0361,0.0365,0.0367],"avgshootheading":[0.893,0.8962,0.897,0.8949,0.884,0.8963,0.8963,0.8967,0.8971,0.895,0.8976,0.8862,0.8977,0.896,0.8947,0.8972,0.8938,0.8965,0.8804,0.8948,0.8978,0.8902,0.8955,0.8934,0.8964,0.8826,0.8854,0.8912,0.9009,0.9061],"avgshortpasstry":[64.6948,64.8428,64.917,64.9656,64.2998,64.8001,64.9511,64.6671,64.9072,64.7707,64.8171,64.0559,64.816,64.9237,64.7859,64.7849,64.8891,64.9144,63.6864,64.7854,65.0737,64.8244,65.2118,64.8962,64.9594,57.4691,57.3747,58.2005,58.7367,59.0672],"avgshortpasssuccess":[62.8334,62.9765,63.0539,63.0953,62.4586,62.9401,63.0895,62.8061,63.0399,62.9058,62.953,62.2129,62.9479,63.0585,62.924,62.9216,63.0267,63.0515,61.8578,62.9255,63.2071,62.9649,63.3431,63.0343,63.0935,55.8925,55.8151,56.6231,57.1472,57.464],"avglobpasstry":[6.6508,6.6851,6.6803,6.6755,6.5929,6.6674,6.6798,6.68,6.6838,6.6737,6.6883,6.5955,6.6772,6.6777,6.666,6.6753,6.6587,6.6673,6.5308,6.6609,6.6783,6.6454,6.6657,6.6542,6.6771,6.6039,6.7106,6.7877,6.8745,6.9462],"avglobpasssuccess":[2.1306,2.1415,2.142,2.137,2.1103,2.1343,2.1393,2.1348,2.1385,2.1375,2.14,2.1071,2.1381,2.1391,2.1332,2.1344,2.1317,2.1344,2.0865,2.1297,2.1388,2.128,2.1343,2.1292,2.1371,2.13,2.1433,2.1584,2.1825,2.1994],"avgdrivengroundpasstry":[4.7535,4.7654,4.7683,4.7646,4.7205,4.7654,4.775,4.7574,4.7688,4.7709,4.774,4.7155,4.7688,4.7785,4.7602,4.7714,4.7731,4.7757,4.6879,4.7716,4.7829,4.7552,4.7812,4.7636,4.7682,4.1889,4.1826,4.2486,4.308,4.3564],"avgdrivengroundpasssuccess":[4.5991,4.6101,4.6131,4.6098,4.5683,4.6099,4.6192,4.6022,4.6138,4.6161,4.6183,4.5619,4.6134,4.6239,4.6054,4.6165,4.6185,4.6211,4.5333,4.6176,4.6276,4.6007,4.6247,4.6078,4.6127,4.0581,4.0542,4.1194,4.1772,4.2248],"avgthroughpasstry":[23.6134,23.6762,23.6694,23.6673,23.3801,23.6018,23.6532,23.6217,23.6997,23.6155,23.6676,23.414,23.6597,23.6685,23.6385,23.6447,23.6373,23.6029,23.2152,23.5613,23.6548,23.5455,23.6411,23.5615,23.602,21.9359,21.8769,22.0571,22.2889,22.4905],"avgthroughpasssuccess":[19.9048,19.9535,19.9505,19.9413,19.7045,19.8941,19.9326,19.9068,19.9752,19.8999,19.9412,19.7173,19.9381,19.9429,19.9168,19.9243,19.9207,19.8895,19.5538,19.8583,19.935,19.837,19.923,19.8532,19.8882,18.5814,18.5403,18.7001,18.897,19.0658],"avglobbedthroughpasstry":[8.7527,8.7805,8.7697,8.7836,8.686,8.7704,8.7835,8.7723,8.8054,8.7857,8.8077,8.6934,8.7948,8.7987,8.7847,8.7894,8.782,8.812,8.6454,8.7842,8.8259,8.7808,8.822,8.8047,8.8277,8.1207,8.1187,8.2463,8.3731,8.4796],"avglobbedthroughpasssuccess":[5.2053,5.2212,5.216,5.2273,5.1653,5.2187,5.224,5.2223,5.2377,5.2257,5.2431,5.167,5.2326,5.2326,5.2252,5.2274,5.2253,5.247,5.1354,5.2316,5.2548,5.2324,5.2599,5.248,5.263,4.982,5.0007,5.0762,5.1535,5.2197],"avgcornerkick":[1.8482,1.8567,1.8524,1.8561,1.8291,1.852,1.8556,1.8564,1.8558,1.8541,1.8615,1.8312,1.8564,1.8568,1.8529,1.8583,1.8535,1.8505,1.8195,1.855,1.8585,1.8448,1.8535,1.8503,1.857,1.8247,1.8703,1.896,1.9155,1.9405],"avgycards":[0.0849,0.0848,0.0858,0.0855,0.0845,0.0852,0.0849,0.085,0.0854,0.085,0.0853,0.0844,0.0852,0.0859,0.0852,0.0856,0.0848,0.0851,0.0842,0.085,0.0856,0.0858,0.0846,0.0843,0.0841,0.0678,0.0667,0.0675,0.0677,0.0685],"avgrcards":[0.0034,0.0033,0.0033,0.0034,0.0033,0.0034,0.0034,0.0034,0.0033,0.0034,0.0034,0.0034,0.0034,0.0034,0.0034,0.0034,0.0034,0.0035,0.0033,0.0033,0.0034,0.0033,0.0035,0.0032,0.0033,0.0028,0.0028,0.0029,0.0029,0.0028],"avginjury":[0.1486,0.1497,0.1492,0.1482,0.1466,0.1478,0.1488,0.1493,0.1492,0.1489,0.1492,0.1476,0.1488,0.1484,0.1483,0.1494,0.1487,0.1493,0.1465,0.1486,0.1487,0.1499,0.1495,0.1486,0.149,0.1408,0.1418,0.1444,0.1459,0.1465],"avgoffsidecnt":[1.6536,1.6585,1.6575,1.6603,1.6376,1.6544,1.6629,1.6571,1.6629,1.6583,1.6665,1.6431,1.6597,1.6606,1.6605,1.658,1.6591,1.6631,1.6342,1.6574,1.6624,1.6511,1.6545,1.6548,1.658,1.2061,1.1594,1.1762,1.1884,1.2022],"avgavgrating":[4.00071,4.00051,4.00007,3.99987,4.00009,3.99964,3.99938,3.99968,3.99884,3.99861,3.99904,3.99796,3.99812,3.99838,3.99835,3.9973,3.99738,3.99733,3.99704,3.99699,3.99724,3.99711,3.99699,3.99676,3.99834,4.05316,4.03144,4.02698,4.02601,4.02525]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
