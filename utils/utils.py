import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    # match_type = "50" -> 공경
    data_1 = {"lengthDate":30,"date":["2024-12-25T00:00:00","2024-12-26T00:00:00","2024-12-27T00:00:00","2024-12-28T00:00:00","2024-12-29T00:00:00","2024-12-30T00:00:00","2024-12-31T00:00:00","2025-01-01T00:00:00","2025-01-02T00:00:00","2025-01-03T00:00:00","2025-01-04T00:00:00","2025-01-05T00:00:00","2025-01-06T00:00:00","2025-01-07T00:00:00","2025-01-08T00:00:00","2025-01-09T00:00:00","2025-01-10T00:00:00","2025-01-11T00:00:00","2025-01-12T00:00:00","2025-01-13T00:00:00","2025-01-14T00:00:00","2025-01-15T00:00:00","2025-01-16T00:00:00","2025-01-17T00:00:00","2025-01-18T00:00:00","2025-01-19T00:00:00","2025-01-20T00:00:00","2025-01-21T00:00:00","2025-01-22T00:00:00","2025-01-23T00:00:00"],"count":[26946,21756,22484,25955,29206,23445,23635,27163,21291,22748,28138,26316,20886,22977,22811,20417,21300,24895,24000,19305,19217,19575,41239,45906,43374,44884,35938,34159,33672,31147],"avggoaltot":[2.6081,2.5974,2.6072,2.6303,2.6206,2.5904,2.5992,2.603,2.6182,2.6061,2.6264,2.6116,2.6248,2.5885,2.602,2.6068,2.5785,2.5844,2.5788,2.5753,2.5717,2.5633,2.6461,2.6843,2.6675,2.6698,2.6647,2.6598,2.6404,2.6484],"avgshoottot":[6.9124,6.8645,6.9209,6.9775,6.9737,6.9231,6.9411,6.9521,6.9629,6.9714,7.0226,7.0195,6.9735,6.9299,6.986,6.9687,6.886,6.9146,6.9314,6.9166,6.8729,6.8651,7.2364,7.2256,7.1842,7.1966,7.1863,7.15,7.0984,7.0831],"avgeffshoottot":[5.2674,5.2417,5.2816,5.3246,5.3249,5.2722,5.2864,5.2987,5.3126,5.3116,5.363,5.3562,5.3317,5.2745,5.3235,5.3172,5.2512,5.2807,5.288,5.2784,5.2559,5.2538,5.4814,5.4947,5.4716,5.4918,5.4754,5.459,5.4203,5.4098],"avggoalpenaltykick":[0.064,0.0618,0.062,0.0626,0.0641,0.0624,0.0634,0.0615,0.0624,0.0633,0.0625,0.0616,0.0607,0.0611,0.0614,0.0646,0.0628,0.0641,0.0619,0.0652,0.0626,0.0609,0.0639,0.0653,0.0638,0.0636,0.0621,0.0629,0.0612,0.0626],"avggoalfreekick":[0.0191,0.018,0.0178,0.0186,0.0193,0.0173,0.0191,0.0176,0.0201,0.0181,0.019,0.0193,0.0167,0.0203,0.0187,0.0184,0.0178,0.0184,0.0191,0.0177,0.0188,0.0172,0.0182,0.019,0.0175,0.0185,0.0179,0.0186,0.0183,0.0188],"avgshootinpenalty":[4.6458,4.6504,4.693,4.7066,4.6961,4.6588,4.6682,4.6698,4.6971,4.6739,4.7133,4.6862,4.7038,4.6481,4.7137,4.6809,4.6357,4.6458,4.6405,4.6285,4.6172,4.601,4.8658,4.8392,4.8211,4.7819,4.7749,4.7623,4.7192,4.7355],"avggoalinpenalty":[2.0596,2.0643,2.0802,2.0881,2.0745,2.0534,2.0643,2.0561,2.0768,2.0543,2.0711,2.0539,2.0844,2.0479,2.0658,2.0608,2.0429,2.0413,2.0367,2.0367,2.0364,2.0293,2.0829,2.1085,2.1008,2.0915,2.0924,2.0896,2.0732,2.0867],"avgshootoutpenalty":[2.1773,2.1281,2.142,2.1814,2.1873,2.1776,2.184,2.1961,2.1781,2.2084,2.2207,2.247,2.1836,2.1955,2.1862,2.1981,2.1607,2.1801,2.205,2.1968,2.1683,2.1791,2.2793,2.2941,2.2739,2.325,2.3248,2.3,2.293,2.2586],"avggoaloutpenalty":[0.4845,0.4712,0.465,0.4796,0.482,0.4746,0.4715,0.4853,0.479,0.4885,0.4928,0.496,0.4797,0.4795,0.4748,0.4814,0.4728,0.4791,0.4802,0.4734,0.4727,0.4731,0.4992,0.5105,0.5029,0.5147,0.5102,0.5074,0.506,0.4991],"middleshoot":[22.2508,22.143,21.7069,21.9862,22.0386,21.7954,21.5904,22.1008,21.9918,22.1192,22.1898,22.0758,21.9691,21.8404,21.7188,21.9001,21.8825,21.9742,21.7771,21.5488,21.7999,21.7098,21.9019,22.2523,22.1157,22.1381,21.9483,22.0608,22.0653,22.0969],"outpenaltygoalratio":[18.5767,18.1412,17.8352,18.2337,18.3927,18.3215,18.1402,18.6439,18.295,18.7445,18.7633,18.9922,18.2757,18.5242,18.2475,18.4671,18.3362,18.5382,18.6211,18.3823,18.3808,18.4567,18.8655,19.018,18.8529,19.2786,19.1466,19.0766,19.1638,18.8453],"avggoalheading":[0.2713,0.279,0.2799,0.2794,0.2844,0.2842,0.2721,0.2804,0.2804,0.2858,0.2789,0.2812,0.2847,0.2774,0.2889,0.2917,0.2864,0.2875,0.2812,0.2817,0.2839,0.2899,0.2693,0.2732,0.2811,0.2794,0.2845,0.2838,0.2858,0.2849],"goalheadingratio":[10.4002,10.7402,10.7345,10.6228,10.8507,10.9695,10.4676,10.7704,10.7103,10.9658,10.6188,10.7662,10.8472,10.7163,11.1043,11.19,11.1054,11.1229,10.9053,10.9388,11.0381,11.3089,10.1777,10.1766,10.5392,10.4638,10.6767,10.6715,10.8226,10.7578],"avgpasstry":[104.748,104.676,104.764,104.828,104.661,104.974,104.41,105.068,105.114,105.174,105.852,106.17,105.362,104.93,104.811,104.717,104.843,105.475,105.565,105.321,105.336,105.397,102.043,102.936,103.204,103.834,103.471,103.587,103.477,103.526],"avgpasssuccess":[94.7701,94.5611,94.6529,94.6662,94.6032,94.9408,94.3569,94.995,94.949,95.0089,95.6198,95.9613,95.1985,94.8473,94.6847,94.7324,94.8651,95.4068,95.4813,95.2988,95.2988,95.3757,91.6221,92.6768,92.9623,93.699,93.3595,93.5291,93.4673,93.4957],"passsuccessratio":[90.4746,90.3367,90.3483,90.3065,90.3905,90.4422,90.3715,90.4125,90.3296,90.3349,90.3334,90.3845,90.3541,90.3909,90.3387,90.4648,90.4828,90.4545,90.4477,90.4839,90.4711,90.4918,89.7877,90.0336,90.0762,90.2395,90.2273,90.2902,90.3269,90.3117],"avgowngoal":[0.0179,0.0178,0.0171,0.0179,0.0171,0.0175,0.0184,0.0183,0.017,0.0161,0.0182,0.0173,0.0184,0.0191,0.0183,0.0188,0.0188,0.0172,0.0172,0.0167,0.0193,0.0173,0.0181,0.017,0.018,0.0167,0.0178,0.0177,0.0174,0.0168],"avgpossession":[50.6787,50.5696,50.5926,50.551,50.6633,50.6822,50.5864,50.56,50.5298,50.5121,50.4702,50.5163,50.5502,50.6062,50.5021,50.5818,50.5897,50.5667,50.5478,50.4754,50.4772,50.4608,50.7443,50.7846,50.7378,50.7334,50.6302,50.6483,50.6105,50.7207],"avgdribble":[73.1137,72.8043,72.8793,73.044,72.8275,72.971,72.5335,73.1069,73.1766,73.1528,73.2279,73.6012,73.1378,72.9316,72.763,72.8897,72.9477,73.4229,73.3977,73.3532,73.2394,73.5354,71.4046,71.956,72.0814,72.4263,72.0598,72.2425,72.2468,72.3074],"avgtacklesuccess":[6.0971,6.1125,6.1558,6.1378,6.1201,6.0494,6.1571,6.0826,6.1791,6.1383,6.1336,6.0721,6.0489,6.0731,6.1211,6.07,6.0604,6.0849,5.9819,6.0656,6.0441,5.9967,6.2733,6.2998,6.2124,6.1703,6.173,6.1699,6.096,6.1503],"avgtackletry":[11.3567,11.4302,11.4945,11.4937,11.4526,11.3348,11.536,11.3868,11.5704,11.5098,11.49,11.3887,11.3748,11.4355,11.4754,11.4212,11.3718,11.3718,11.205,11.3591,11.3252,11.2621,11.6406,11.712,11.5821,11.4957,11.5451,11.5346,11.3923,11.4603],"avgblocksuccess":[0.6132,0.5952,0.6119,0.6127,0.6137,0.616,0.609,0.6193,0.6136,0.6166,0.619,0.6218,0.6097,0.6034,0.6074,0.6122,0.6023,0.611,0.6223,0.6285,0.6209,0.6201,0.614,0.6167,0.6104,0.6254,0.6165,0.6174,0.6275,0.6169],"avgblocktry":[8.1642,8.1445,8.2103,8.2738,8.2356,8.1911,8.2105,8.2536,8.314,8.2934,8.3555,8.3491,8.2609,8.2086,8.2535,8.1917,8.1608,8.2128,8.3017,8.3086,8.2774,8.3063,8.1127,8.1525,8.2095,8.2714,8.2354,8.2728,8.252,8.2152],"avgfoul":[0.7001,0.6996,0.7111,0.7004,0.7158,0.6981,0.7132,0.7056,0.7124,0.7184,0.7073,0.6936,0.697,0.7059,0.7086,0.7094,0.7011,0.7047,0.6905,0.7041,0.7194,0.6962,0.7151,0.7167,0.7119,0.6996,0.7074,0.7029,0.6997,0.6993],"avgshootfreekick":[0.1826,0.1811,0.1845,0.1821,0.1892,0.1826,0.1905,0.181,0.1884,0.1845,0.1826,0.1824,0.1797,0.1887,0.1832,0.1862,0.183,0.1809,0.1794,0.1851,0.1863,0.178,0.1776,0.1816,0.1738,0.1794,0.1827,0.1839,0.1833,0.1829],"avgshootpenaltykick":[0.082,0.0789,0.0789,0.0812,0.083,0.0796,0.0818,0.0786,0.0796,0.0819,0.0809,0.0792,0.0787,0.0788,0.0787,0.083,0.082,0.0821,0.0782,0.0837,0.0797,0.0785,0.0834,0.0839,0.0819,0.0819,0.0793,0.0809,0.0789,0.0812],"avgshootheading":[0.9163,0.9363,0.9262,0.937,0.9509,0.9411,0.9226,0.9357,0.9402,0.9441,0.9498,0.953,0.9541,0.9402,0.9731,0.9611,0.9604,0.9537,0.9404,0.949,0.9429,0.9523,0.952,0.9451,0.9658,0.9523,0.9643,0.9575,0.9518,0.9532],"avgshortpasstry":[75.8331,75.1333,75.3505,75.4748,75.3273,75.915,75.3836,75.9461,75.8557,75.8646,76.5134,76.7147,75.7078,75.5764,75.4725,75.4842,75.6412,76.3476,76.3638,76.2765,76.0765,76.1665,72.1401,73.3754,73.6108,74.5665,74.0459,74.2688,74.2742,74.1949],"avgshortpasssuccess":[72.1046,71.4139,71.5963,71.69,71.5845,72.178,71.6453,72.1938,72.0709,72.0828,72.6804,72.9196,71.9721,71.8505,71.7447,71.7991,71.9526,72.6072,72.6084,72.5472,72.3565,72.4407,68.4065,69.6385,69.8909,70.8459,70.3534,70.6019,70.6191,70.5187],"avglobpasstry":[4.7402,4.8522,4.8581,4.8108,4.8466,4.8878,4.7719,4.8145,4.8599,4.8532,4.8802,4.8937,4.9914,4.8727,4.9481,4.9075,4.9676,4.931,4.9317,4.9347,4.9497,4.9433,4.8743,4.8085,4.8778,4.8364,4.8921,4.8878,4.9121,4.8758],"avglobpasssuccess":[2.6851,2.7404,2.7728,2.7127,2.7603,2.7854,2.6993,2.7234,2.7553,2.7461,2.7488,2.7525,2.8338,2.7735,2.8015,2.7939,2.8566,2.7941,2.7985,2.8098,2.8164,2.8212,2.655,2.655,2.7048,2.6928,2.7345,2.7506,2.7645,2.7444],"avgdrivengroundpasstry":[3.7547,3.9007,3.8517,3.711,3.8028,3.8553,3.8383,3.8345,3.8708,3.8718,3.7368,3.784,3.9505,4.005,3.9015,3.8077,3.8355,3.7874,3.8844,3.9175,3.9388,3.7946,3.454,3.5581,3.6606,3.6691,3.7062,3.7916,3.8275,3.847],"avgdrivengroundpasssuccess":[3.2442,3.3755,3.3308,3.2049,3.2885,3.3377,3.3206,3.3176,3.3437,3.3506,3.2243,3.2676,3.4263,3.4626,3.3749,3.3039,3.3268,3.2795,3.3697,3.3869,3.4187,3.2905,2.9623,3.067,3.1532,3.1702,3.2066,3.2851,3.3153,3.3305],"avgthroughpasstry":[19.1215,19.4988,19.4172,19.5254,19.4108,19.0443,19.1242,19.1972,19.228,19.2948,19.4343,19.4803,19.4128,19.1948,19.2085,19.2308,19.1267,19.1209,19.1047,18.9167,19.099,19.2179,20.2365,19.8805,19.746,19.4744,19.5368,19.3425,19.1917,19.3369],"avgthroughpasssuccess":[16.4468,16.7454,16.669,16.7739,16.6953,16.3602,16.405,16.4835,16.5007,16.5507,16.6919,16.737,16.68,16.4783,16.4871,16.5499,16.4509,16.4479,16.4261,16.2703,16.4283,16.5456,17.2884,17.0223,16.9205,16.7126,16.7804,16.6017,16.4917,16.6218],"avglobbedthroughpasstry":[0.2713,0.2667,0.2609,0.2683,0.2538,0.2542,0.2663,0.2544,0.2584,0.2574,0.2652,0.2643,0.2692,0.2624,0.25,0.262,0.2627,0.2609,0.2593,0.255,0.2502,0.2545,0.3326,0.2961,0.2867,0.2665,0.2779,0.2741,0.2611,0.2598],"avglobbedthroughpasssuccess":[0.1751,0.1702,0.1676,0.1706,0.1616,0.1635,0.1713,0.1623,0.167,0.1641,0.1673,0.1695,0.1698,0.1678,0.1587,0.166,0.1674,0.1682,0.1662,0.1657,0.1628,0.1611,0.2081,0.1872,0.1819,0.166,0.1761,0.1776,0.1658,0.1679],"avgcornerkick":[1.7147,1.73,1.7291,1.7487,1.7454,1.7351,1.738,1.7453,1.7469,1.7602,1.7553,1.7717,1.7521,1.7424,1.7647,1.7516,1.7346,1.7538,1.7585,1.7475,1.7593,1.7446,1.8083,1.7885,1.7939,1.8064,1.8138,1.789,1.774,1.7702],"avgycards":[0.0485,0.0477,0.0522,0.0489,0.049,0.0489,0.0492,0.0475,0.0487,0.0515,0.0478,0.0462,0.0465,0.0467,0.0467,0.0474,0.0476,0.046,0.0467,0.0439,0.0503,0.0459,0.0598,0.0571,0.054,0.0496,0.0498,0.0454,0.047,0.0467],"avgrcards":[0.0073,0.0076,0.0079,0.0078,0.0083,0.0081,0.0089,0.0072,0.0069,0.0081,0.0079,0.0073,0.0076,0.0074,0.0076,0.0069,0.0066,0.0072,0.0066,0.0064,0.0075,0.0071,0.0088,0.0083,0.0079,0.0076,0.0078,0.0074,0.0076,0.0079],"avginjury":[0.1158,0.1152,0.1158,0.1184,0.1177,0.115,0.1179,0.1173,0.1195,0.1178,0.1177,0.1169,0.1166,0.1182,0.1182,0.117,0.1165,0.1202,0.1138,0.112,0.1156,0.1133,0.1185,0.1206,0.1174,0.1174,0.1168,0.1198,0.1149,0.1176],"avgoffsidecnt":[0.5131,0.5084,0.5174,0.5198,0.5143,0.512,0.516,0.5158,0.5089,0.5158,0.5198,0.5117,0.5202,0.5083,0.5176,0.5093,0.5036,0.5182,0.5161,0.5155,0.5081,0.5136,0.5381,0.5255,0.5249,0.523,0.515,0.5087,0.5104,0.5083],"avgavgrating":[4.20459,4.20063,4.20398,4.21146,4.20395,4.19664,4.19544,4.19888,4.19614,4.19822,4.20447,4.20125,4.19677,4.19343,4.19589,4.18947,4.18495,4.19627,4.20128,4.19019,4.18821,4.18942,4.23534,4.22929,4.22447,4.22071,4.21419,4.20749,4.20708,4.20666]}

    # match_type = "52" ->  감모
    data_2 = {"lengthDate":30,"date":["2024-12-25T00:00:00","2024-12-26T00:00:00","2024-12-27T00:00:00","2024-12-28T00:00:00","2024-12-29T00:00:00","2024-12-30T00:00:00","2024-12-31T00:00:00","2025-01-01T00:00:00","2025-01-02T00:00:00","2025-01-03T00:00:00","2025-01-04T00:00:00","2025-01-05T00:00:00","2025-01-06T00:00:00","2025-01-07T00:00:00","2025-01-08T00:00:00","2025-01-09T00:00:00","2025-01-10T00:00:00","2025-01-11T00:00:00","2025-01-12T00:00:00","2025-01-13T00:00:00","2025-01-14T00:00:00","2025-01-15T00:00:00","2025-01-16T00:00:00","2025-01-17T00:00:00","2025-01-18T00:00:00","2025-01-19T00:00:00","2025-01-20T00:00:00","2025-01-21T00:00:00","2025-01-22T00:00:00","2025-01-23T00:00:00"],"count":[231795,231319,232088,229900,227855,230386,227115,223410,163185,233675,227521,229815,231247,230953,229242,168392,233394,227588,223290,227184,223772,220888,170212,287383,205249,264947,266406,259197,259161,181106],"avggoaltot":[1.4278,1.4301,1.4325,1.4335,1.4336,1.4349,1.4337,1.4346,1.4325,1.4332,1.445,1.4373,1.4426,1.4401,1.4451,1.4371,1.4433,1.4413,1.442,1.4413,1.4445,1.4434,1.4707,1.4031,1.4089,1.3947,1.3979,1.4027,1.402,1.4077],"avgshoottot":[4.6312,4.6367,4.6448,4.651,4.6679,4.676,4.6732,4.6681,4.6372,4.6791,4.6912,4.6886,4.7087,4.6976,4.7087,4.6669,4.7074,4.7133,4.7091,4.7011,4.7174,4.7113,4.5254,4.4438,4.453,4.4685,4.4927,4.511,4.5203,4.5104],"avgeffshoottot":[3.6216,3.6245,3.6295,3.6343,3.6446,3.6544,3.6528,3.6483,3.6257,3.655,3.6719,3.6629,3.679,3.6696,3.6815,3.6528,3.6791,3.6823,3.6813,3.6743,3.6865,3.6801,3.5618,3.4811,3.493,3.499,3.5179,3.5346,3.5398,3.5375],"avggoalpenaltykick":[0.0255,0.0259,0.0256,0.0253,0.0255,0.0254,0.0256,0.0256,0.0253,0.0258,0.0259,0.0258,0.0256,0.026,0.026,0.0257,0.0259,0.0256,0.0261,0.0261,0.0265,0.0261,0.0256,0.0249,0.0249,0.0245,0.0246,0.025,0.0245,0.0255],"avggoalfreekick":[0.0032,0.0034,0.0033,0.0031,0.0033,0.0033,0.0034,0.0032,0.0031,0.0034,0.0034,0.0033,0.0032,0.0034,0.0034,0.0033,0.0034,0.0035,0.0031,0.0032,0.0033,0.0034,0.0034,0.0033,0.0034,0.0031,0.0034,0.0032,0.0032,0.0032],"avgshootinpenalty":[2.9145,2.9179,2.917,2.9205,2.9306,2.9397,2.9353,2.93,2.9165,2.9359,2.9489,2.9435,2.958,2.9497,2.9557,2.9353,2.9575,2.9597,2.9549,2.9519,2.9631,2.9586,2.8823,2.8011,2.8096,2.8093,2.8174,2.8261,2.8265,2.8264],"avggoalinpenalty":[1.0861,1.0864,1.0869,1.0884,1.0888,1.0907,1.088,1.0872,1.0885,1.0861,1.0974,1.0915,1.0954,1.0929,1.0966,1.092,1.0954,1.0942,1.0944,1.094,1.0958,1.0954,1.122,1.0676,1.0703,1.0589,1.0605,1.0627,1.0625,1.066],"avgshootoutpenalty":[1.6818,1.6835,1.6927,1.6955,1.7021,1.7015,1.7028,1.703,1.6858,1.7079,1.7069,1.7095,1.7153,1.7123,1.7173,1.6965,1.7142,1.7185,1.7184,1.7133,1.7183,1.7169,1.608,1.6087,1.6091,1.6254,1.6413,1.6508,1.6599,1.6493],"avggoaloutpenalty":[0.3163,0.3178,0.32,0.3197,0.3193,0.3188,0.3201,0.3218,0.3187,0.3213,0.3217,0.32,0.3216,0.3212,0.3224,0.3194,0.3219,0.3215,0.3215,0.3212,0.3223,0.3219,0.323,0.3107,0.3137,0.3114,0.3129,0.3151,0.315,0.3162],"middleshoot":[18.8067,18.8776,18.9065,18.856,18.7589,18.7373,18.7985,18.8932,18.9043,18.8135,18.8453,18.7216,18.7504,18.7583,18.7761,18.829,18.7809,18.7073,18.7105,18.7449,18.7563,18.749,20.0893,19.3112,19.4928,19.1561,19.061,19.0877,18.9764,19.1685],"outpenaltygoalratio":[22.153,22.2222,22.3386,22.3021,22.2726,22.2176,22.3268,22.4313,22.2478,22.4184,22.263,22.264,22.2931,22.304,22.3099,22.2253,22.3031,22.3063,22.2954,22.2854,22.3122,22.3015,21.9623,22.1438,22.2656,22.3274,22.3836,22.4638,22.4679,22.4622],"avggoalheading":[0.1737,0.174,0.1744,0.1725,0.1737,0.173,0.1722,0.1731,0.1734,0.1726,0.1738,0.1742,0.1737,0.1739,0.1734,0.1724,0.1732,0.173,0.1737,0.1738,0.1745,0.1728,0.1765,0.1699,0.1692,0.1685,0.1672,0.1673,0.1677,0.1665],"goalheadingratio":[12.1685,12.1637,12.1746,12.0368,12.1185,12.0556,12.0125,12.0652,12.1013,12.0397,12.0292,12.123,12.0442,12.0752,11.9986,11.9986,11.9986,12.0038,12.0437,12.0562,12.0791,11.969,12.001,12.1116,12.0101,12.0785,11.9628,11.9234,11.9633,11.8307],"avgpasstry":[105.754,105.902,106.24,106.447,106.667,106.897,107.101,107.154,106.496,107.449,107.66,107.74,108.266,108.032,108.29,107.348,108.436,108.58,108.297,108.403,108.524,108.557,101.22,99.4108,99.9956,100.919,101.858,102.624,103.455,103.138],"avgpasssuccess":[91.5662,91.6876,91.9716,92.1748,92.3644,92.559,92.7478,92.8008,92.2472,93.061,93.2686,93.3337,93.8054,93.5839,93.8305,93.003,93.9465,94.0658,93.802,93.9067,93.9885,94.0597,87.606,85.9819,86.4849,87.3192,88.1865,88.9104,89.6845,89.3882],"passsuccessratio":[86.5841,86.5776,86.5695,86.5927,86.5913,86.5872,86.5983,86.6051,86.6206,86.6093,86.6329,86.6289,86.6436,86.6265,86.6475,86.6372,86.638,86.6325,86.6155,86.6274,86.606,86.6458,86.5502,86.4916,86.4887,86.5239,86.5782,86.6374,86.6892,86.6681],"avgowngoal":[0.0069,0.0068,0.0068,0.0067,0.0071,0.0071,0.007,0.007,0.0068,0.0071,0.0069,0.0071,0.0069,0.007,0.0071,0.0067,0.0072,0.0071,0.007,0.0071,0.0071,0.0074,0.0063,0.0065,0.0064,0.0063,0.0067,0.0066,0.0067,0.0064],"avgpossession":[49.8798,49.8867,49.8898,49.8991,49.9057,49.9036,49.9012,49.9105,49.9013,49.9182,49.9244,49.9251,49.9284,49.9264,49.9273,49.9184,49.9341,49.9356,49.9375,49.9315,49.939,49.9388,49.6483,49.7231,49.7554,49.8167,49.8185,49.8406,49.864,49.8422],"avgdribble":[82.1295,82.2255,82.5304,82.7413,82.9151,83.0839,83.2464,83.3038,82.6746,83.5419,83.7277,83.8135,84.2164,84.0484,84.2539,83.4226,84.358,84.504,84.2892,84.3735,84.4293,84.4856,78.0139,76.9357,77.3946,78.2896,79.0835,79.7544,80.4232,80.0526],"avgtacklesuccess":[5.4015,5.4095,5.4417,5.4427,5.4469,5.4557,5.4575,5.4591,5.4298,5.4699,5.4891,5.4825,5.5028,5.4968,5.5036,5.4613,5.5063,5.5007,5.5067,5.5077,5.5227,5.505,5.2312,5.1704,5.2151,5.2513,5.2945,5.3215,5.3399,5.3471],"avgtackletry":[7.9811,7.9962,8.0348,8.0345,8.0394,8.0573,8.0581,8.064,8.0153,8.075,8.0962,8.0895,8.1217,8.1147,8.1229,8.0642,8.1284,8.1247,8.1366,8.131,8.1534,8.1279,7.7286,7.6412,7.6939,7.7522,7.8204,7.8583,7.8833,7.894],"avgblocksuccess":[0.4202,0.4208,0.4232,0.4213,0.4246,0.4247,0.4235,0.4237,0.4212,0.4262,0.4243,0.4254,0.4284,0.4257,0.4293,0.4232,0.427,0.4288,0.4287,0.4275,0.4301,0.429,0.4028,0.3973,0.3979,0.4032,0.4065,0.4062,0.4121,0.4097],"avgblocktry":[6.9072,6.9239,6.9525,6.9507,6.9706,6.9875,6.9936,6.9949,6.9421,7.0094,7.0058,7.0117,7.0455,7.0298,7.0451,6.987,7.0579,7.0592,7.0555,7.0413,7.0594,7.0474,6.5962,6.5515,6.5819,6.6499,6.7163,6.7477,6.7941,6.7745],"avgfoul":[0.7825,0.7854,0.7869,0.7877,0.7884,0.7912,0.7924,0.7908,0.7835,0.7944,0.7948,0.7943,0.797,0.7982,0.7975,0.7918,0.8005,0.7993,0.8,0.8012,0.802,0.8007,0.7497,0.7475,0.7489,0.7581,0.7639,0.77,0.7741,0.7712],"avgshootfreekick":[0.0849,0.0851,0.0851,0.0856,0.0863,0.0856,0.0866,0.085,0.0846,0.0856,0.0864,0.0855,0.0866,0.0863,0.0865,0.0857,0.087,0.0873,0.087,0.0871,0.086,0.0874,0.0824,0.0814,0.0819,0.0824,0.0827,0.0838,0.0842,0.083],"avgshootpenaltykick":[0.0327,0.0332,0.0328,0.0328,0.033,0.0327,0.033,0.0329,0.0327,0.0333,0.0332,0.0333,0.0331,0.0333,0.0334,0.033,0.0335,0.0329,0.0336,0.0336,0.0338,0.0337,0.0327,0.032,0.0321,0.0316,0.0318,0.032,0.0317,0.0325],"avgshootheading":[0.8785,0.8804,0.8799,0.8808,0.8854,0.8864,0.8868,0.8833,0.8754,0.8873,0.8866,0.8876,0.8921,0.8915,0.8909,0.8804,0.891,0.8907,0.8927,0.8884,0.8925,0.8905,0.8505,0.8426,0.842,0.8414,0.8437,0.8453,0.8442,0.8414],"avgshortpasstry":[62.4212,62.4761,62.6771,62.8534,63.0026,63.1127,63.3007,63.3357,62.9534,63.5351,63.6583,63.699,64.0251,63.8318,64.0178,63.4591,64.0813,64.2086,63.9575,64.0517,64.09,64.1858,59.4993,58.3846,58.7307,59.3799,60.043,60.6045,61.2519,61.0082],"avgshortpasssuccess":[60.6321,60.6834,60.8763,61.054,61.2012,61.3026,61.488,61.5265,61.1571,61.7218,61.845,61.8843,62.2044,62.0143,62.1989,61.656,62.2572,62.3784,62.1368,62.2281,62.262,62.3671,57.7726,56.6897,57.0263,57.6644,58.3113,58.8616,59.5,59.2581],"avglobpasstry":[6.4624,6.482,6.4853,6.4967,6.5141,6.5313,6.53,6.5208,6.4688,6.5402,6.5324,6.5404,6.5687,6.5559,6.5651,6.5202,6.5822,6.5901,6.5843,6.5774,6.5983,6.5775,6.195,6.0856,6.123,6.1412,6.1575,6.1714,6.1852,6.1635],"avglobpasssuccess":[2.0806,2.0909,2.0879,2.0916,2.0978,2.1028,2.1038,2.097,2.0785,2.1014,2.1019,2.101,2.1141,2.107,2.1106,2.0936,2.115,2.1146,2.113,2.1089,2.1137,2.1102,2.0207,1.9716,1.9842,1.9784,1.9851,1.9916,1.9934,1.9867],"avgdrivengroundpasstry":[4.6544,4.6633,4.6735,4.6745,4.6981,4.7044,4.7139,4.7194,4.6923,4.7366,4.7448,4.7597,4.7854,4.7875,4.7898,4.7401,4.8061,4.8137,4.808,4.8195,4.8225,4.8236,4.4284,4.3757,4.394,4.453,4.4832,4.5102,4.5316,4.5065],"avgdrivengroundpasssuccess":[4.5026,4.5109,4.5211,4.5213,4.5446,4.5512,4.5603,4.5656,4.5386,4.5831,4.5904,4.6053,4.6301,4.632,4.6345,4.5859,4.6494,4.6572,4.6523,4.6638,4.6659,4.6673,4.2807,4.2324,4.2499,4.3071,4.3358,4.3624,4.3833,4.3577],"avgthroughpasstry":[22.6568,22.7185,22.8027,22.8293,22.8287,22.9129,22.9109,22.9265,22.7951,22.968,23.0437,23.0558,23.1605,23.1384,23.1918,22.9954,23.2261,23.2188,23.2113,23.2072,23.2524,23.2078,21.9866,21.5721,21.7163,21.8613,22.0719,22.2207,22.3594,22.374],"avgthroughpasssuccess":[19.0571,19.1097,19.1761,19.2052,19.1982,19.2751,19.2718,19.2844,19.1749,19.323,19.3865,19.3954,19.4905,19.4677,19.5186,19.3521,19.5489,19.5392,19.5296,19.5288,19.5647,19.5305,18.4817,18.1157,18.2443,18.363,18.5481,18.6876,18.8062,18.8132],"avglobbedthroughpasstry":[8.73,8.7276,8.7656,8.7573,8.7849,8.8009,8.8092,8.8107,8.7543,8.8279,8.8365,8.8441,8.882,8.8734,8.8784,8.7922,8.8966,8.9037,8.888,8.9015,8.9126,8.9185,8.2999,8.1942,8.2268,8.2781,8.2909,8.3034,8.3124,8.2715],"avglobbedthroughpasssuccess":[5.1274,5.1257,5.1426,5.1349,5.1544,5.1602,5.1565,5.1599,5.1327,5.1643,5.1757,5.1794,5.1976,5.193,5.1979,5.1481,5.2073,5.2075,5.2012,5.208,5.2129,5.2153,4.8843,4.8114,4.8182,4.8458,4.8444,4.8452,4.8403,4.8113],"avgcornerkick":[1.7943,1.7927,1.7933,1.8012,1.807,1.8112,1.8134,1.8046,1.7922,1.8163,1.8142,1.818,1.8271,1.8225,1.8234,1.8133,1.8258,1.8314,1.8308,1.8268,1.8335,1.8267,1.7076,1.6984,1.7094,1.7196,1.7303,1.7353,1.7413,1.7363],"avgycards":[0.0803,0.0811,0.0808,0.0815,0.0803,0.0815,0.0819,0.0814,0.0806,0.0818,0.0826,0.0815,0.0819,0.0824,0.0823,0.0825,0.0828,0.0828,0.0824,0.0826,0.0831,0.0829,0.0776,0.0778,0.0765,0.0787,0.0791,0.0795,0.081,0.0806],"avgrcards":[0.0033,0.0031,0.0031,0.0031,0.0033,0.0031,0.0031,0.0033,0.0033,0.0032,0.0032,0.0031,0.0035,0.0033,0.0032,0.0034,0.0032,0.0032,0.0032,0.0033,0.0033,0.0033,0.003,0.003,0.0031,0.003,0.003,0.0032,0.0029,0.003],"avginjury":[0.1411,0.142,0.1423,0.1423,0.1414,0.1434,0.1432,0.1424,0.1423,0.1427,0.1443,0.1444,0.1443,0.1438,0.1447,0.1425,0.1446,0.1452,0.1453,0.1442,0.145,0.1443,0.1365,0.1341,0.1351,0.1352,0.1376,0.137,0.1383,0.1389],"avgoffsidecnt":[1.6446,1.6461,1.6512,1.6532,1.6579,1.6607,1.6649,1.6622,1.6485,1.6708,1.6774,1.6714,1.6816,1.6807,1.6873,1.6658,1.6899,1.6869,1.6874,1.6919,1.6876,1.6974,1.5578,1.5483,1.5573,1.5726,1.5771,1.5794,1.5805,1.5676],"avgavgrating":[4.00676,4.00662,4.00599,4.00599,4.00555,4.00512,4.00466,4.00494,4.00667,4.00421,4.00625,4.00422,4.00401,4.00321,4.00345,4.0052,4.00324,4.00303,4.0032,4.00253,4.00319,4.00305,4.02911,4.0161,4.01576,4.00972,4.00724,4.0056,4.00349,4.00598]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
