import numpy as np
import pandas as pd
import requests
import copy
from datetime import datetime, timedelta


# def me(match, me):
#     if match['matchInfo'][0]['nickname'].lower() == me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

# def you(match, me):
#     if match['matchInfo'][0]['nickname'].lower() != me.lower() or len(match['matchInfo'][:])==1:
#         return match['matchInfo'][0]
#     else:
#         return match['matchInfo'][1]

def me(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() == me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

def you(match, me):
    me = me.replace(" ", "")  # 입력받은 닉네임에서 띄어쓰기 제거
    if match['matchInfo'][0]['nickname'].replace(" ", "").lower() != me.lower() or len(match['matchInfo'][:]) == 1:
        return match['matchInfo'][0]
    else:
        return match['matchInfo'][1]

    
# def avg_data():
#     url = f"https://fconline.nexon.com/Datacenter/GetMatchRecord?strDate={datetime.now().strftime('%Y.%m.%d')}&n1Type=50&n4StartRanking=1&n4EndRanking=10000&rd=0.4988530727702105"
#     response = requests.get(url)
#     json_obj = response.json()
#     df = pd.DataFrame(json_obj)  # JSON 데이터를 DataFrame으로 변환
#     return df.iloc[-1, :]

def top_n_argmax(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        max_index = np.nanargmax(arr)
        top_n_indices.append(max_index)
        top_n_values.append(arr[max_index])
        arr[max_index] = -np.inf
    return top_n_indices, top_n_values

def top_n_argmin(array, n):
    top_n_indices = []
    top_n_values = []
    arr = copy.deepcopy(array)
    for _ in range(n):
        min_index = np.nanargmin(arr)
        top_n_indices.append(min_index)
        top_n_values.append(arr[min_index])
        arr[min_index] = np.inf
    return top_n_indices, top_n_values


def calculate_time_difference(date_str):
    current_time = datetime.now()
    input_time = datetime.strptime(date_str, '%Y-%m-%dT%H:%M:%S')
    time_difference = current_time - input_time

    if time_difference < timedelta(days=1):
        hours_diff = int(time_difference.total_seconds() // 3600)
        minutes_diff = int((time_difference.total_seconds() % 3600) // 60)
        if hours_diff == 0:
            if minutes_diff <= 1:
                return "방금 전"
            else:
                return f"{minutes_diff}분 전"
        elif hours_diff == 1:
            return "1시간 전"
        else:
            return f"{hours_diff}시간 전"
    else:
        days_diff = time_difference.days
        if days_diff == 1:
            return "1일 전"
        else:
            return f"{days_diff}일 전"


def avg_data(match_type):
    # 미리 저장된 JSON 데이터를 불러옴
    # match_type = "50" -> 공경
    data_1 = {"lengthDate":30,"date":["2025-09-16T00:00:00","2025-09-17T00:00:00","2025-09-18T00:00:00","2025-09-19T00:00:00","2025-09-20T00:00:00","2025-09-21T00:00:00","2025-09-22T00:00:00","2025-09-23T00:00:00","2025-09-24T00:00:00","2025-09-25T00:00:00","2025-09-26T00:00:00","2025-09-27T00:00:00","2025-09-28T00:00:00","2025-09-29T00:00:00","2025-09-30T00:00:00","2025-10-01T00:00:00","2025-10-02T00:00:00","2025-10-03T00:00:00","2025-10-04T00:00:00","2025-10-05T00:00:00","2025-10-06T00:00:00","2025-10-07T00:00:00","2025-10-08T00:00:00","2025-10-09T00:00:00","2025-10-10T00:00:00","2025-10-11T00:00:00","2025-10-12T00:00:00","2025-10-13T00:00:00","2025-10-14T00:00:00","2025-10-15T00:00:00"],"count":[23276,23135,24029,26829,28322,26939,20849,20804,21652,21032,26897,30189,30620,23160,22919,26519,26742,32086,28879,25737,23199,25088,24917,25222,21951,28160,26827,18979,17298,18136],"avggoaltot":[2.7169,2.7058,2.6742,2.684,2.7054,2.717,2.7177,2.7234,2.717,2.8352,2.813,2.793,2.7926,2.7831,2.7887,2.762,2.7388,2.7708,2.7893,2.8234,2.8128,2.8006,2.8093,2.8147,2.8132,2.7649,2.7698,2.797,2.7892,2.7849],"avgshoottot":[7.1264,7.0941,7.0441,7.024,7.0976,7.1089,7.0486,7.0598,7.0231,7.2308,7.1855,7.197,7.1778,7.1529,7.1555,7.1208,7.0646,7.1682,7.2175,7.2616,7.2555,7.2465,7.2125,7.2338,7.2648,7.1186,7.1241,7.1588,7.1703,7.0967],"avgeffshoottot":[5.4582,5.4282,5.3646,5.3674,5.4057,5.436,5.4011,5.4051,5.3794,5.5605,5.5272,5.5152,5.5048,5.486,5.4854,5.4651,5.4127,5.4727,5.5131,5.56,5.5475,5.5422,5.5213,5.5432,5.5636,5.45,5.46,5.4906,5.4963,5.4569],"avggoalpenaltykick":[0.0587,0.0595,0.0541,0.0569,0.0566,0.0587,0.0563,0.0582,0.0598,0.0613,0.0596,0.0591,0.059,0.0598,0.0571,0.0587,0.0569,0.0584,0.0615,0.0568,0.0582,0.0578,0.0592,0.0591,0.0576,0.059,0.0573,0.0581,0.0582,0.0613],"avggoalfreekick":[0.0233,0.0237,0.0235,0.0239,0.0238,0.024,0.0227,0.0233,0.0248,0.0245,0.0247,0.0244,0.023,0.0215,0.0227,0.0237,0.0243,0.0233,0.022,0.0224,0.0244,0.0229,0.0228,0.024,0.0242,0.0225,0.0231,0.0239,0.0228,0.0227],"avgshootinpenalty":[4.5711,4.5645,4.5274,4.5208,4.5392,4.5641,4.5387,4.538,4.5095,4.6491,4.6224,4.6133,4.6238,4.6084,4.5951,4.5775,4.534,4.5924,4.6224,4.6624,4.6594,4.6538,4.6272,4.6463,4.6455,4.5901,4.5843,4.5993,4.6142,4.5612],"avggoalinpenalty":[2.069,2.0598,2.043,2.0475,2.062,2.0744,2.0884,2.085,2.0747,2.1652,2.1502,2.1278,2.1397,2.131,2.1314,2.1121,2.0929,2.1096,2.1284,2.1521,2.1493,2.1423,2.1465,2.1543,2.1396,2.121,2.1203,2.1386,2.1416,2.1274],"avgshootoutpenalty":[2.4723,2.4469,2.4376,2.4222,2.4795,2.4614,2.4292,2.4386,2.4293,2.4958,2.4796,2.4993,2.4721,2.4595,2.4788,2.4606,2.4499,2.4932,2.508,2.5173,2.5124,2.5102,2.5021,2.5033,2.5381,2.4453,2.4582,2.477,2.4741,2.4492],"avggoaloutpenalty":[0.5892,0.5866,0.5771,0.5796,0.5868,0.5839,0.573,0.5802,0.5826,0.6086,0.6032,0.6061,0.594,0.5924,0.6001,0.5912,0.589,0.6028,0.5994,0.6145,0.6053,0.6005,0.6036,0.6014,0.616,0.5849,0.5922,0.6004,0.5894,0.5963],"middleshoot":[23.8306,23.9716,23.674,23.9301,23.667,23.7204,23.587,23.7919,23.9834,24.387,24.3272,24.2511,24.0272,24.084,24.2088,24.0283,24.04,24.1766,23.8998,24.4109,24.0909,23.9236,24.1223,24.0234,24.27,23.9201,24.0908,24.2385,23.823,24.3457],"outpenaltygoalratio":[21.6865,21.6794,21.5803,21.5946,21.69,21.4906,21.084,21.3043,21.4428,21.4659,21.4433,21.7007,21.2705,21.2856,21.519,21.4048,21.5058,21.7554,21.4893,21.7645,21.5195,21.4418,21.4858,21.3664,21.8968,21.1545,21.3806,21.4659,21.1315,21.4119],"avggoalheading":[0.3351,0.3362,0.3259,0.3267,0.3247,0.3251,0.3264,0.3206,0.3242,0.3393,0.3365,0.3279,0.3253,0.3303,0.3252,0.3216,0.3227,0.3282,0.329,0.3355,0.3346,0.3306,0.3308,0.3299,0.3293,0.3216,0.3281,0.329,0.3214,0.3249],"goalheadingratio":[12.3323,12.425,12.1887,12.1731,12.0034,11.9646,12.0099,11.7732,11.9318,11.9681,11.9608,11.7389,11.6496,11.8675,11.6619,11.6451,11.7824,11.8467,11.7938,11.8813,11.895,11.8031,11.7742,11.7206,11.704,11.6301,11.8472,11.7623,11.5224,11.6666],"avgpasstry":[109.42,109.621,107.708,107.632,108.99,109.56,110.071,110.421,109.948,108.62,108.33,108.822,109.047,109.266,108.702,108.975,107.074,108.176,109.221,109.858,110.595,111.325,110.867,110.784,111.081,108.538,109.182,108.981,110.092,110.158],"avgpasssuccess":[98.9658,99.1469,97.3772,97.3261,98.5034,99.0629,99.5841,99.9672,99.5176,98.377,98.0558,98.48,98.6377,98.8757,98.3784,98.6139,96.7856,97.756,98.6985,99.3027,99.983,100.665,100.25,100.152,100.407,98.2222,98.7391,98.5475,99.486,99.6243],"passsuccessratio":[90.4455,90.4451,90.4088,90.4246,90.3786,90.4187,90.4726,90.5331,90.5132,90.5701,90.5155,90.4968,90.4542,90.4908,90.5024,90.4926,90.3914,90.3677,90.3658,90.3919,90.4043,90.4243,90.4232,90.4032,90.391,90.4953,90.435,90.4265,90.3664,90.4379],"avgowngoal":[0.0152,0.0143,0.0144,0.0148,0.0158,0.0152,0.0145,0.0132,0.0144,0.0155,0.0144,0.0147,0.0154,0.0147,0.0148,0.0145,0.0141,0.0141,0.0146,0.0148,0.0152,0.0151,0.0151,0.015,0.015,0.0146,0.0148,0.0144,0.0147,0.0167],"avgpossession":[50.5715,50.5258,50.5497,50.594,50.5889,50.5345,50.5524,50.5217,50.476,50.9469,50.9023,50.8489,50.8223,50.7866,50.7594,50.7101,50.66,50.7048,50.7113,50.5991,50.6406,50.6357,50.5572,50.5567,50.5511,50.7098,50.6345,50.6273,50.5427,50.5923],"avgdribble":[76.41,76.5908,75.0309,75.0077,75.8079,76.3872,76.7043,76.9568,76.5481,76.0627,75.6954,76.0894,76.1826,76.3418,75.948,76.165,74.8312,75.4357,75.947,76.3488,76.7154,77.3952,76.9486,77.1789,77.2183,75.6803,76.064,76.0252,76.6112,76.8103],"avgtacklesuccess":[6.4198,6.4252,6.3323,6.3295,6.4092,6.4311,6.4352,6.4165,6.3545,6.4614,6.4298,6.452,6.4034,6.3763,6.3942,6.3456,6.3592,6.4223,6.394,6.3878,6.4132,6.4322,6.4038,6.5024,6.4768,6.3127,6.357,6.381,6.4407,6.4417],"avgtackletry":[12.2898,12.3279,12.0697,12.0493,12.2765,12.3239,12.2865,12.3554,12.1858,12.2791,12.1973,12.3074,12.1525,12.1622,12.1784,12.0798,12.1524,12.2561,12.2256,12.2221,12.2937,12.3179,12.3206,12.4677,12.4194,12.0984,12.245,12.269,12.3511,12.3985],"avgblocksuccess":[0.6542,0.651,0.638,0.6405,0.6496,0.6599,0.647,0.647,0.6485,0.6363,0.6376,0.6467,0.6488,0.6349,0.6417,0.6439,0.6379,0.6425,0.6532,0.6604,0.6538,0.6542,0.66,0.652,0.6623,0.6407,0.6485,0.6465,0.648,0.6391],"avgblocktry":[8.8304,8.8726,8.7579,8.7612,8.8711,8.9133,8.9059,8.9011,8.9119,8.7291,8.7424,8.7658,8.8185,8.7445,8.7384,8.7652,8.6982,8.7873,8.8951,8.9093,8.889,8.9791,8.953,8.9645,8.977,8.7253,8.8235,8.8664,8.9168,8.8864],"avgfoul":[0.706,0.7104,0.6878,0.6889,0.6956,0.6989,0.688,0.689,0.6951,0.7041,0.6861,0.6945,0.6909,0.6976,0.694,0.6801,0.6956,0.6958,0.6985,0.6985,0.6945,0.6933,0.6952,0.706,0.7077,0.6894,0.6834,0.6956,0.6988,0.6969],"avgshootfreekick":[0.1783,0.1818,0.1778,0.1759,0.1797,0.1763,0.1749,0.1782,0.1834,0.1775,0.1805,0.1747,0.1724,0.1754,0.1749,0.1776,0.1822,0.1751,0.1724,0.1763,0.1774,0.1746,0.1747,0.1798,0.1819,0.176,0.1744,0.1781,0.1818,0.1754],"avgshootpenaltykick":[0.0757,0.0756,0.0716,0.0744,0.0719,0.0755,0.0723,0.075,0.0764,0.0784,0.0762,0.0773,0.0746,0.0782,0.0739,0.0749,0.0738,0.0756,0.0785,0.074,0.075,0.0748,0.0761,0.076,0.0734,0.0759,0.0744,0.075,0.0745,0.078],"avgshootheading":[1.0127,1.0142,0.9968,0.9903,0.9987,0.9919,0.9852,0.9818,0.9808,1.0189,1.0123,1.0032,0.9836,0.9956,0.9889,0.976,0.9704,0.9928,1.0008,1.014,1.0108,1.0122,1.0074,1.0042,1.0117,0.995,1.003,1.0104,0.9838,0.984],"avgshortpasstry":[78.3015,78.6869,77.0493,77.1644,78.104,78.5726,79.0198,79.5065,79.0078,77.8448,77.8899,78.269,78.2416,78.5025,78.0815,78.2149,76.5165,77.0723,78.0945,78.686,79.364,79.7986,79.3754,79.2502,79.4389,77.7078,78.2194,77.8848,78.6791,78.9231],"avgshortpasssuccess":[74.5417,74.8592,73.3052,73.417,74.298,74.74,75.2018,75.6783,75.1997,74.1301,74.1342,74.4955,74.4662,74.7181,74.3282,74.451,72.7949,73.3194,74.2961,74.8757,75.5359,75.9495,75.552,75.4287,75.5921,73.9865,74.4542,74.1211,74.878,75.1244],"avglobpasstry":[5.3168,5.2494,5.159,5.1442,5.2098,5.1804,5.1704,5.1659,5.1645,5.1888,5.1611,5.1493,5.1849,5.2127,5.1743,5.1995,5.1177,5.1625,5.2499,5.299,5.3475,5.4284,5.3978,5.4189,5.4711,5.3182,5.3477,5.3532,5.4072,5.4059],"avglobpasssuccess":[2.8891,2.8517,2.7942,2.7863,2.8161,2.8059,2.8111,2.8062,2.8065,2.8427,2.8195,2.7824,2.7971,2.8218,2.7971,2.8022,2.7642,2.7863,2.8149,2.8477,2.8581,2.9226,2.8944,2.9147,2.9545,2.8663,2.8776,2.9077,2.9133,2.9281],"avgdrivengroundpasstry":[6.1361,6.0123,6.1024,5.9376,5.9105,5.9732,6.1388,6.1862,6.2729,6.184,5.9781,5.8493,5.8748,5.8991,5.9911,6.088,5.9982,6.0213,5.9874,5.926,5.9395,5.9821,6.0981,6.0285,6.2274,5.9567,6.0407,6.2278,6.1216,6.2929],"avgdrivengroundpasssuccess":[5.4755,5.3467,5.4274,5.2671,5.2409,5.3057,5.4592,5.5033,5.5836,5.5139,5.325,5.1929,5.2055,5.238,5.3281,5.4162,5.332,5.3499,5.3177,5.2656,5.2786,5.3209,5.4324,5.3658,5.5508,5.3093,5.3847,5.5619,5.4464,5.6133],"avgthroughpasstry":[18.1503,18.1607,17.9269,17.9164,18.2697,18.3169,18.2262,18.0627,17.9862,17.8869,17.7987,18.0597,18.2357,18.1655,17.9683,17.9856,17.9543,18.4388,18.3832,18.4482,18.4343,18.5889,18.4746,18.5665,18.4132,18.0754,18.0864,18.0039,18.3576,18.025],"avgthroughpasssuccess":[15.6952,15.7226,15.4988,15.5075,15.7934,15.8482,15.7592,15.6244,15.5571,15.5158,15.4179,15.6549,15.801,15.7401,15.5727,15.5974,15.5345,15.9468,15.903,15.9601,15.9455,16.1075,16.0033,16.0785,15.9376,15.7019,15.672,15.586,15.8773,15.5944],"avglobbedthroughpasstry":[0.3683,0.3674,0.3485,0.3414,0.3529,0.3543,0.345,0.3443,0.3541,0.3495,0.3377,0.3398,0.3462,0.3486,0.327,0.3299,0.3448,0.3428,0.3552,0.3528,0.3557,0.3498,0.3557,0.3501,0.3559,0.3424,0.3344,0.3466,0.3555,0.3461],"avglobbedthroughpasssuccess":[0.2345,0.2382,0.2257,0.2209,0.2276,0.2294,0.2219,0.2217,0.2314,0.228,0.2189,0.218,0.2263,0.2234,0.2119,0.2133,0.2252,0.2219,0.2314,0.2254,0.2326,0.227,0.2317,0.2274,0.2335,0.2259,0.217,0.2279,0.2311,0.2254],"avgcornerkick":[1.8822,1.878,1.8554,1.8531,1.8681,1.8696,1.8593,1.8576,1.8443,1.8943,1.8646,1.8975,1.8776,1.8764,1.8724,1.8747,1.8411,1.8719,1.8979,1.9,1.8994,1.9094,1.8905,1.9008,1.9134,1.8801,1.8775,1.8817,1.8908,1.8687],"avgycards":[0.044,0.0441,0.0425,0.043,0.0444,0.0454,0.041,0.041,0.041,0.0434,0.0393,0.0429,0.0424,0.0431,0.044,0.0392,0.0437,0.0456,0.0429,0.0422,0.0437,0.0439,0.0404,0.0427,0.0402,0.041,0.0401,0.0403,0.0425,0.0421],"avgrcards":[0.0076,0.0068,0.007,0.007,0.0071,0.0081,0.008,0.0071,0.0071,0.0071,0.0061,0.0066,0.0068,0.007,0.0075,0.006,0.0066,0.0072,0.0069,0.0067,0.0067,0.0072,0.0066,0.0065,0.0068,0.0066,0.0062,0.006,0.0066,0.007],"avginjury":[0.1405,0.1369,0.1321,0.1349,0.1341,0.1357,0.1361,0.1361,0.1291,0.1362,0.1331,0.136,0.1357,0.1316,0.1325,0.1341,0.1355,0.1347,0.1358,0.133,0.1393,0.1357,0.1344,0.1364,0.1347,0.1314,0.1324,0.1298,0.1371,0.1376],"avgoffsidecnt":[0.4145,0.4125,0.4094,0.4067,0.4072,0.4115,0.4172,0.4194,0.419,0.4116,0.4154,0.4156,0.417,0.417,0.4075,0.4108,0.4118,0.4192,0.4206,0.4167,0.4136,0.4298,0.4249,0.4269,0.426,0.4193,0.4187,0.4206,0.4249,0.4258],"avgavgrating":[4.20647,4.20542,4.19394,4.19098,4.19755,4.20357,4.20183,4.19436,4.19208,4.23264,4.22279,4.22358,4.21888,4.21553,4.20704,4.20958,4.20271,4.20867,4.21693,4.21889,4.21362,4.2116,4.211,4.21515,4.21553,4.19991,4.20321,4.20861,4.20633,4.20077]}

    # match_type = "52" ->  감모
    data_2 = {"lengthDate":30,"date":["2025-09-16T00:00:00","2025-09-17T00:00:00","2025-09-18T00:00:00","2025-09-19T00:00:00","2025-09-20T00:00:00","2025-09-21T00:00:00","2025-09-22T00:00:00","2025-09-23T00:00:00","2025-09-24T00:00:00","2025-09-25T00:00:00","2025-09-26T00:00:00","2025-09-27T00:00:00","2025-09-28T00:00:00","2025-09-29T00:00:00","2025-09-30T00:00:00","2025-10-01T00:00:00","2025-10-02T00:00:00","2025-10-03T00:00:00","2025-10-04T00:00:00","2025-10-05T00:00:00","2025-10-06T00:00:00","2025-10-07T00:00:00","2025-10-08T00:00:00","2025-10-09T00:00:00","2025-10-10T00:00:00","2025-10-11T00:00:00","2025-10-12T00:00:00","2025-10-13T00:00:00","2025-10-14T00:00:00","2025-10-15T00:00:00"],"count":[318925,314260,211157,319327,314181,307910,317508,313676,310061,172279,321383,320053,309926,313959,314269,301037,199791,296914,290469,285661,284375,287477,289490,294145,304967,302272,304713,310169,310649,304188],"avggoaltot":[1.5651,1.5681,1.5557,1.5605,1.5565,1.5587,1.562,1.5554,1.5556,1.5357,1.5506,1.5511,1.5497,1.5552,1.5493,1.5527,1.5349,1.5521,1.5525,1.5517,1.5502,1.547,1.5478,1.547,1.5469,1.5465,1.5424,1.544,1.5447,1.5428],"avgshoottot":[5.0379,5.0407,4.9999,5.0225,5.0303,5.0172,5.0231,5.0167,5.0205,4.9492,5.0074,5.014,5.0024,5.0197,5.0011,5.0022,4.95,5.0028,5.0078,4.9969,4.9943,4.9855,4.9872,4.9913,4.9853,4.9788,4.9777,4.979,4.9774,4.9672],"avgeffshoottot":[3.9486,3.9509,3.9193,3.9354,3.9413,3.9354,3.9379,3.9302,3.936,3.8807,3.9243,3.9275,3.9191,3.934,3.9201,3.9214,3.8784,3.9215,3.9254,3.9175,3.915,3.9071,3.9084,3.9124,3.9063,3.904,3.9006,3.9032,3.8998,3.8924],"avggoalpenaltykick":[0.0296,0.0292,0.0294,0.0295,0.029,0.0294,0.029,0.0288,0.0292,0.0282,0.029,0.0291,0.0287,0.0296,0.029,0.0287,0.0282,0.0285,0.0289,0.0289,0.0285,0.0288,0.029,0.0287,0.0286,0.0282,0.0287,0.0283,0.0287,0.0286],"avggoalfreekick":[0.0074,0.0072,0.0076,0.0075,0.0073,0.0075,0.0074,0.0072,0.0073,0.0076,0.0073,0.0075,0.0075,0.0075,0.0073,0.0073,0.0073,0.0076,0.0076,0.0074,0.0073,0.0075,0.0076,0.0075,0.0075,0.0075,0.0077,0.0077,0.0076,0.0076],"avgshootinpenalty":[3.094,3.0979,3.07,3.0795,3.0808,3.0744,3.0789,3.0708,3.0761,3.0322,3.0651,3.0697,3.0641,3.0715,3.0625,3.0627,3.029,3.0635,3.0681,3.0608,3.0585,3.0546,3.0554,3.0599,3.0506,3.0491,3.0463,3.0467,3.043,3.04],"avggoalinpenalty":[1.1518,1.1555,1.1452,1.1473,1.1439,1.1465,1.1498,1.1434,1.1446,1.1297,1.1405,1.1421,1.1401,1.1438,1.1396,1.1416,1.1304,1.1426,1.1436,1.1428,1.1418,1.1383,1.1387,1.1401,1.1393,1.1383,1.1348,1.1354,1.136,1.1354],"avgshootoutpenalty":[1.9019,1.9013,1.8885,1.9012,1.9082,1.9015,1.9028,1.9046,1.9028,1.8769,1.9013,1.9027,1.8975,1.9063,1.8972,1.8987,1.8805,1.8986,1.8984,1.8948,1.8951,1.8899,1.8904,1.8904,1.8938,1.8891,1.8904,1.8916,1.8937,1.8864],"avggoaloutpenalty":[0.3837,0.3834,0.3812,0.3837,0.3835,0.3828,0.3832,0.3832,0.3818,0.3778,0.3812,0.3799,0.3809,0.3819,0.3807,0.3825,0.3764,0.381,0.38,0.38,0.3799,0.38,0.3801,0.3782,0.3789,0.38,0.3789,0.3803,0.38,0.3788],"middleshoot":[20.1744,20.1638,20.1828,20.1847,20.1,20.1304,20.1407,20.1198,20.0674,20.1262,20.0469,19.9667,20.0755,20.0335,20.0659,20.1447,20.0167,20.0648,20.0181,20.0559,20.0456,20.1045,20.1071,20.0066,20.0084,20.1142,20.0429,20.1046,20.068,20.0791],"outpenaltygoalratio":[24.516,24.45,24.5034,24.5883,24.6386,24.5589,24.5327,24.6367,24.5436,24.6012,24.584,24.4923,24.579,24.5563,24.5724,24.6345,24.5228,24.5474,24.4767,24.4893,24.5065,24.5637,24.5574,24.4473,24.4941,24.5716,24.5656,24.6308,24.6002,24.5528],"avggoalheading":[0.1563,0.1569,0.1554,0.1552,0.154,0.1542,0.1542,0.1533,0.1538,0.1519,0.1535,0.1533,0.1528,0.153,0.1533,0.1529,0.1513,0.1528,0.1533,0.1531,0.1524,0.1524,0.1519,0.1525,0.1524,0.1512,0.151,0.1515,0.1523,0.1512],"goalheadingratio":[9.9889,10.0063,9.9876,9.9476,9.8968,9.8906,9.8716,9.855,9.8859,9.889,9.902,9.882,9.8606,9.8372,9.8972,9.848,9.8543,9.8442,9.8715,9.8684,9.8297,9.8481,9.8136,9.8574,9.85,9.7758,9.7887,9.8097,9.8611,9.8034],"avgpasstry":[107.858,108.044,107.346,108.284,108.775,108.454,108.753,108.682,108.8,107.211,108.561,108.909,108.609,108.966,108.752,108.813,107.669,108.569,108.695,108.636,108.651,108.728,108.68,108.795,108.938,108.921,108.933,109.045,109.012,109.001],"avgpasssuccess":[93.5486,93.7187,93.1272,93.9983,94.4927,94.1854,94.4702,94.4107,94.5204,93.0855,94.3154,94.6276,94.3714,94.6871,94.5139,94.5554,93.5375,94.3292,94.4333,94.3897,94.4124,94.5034,94.4591,94.5751,94.7087,94.7008,94.7296,94.8317,94.7895,94.8034],"passsuccessratio":[86.733,86.741,86.7542,86.8075,86.8694,86.8437,86.8668,86.869,86.8754,86.825,86.8775,86.8872,86.8909,86.8958,86.9075,86.8973,86.8753,86.8841,86.8792,86.8861,86.8949,86.917,86.9152,86.93,86.9383,86.9449,86.9611,86.9654,86.9534,86.9746],"avgowngoal":[0.0071,0.0069,0.007,0.007,0.007,0.0071,0.0072,0.0071,0.007,0.0069,0.0072,0.0069,0.0069,0.007,0.0072,0.0068,0.0069,0.0071,0.0069,0.0072,0.0072,0.0069,0.007,0.0071,0.0069,0.0071,0.0071,0.007,0.0068,0.007],"avgpossession":[49.9454,49.961,49.9601,49.9552,49.9635,49.9564,49.9646,49.971,49.9723,49.9644,49.969,49.9727,49.9801,49.9758,49.9762,49.9886,49.9794,49.9867,49.9848,49.9927,49.9914,49.9936,49.9939,49.9953,49.9971,50.0026,49.9997,50.0004,50.0001,50.0035],"avgdribble":[84.7893,84.9395,84.3187,85.1571,85.5608,85.3143,85.5561,85.5172,85.5951,84.2264,85.4304,85.7117,85.4978,85.7558,85.586,85.6586,84.6667,85.4899,85.5758,85.5366,85.5744,85.6284,85.6016,85.6943,85.8019,85.7942,85.8087,85.8839,85.8757,85.8549],"avgtacklesuccess":[5.8403,5.8608,5.8298,5.8651,5.8691,5.8718,5.8771,5.8858,5.8874,5.8303,5.8753,5.8842,5.8806,5.8889,5.8821,5.8982,5.8437,5.9036,5.9181,5.9043,5.9025,5.9031,5.9075,5.897,5.914,5.9092,5.8966,5.9014,5.9061,5.8968],"avgtackletry":[8.6337,8.6639,8.6199,8.6704,8.6803,8.6791,8.6833,8.6992,8.7028,8.6081,8.6833,8.6994,8.6922,8.7009,8.6938,8.7132,8.642,8.7204,8.7394,8.7231,8.7234,8.7253,8.7328,8.719,8.7337,8.7272,8.7152,8.7241,8.7283,8.7139],"avgblocksuccess":[0.4801,0.4803,0.4775,0.4798,0.4815,0.4802,0.4802,0.4796,0.4798,0.4751,0.4801,0.4794,0.4781,0.481,0.4805,0.4786,0.4751,0.4775,0.478,0.4783,0.4795,0.4783,0.4788,0.4792,0.4781,0.4755,0.4776,0.4783,0.478,0.4769],"avgblocktry":[7.4991,7.5166,7.4689,7.5239,7.5346,7.5282,7.5449,7.5387,7.5495,7.4596,7.5345,7.5526,7.5314,7.5587,7.5485,7.5479,7.4806,7.5323,7.5512,7.5451,7.5479,7.5429,7.5387,7.551,7.5564,7.5466,7.5513,7.5569,7.5522,7.5426],"avgfoul":[0.8385,0.8394,0.8391,0.8413,0.8413,0.8429,0.8407,0.843,0.842,0.8295,0.8424,0.8417,0.8417,0.8443,0.842,0.8423,0.8411,0.8433,0.8454,0.8447,0.8447,0.8444,0.8477,0.8448,0.8454,0.8448,0.8434,0.8447,0.8441,0.8413],"avgshootfreekick":[0.0935,0.0934,0.0938,0.0938,0.0942,0.0939,0.0939,0.0947,0.0943,0.0934,0.0936,0.0954,0.0941,0.0941,0.0941,0.0941,0.0935,0.0943,0.0948,0.0945,0.0946,0.0935,0.0944,0.0948,0.0948,0.0947,0.0941,0.0946,0.0948,0.0941],"avgshootpenaltykick":[0.0396,0.039,0.0391,0.0392,0.039,0.0389,0.039,0.0389,0.0392,0.0377,0.0386,0.0391,0.0385,0.0395,0.0389,0.0384,0.0381,0.0383,0.0388,0.0389,0.0383,0.0387,0.0389,0.0385,0.0385,0.0382,0.0386,0.0382,0.0384,0.0385],"avgshootheading":[0.9278,0.929,0.9177,0.9234,0.9212,0.918,0.9174,0.918,0.9191,0.9054,0.9151,0.9176,0.9154,0.9161,0.9133,0.9138,0.903,0.9138,0.9145,0.9106,0.9125,0.9108,0.9107,0.9114,0.9074,0.9069,0.908,0.9074,0.9081,0.905],"avgshortpasstry":[63.0967,63.2312,62.8501,63.5484,64.0092,63.7705,63.9799,63.9643,64.0592,62.995,63.9071,64.1627,63.9955,64.2061,64.1282,64.1441,63.4388,63.945,64.0112,63.9999,64.0517,64.148,64.0891,64.2149,64.3262,64.34,64.3815,64.4498,64.4075,64.46],"avgshortpasssuccess":[61.4147,61.5449,61.1728,61.86,62.3201,62.0805,62.288,62.2697,62.3645,61.3237,62.2164,62.4673,62.3045,62.51,62.4356,62.4492,61.7604,62.2508,62.3166,62.3065,62.3586,62.4522,62.3998,62.5223,62.6309,62.6437,62.6853,62.7545,62.7085,62.7651],"avglobpasstry":[6.86,6.8689,6.8048,6.8275,6.8227,6.8059,6.8099,6.8,6.8032,6.7248,6.7907,6.8086,6.7779,6.8027,6.7789,6.78,6.7198,6.7703,6.7777,6.7657,6.7634,6.7483,6.7539,6.7562,6.748,6.7414,6.7359,6.7373,6.747,6.727],"avglobpasssuccess":[2.1914,2.1949,2.1723,2.1797,2.1805,2.1724,2.1727,2.1709,2.172,2.1422,2.1679,2.1716,2.1627,2.1693,2.1621,2.1613,2.1405,2.1568,2.1583,2.154,2.1518,2.151,2.1541,2.1552,2.1533,2.1494,2.1483,2.1497,2.1492,2.1448],"avgdrivengroundpasstry":[4.6889,4.6884,4.6453,4.671,4.6865,4.6714,4.6842,4.6705,4.6818,4.6107,4.6728,4.6832,4.668,4.689,4.6688,4.6729,4.6219,4.6659,4.6696,4.6708,4.6655,4.6598,4.66,4.661,4.6707,4.6593,4.6566,4.6648,4.6642,4.6599],"avgdrivengroundpasssuccess":[4.5508,4.5493,4.5077,4.5325,4.5477,4.5324,4.5457,4.533,4.543,4.4731,4.5348,4.5438,4.5302,4.55,4.5304,4.5345,4.4844,4.5274,4.5308,4.5314,4.5274,4.5221,4.5216,4.523,4.533,4.5211,4.5185,4.5276,4.5246,4.5218],"avgthroughpasstry":[23.7984,23.8576,23.7328,23.8931,23.9218,23.8793,23.9484,23.9434,23.9386,23.677,23.9047,23.9518,23.8881,23.9656,23.9122,23.9387,23.7065,23.9124,23.9543,23.9319,23.9164,23.9291,23.9439,23.9273,23.9478,23.9477,23.9462,23.9601,23.9614,23.9343],"avgthroughpasssuccess":[20.1308,20.1787,20.0755,20.212,20.2357,20.1998,20.2616,20.2537,20.2457,20.0172,20.2189,20.2615,20.2066,20.275,20.2262,20.2487,20.0409,20.2246,20.2563,20.2382,20.2245,20.2353,20.2483,20.2391,20.2501,20.2529,20.2535,20.2652,20.2699,20.2446],"avglobbedthroughpasstry":[8.4893,8.4692,8.3917,8.4169,8.4107,8.3982,8.4045,8.376,8.3901,8.2844,8.3617,8.3766,8.353,8.376,8.339,8.3489,8.264,8.3485,8.3562,8.3379,8.3283,8.3181,8.3063,8.3088,8.3189,8.3064,8.2892,8.306,8.308,8.2978],"avglobbedthroughpasssuccess":[5.0734,5.0624,5.0122,5.0276,5.0225,5.0132,5.0154,4.9967,5.0086,4.9455,4.9908,4.9976,4.9809,4.9966,4.9741,4.9748,4.9262,4.9833,4.9854,4.9727,4.9646,4.9576,4.9492,4.9502,4.957,4.9485,4.9393,4.9493,4.9537,4.9427],"avgcornerkick":[1.9938,1.9981,1.9796,1.9909,1.9925,1.985,1.9895,1.9846,1.9873,1.9642,1.9835,1.9885,1.9801,1.9896,1.9829,1.9808,1.9607,1.9809,1.9817,1.9803,1.9761,1.9747,1.9741,1.9775,1.9735,1.9705,1.9702,1.97,1.9715,1.966],"avgycards":[0.0776,0.0775,0.0778,0.077,0.0777,0.0785,0.0788,0.0786,0.0786,0.0776,0.0785,0.0777,0.0784,0.0786,0.0782,0.0786,0.0781,0.0777,0.0786,0.0783,0.0782,0.0783,0.0789,0.0781,0.0785,0.0784,0.0784,0.0791,0.0784,0.0782],"avgrcards":[0.0032,0.0033,0.0033,0.0032,0.0032,0.0034,0.0033,0.0034,0.0036,0.0032,0.0034,0.0033,0.0033,0.0034,0.0034,0.0035,0.0033,0.0034,0.0032,0.0034,0.0033,0.0033,0.0034,0.0034,0.0034,0.0032,0.0034,0.0033,0.0033,0.0034],"avginjury":[0.1558,0.156,0.155,0.1564,0.1563,0.1564,0.1562,0.1564,0.1564,0.1559,0.1566,0.157,0.1562,0.1557,0.1563,0.1569,0.1544,0.1561,0.1571,0.1554,0.1578,0.1566,0.1567,0.1561,0.1572,0.1566,0.1564,0.1563,0.1563,0.1556],"avgoffsidecnt":[1.2394,1.2388,1.2279,1.2321,1.2365,1.2336,1.2378,1.2357,1.2363,1.2212,1.2334,1.2369,1.2357,1.2364,1.2334,1.2356,1.2218,1.2345,1.2401,1.2368,1.2352,1.2355,1.2351,1.2371,1.2371,1.2379,1.2331,1.2328,1.2359,1.2362],"avgavgrating":[4.01256,4.01279,4.01234,4.00986,4.00965,4.00974,4.00909,4.00801,4.00792,4.00815,4.00731,4.00705,4.0073,4.00668,4.00574,4.00603,4.00551,4.00602,4.00621,4.0058,4.00507,4.00431,4.00417,4.00409,4.00342,4.0028,4.00234,4.00201,4.00162,4.00149]}

    # 데이터를 DataFrame으로 변환
    if match_type == "52":
        df = pd.DataFrame(data_2)
    else:
        df = pd.DataFrame(data_1)
    # 마지막 행 반환
    return df.iloc[-1, :]
